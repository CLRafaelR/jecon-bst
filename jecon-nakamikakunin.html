<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<!-- Created by htmlize-1.51 in css mode. -->
<html>
  <head>
    <title>jecon.bst</title>
    <style type="text/css">
    <!--
      body {
        color: #ffffff;
        background-color: #000000;
      }
      .builtin {
        /* font-lock-builtin-face */
        color: #b0c4de;
      }
      .comment {
        /* font-lock-comment-face */
        color: #80ff70;
      }
      .constant {
        /* font-lock-constant-face */
        color: #22ffff;
      }
      .function-name {
        /* font-lock-function-name-face */
        color: #ffff60;
      }
      .keyword {
        /* font-lock-keyword-face */
        color: #00ffff;
      }
      .string {
        /* font-lock-string-face */
        color: #ff88cc;
      }
      .variable-name {
        /* font-lock-variable-name-face */
        color: #ffa500;
      }

      a {
        color: inherit;
        background-color: inherit;
        font: inherit;
        text-decoration: inherit;
      }
      a:hover {
        text-decoration: underline;
      }
    -->
    </style>
  </head>
  <body>
    <pre>
<span class="comment">% jecon.bst: &#32076;&#28168;&#23398;&#29992; BibTeX style file.</span>
<span class="comment">%</span>
<span class="comment">% First-written:       &lt;2002/11/03&gt;</span>
<span class="comment">% Time-stamp:          &lt;2017-07-08 01:26:24 st&gt;</span>
<span class="comment">% Version 5.3.1</span>
<span class="comment">%</span>
<span class="comment">% &#12371;&#12428;&#12399;&#65292;&#39151;&#30000;&#20462;&#12373;&#12435;&#12395;&#12424;&#12387;&#12390;&#20316;&#25104;&#12373;&#12428;&#12383; jpolisci.bst &#12434;&#32076;&#28168;&#23398;&#29992;&#12395;</span>
<span class="comment">% &#27494;&#30000;&#21490;&#37070;&#12364;&#25913;&#22793;&#12375;&#12383;&#12418;&#12398;&#12391;&#12377;&#65294;</span>
<span class="comment">% &#25913;&#22793;&#12395;&#12399;</span>
<span class="comment">%</span>
<span class="comment">% aer.bst, jfm.bst, jplain.bst</span>
<span class="comment">% &#33833;&#24179;&#21746;&#12373;&#12435;&#12395;&#12424;&#12427; &lt;http://www.med.osaka-u.ac.jp/pub/anes/www/html/manual/bibtex.html&gt;</span>
<span class="comment">% &#27147;&#21475;&#32789;&#19968;&#12373;&#12435;&#12395;&#12424;&#12427; nissya.bst &lt;http://koichi.nihon.to/psnl/&gt;</span>
<span class="comment">%</span>
<span class="comment">% &#31561;&#12434;&#21442;&#32771;&#12395;&#12373;&#12379;&#12390;&#12356;&#12383;&#12384;&#12365;&#12414;&#12375;&#12383;&#12290;&#12371;&#12428;&#12425;&#12398;&#26377;&#30410;&#12394;&#12503;&#12525;&#12464;&#12521;&#12512;&#12289;&#12506;&#12540;&#12472;&#12434;&#20316;&#25104;&#12375;&#12390;&#12367;&#12384;</span>
<span class="comment">% &#12373;&#12387;&#12383;&#26041;&#12293;&#12395;&#24863;&#35613;&#12375;&#12414;&#12377;&#12290;</span>
<span class="comment">%</span>
<span class="comment">% &#20803;&#12398; jpolisci.bst &#12398;&#33879;&#20316;&#27177;&#12399;&#39151;&#30000;&#12373;&#12435;&#12395;&#12354;&#12426;&#12414;&#12377;&#65294;&#12431;&#12383;&#12375;&#12364;&#25913;&#22793;&#12375;&#12383;&#37096;&#20998;&#12398;&#33879;&#20316;&#27177;&#12399;</span>
<span class="comment">% &#12393;&#12358;&#12391;&#12418;&#12356;&#12356;&#12391;&#12377;&#65294;&#22909;&#12365;&#12394;&#12424;&#12358;&#12395;&#25201;&#12387;&#12390;&#12367;&#12384;&#12373;&#12356;&#65294;</span>
<span class="comment">%</span>
<span class="comment">% &#12458;&#12522;&#12472;&#12490;&#12523;&#12398; jpolisci.bst &#12399;&#65292;&lt;http://www.bol.ucla.edu/~oiida/jpolisci/&gt; &#12391;&#20837;&#25163;</span>
<span class="comment">% &#12377;&#12427;&#12371;&#12392;&#12364;&#12391;&#12365;&#12414;&#12377;&#65294;(&#27880;&#65306;2006&#24180;&#29694;&#22312;&#12391;&#12399;&#12418;&#12358;&#12371;&#12398;&#12506;&#12540;&#12472;&#12399;&#23384;&#22312;&#12375;&#12394;&#12356;&#12424;&#12358;&#12391;&#12377;&#65294;&#12393;&#12371;</span>
<span class="comment">% &#12391;&#20837;&#25163;&#12391;&#12365;&#12427;&#12363;&#12399;&#12431;&#12363;&#12426;&#12414;&#12379;&#12435;)&#65294;</span>
<span class="comment">%</span>
<span class="comment">% &#12467;&#12513;&#12531;&#12488;&#65292;&#35201;&#26395;&#12399;&#27494;&#30000;&#21490;&#37070;&#12414;&#12391;&#65294;</span>
<span class="comment">%</span>
<span class="comment">% &#22793;&#26356;&#23653;&#27508; (Changelog) &#12399; CHANGES.txt &#12501;&#12449;&#12452;&#12523;&#12434;&#35211;&#12390;&#12367;&#12384;&#12373;&#12356;&#65294;</span>

<span class="comment">% version &#25351;&#23450;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">jecon.version</span>} { <span class="string">"5.3.1"</span> }

<span class="comment">% Debug mode&#65294;0 &#20197;&#22806;&#12434;&#25351;&#23450;&#12377;&#12427;&#12392;&#27096;&#12293;&#12394;&#24773;&#22577;&#12434;&#34920;&#31034;&#12373;&#12379;&#12427;&#12371;&#12392;&#12364;&#21487;&#33021;&#65294;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">jecon.debug</span>}
{ #0 }    <span class="comment">% Debug mode off.</span>
<span class="comment">% { #1 }    % Debug mode on.</span>


<span class="comment">% &#20197;&#19979;&#12399;&#20803;&#12398; jpolisci.bst &#12398;&#12504;&#12483;&#12480;&#12540;&#37096;&#20998;&#12391;&#12377;&#65294;</span>
<span class="comment">%</span>
<span class="comment">%%%%%% &#12371;&#12371;&#12363;&#12425; Original header.</span>
<span class="comment">%</span>
<span class="comment">% JPOLISCI: a bibliography style for papers in political sicence</span>
<span class="comment">%           and other fields that cite Japanese literature.</span>
<span class="comment">%           Vertical writing (tate-gaki) compatible.</span>

        <span class="comment">% Version 20000910 for JBibTeX versions 0.30 or later,</span>
        <span class="comment">% and pLaTeX2e or later.</span>
        <span class="comment">% Copyright (C) 2000, all rights reserved.</span>
        <span class="comment">%</span>
        <span class="comment">% This file was derived from jbtxbst.doc.</span>
        <span class="comment">%</span>
        <span class="comment">% Copying of this file is authorized only if either</span>
        <span class="comment">% (1) you make absolutely no changes to your copy, including name, or</span>
        <span class="comment">% (2) if you do make changes, you name it something other than</span>
        <span class="comment">% jbtxbst.doc, jplain.bst, junsrt.bst, jalpha.bst, jabbrv.bst,</span>
        <span class="comment">% tipsj.bst, jipsj.bst, tieice.bst, jname.bst, jorsj.bst, jglsj.bst,</span>
        <span class="comment">% seg.bst, jpolisci.bst.</span>
        <span class="comment">%</span>
        <span class="comment">% This restriction helps ensure that all standard styles are identical.</span>
        <span class="comment">% The file jbtxbst.doc has the documentation for this style.</span>
        <span class="comment">%</span>

        <span class="comment">% Author:</span>
        <span class="comment">%</span>
        <span class="comment">% &#39151;&#30000;&#20462; Osamu Iida</span>
        <span class="comment">% email: oiida@newmail.net</span>
        <span class="comment">% URL  : http://www.bol.ucla.edu/~oiida/jpolisci/ (in Japanese)</span>
        <span class="comment">%</span>
        <span class="comment">% Bug reports, technical suggestions and any other comments</span>
        <span class="comment">% will be appreciated.</span>
        <span class="comment">% </span>

        <span class="comment">% Acknowledgement:</span>
        <span class="comment">%</span>
        <span class="comment">% The following files were referred to while creating this file:</span>
        <span class="comment">%</span>
        <span class="comment">%   jglsj.bst  (by &#21315;&#33865;&#26234;&#31456; Tomoaki Chiba)</span>
        <span class="comment">%     Function "format.lab.name" in jpolisci.bst derived from</span>
        <span class="comment">%     it with small modifications only. The author appreciates it.</span>
        <span class="comment">%</span>
        <span class="comment">%   seg.bst (by Martin Karrenbach)</span>
        <span class="comment">%     A method for making two sorts of labels is based on this</span>
        <span class="comment">%     file's feats.</span>
        <span class="comment">%</span>
        <span class="comment">%   jalpha.bst (by &#26494;&#20117;&#27491;&#19968; Shoichi Matsui)</span>
        <span class="comment">%     jpolisci.bst principally owes its functionality to it.</span>
        <span class="comment">%</span>
        <span class="comment">%   &#34276;&#30000;&#30494;&#20316;&#12302;&#32154; LaTeX2e &#38542;&#26799;&#12539;&#32294;&#32068;&#32232;&#12303;&#65288;&#12450;&#12472;&#12477;&#12531;&#12539;&#12454;&#12455;&#12473;&#12524;&#12452;&#12289;1998 &#24180;&#65289;&#12290;</span>
        <span class="comment">%</span>
        <span class="comment">% Friends in BBSes at IR-web &lt;http://pws.prserv.net/oi/ -- now</span>
        <span class="comment">% obsolete&gt; and KH's Web Site &lt;http://home.att.ne.jp/wind/polisci/&gt;</span>
        <span class="comment">% gave me titles of Japanese political science journals which are</span>
        <span class="comment">% included in MACROs.</span>

        <span class="comment">% This file is distributed with absolutely no warranty.</span>
        <span class="comment">% The author doesn't assume any kind of responsibility for</span>
        <span class="comment">% any inconvenience caused by using this file.</span>

        <span class="comment">% Last modified: 2000/12/05</span>

<span class="comment">%%%%%% Original header &#12371;&#12371;&#12414;&#12391;&#12290;</span>
<span class="comment">%</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%%      &#29992;&#35486;</span>

<span class="comment">%% &#12300;&#12456;&#12531;&#12488;&#12522;&#12540;&#12301;&#65306;&#19968;&#12388;&#12398;&#25991;&#29486;&#12398;&#12371;&#12392;&#65294;&#12456;&#12531;&#12488;&#12522;&#12540;&#12398;&#12479;&#12452;&#12503;&#12392;&#12399; article&#65292;book &#31561;&#12398;</span>
<span class="comment">%% &#25991;&#29486;&#12398;&#31278;&#39006;&#12398;&#12371;&#12392;&#65294;</span>

<span class="comment">%% &#12300;&#12501;&#12451;&#12540;&#12523;&#12489;&#12301;&#65306;&#12456;&#12531;&#12488;&#12522;&#12540;&#20869;&#12391;&#25351;&#23450;&#12373;&#12428;&#12390;&#12356;&#12427; title, author, year &#31561;&#12398;&#12371;&#12392;&#65294;</span>

<span class="comment">%% &#12300;&#12461;&#12540;&#12527;&#12540;&#12489;&#12301;&#65306;\cite&#21629;&#20196;&#12398;&#24341;&#25968;&#12392;&#12394;&#12427;&#21508;&#12456;&#12531;&#12488;&#12522;&#12540;&#12395;&#25351;&#23450;&#12373;&#12428;&#12390;&#12356;&#12427;&#25991;&#23383;&#21015;&#12398;&#12371;</span>
<span class="comment">%% &#12392;&#65294;</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%%</span>
<span class="comment">%%      &#12459;&#12473;&#12479;&#12510;&#12452;&#12474;&#12398;&#12383;&#12417;&#12398;&#38306;&#25968;</span>
<span class="comment">%%</span>
<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">% \bysame &#12434;&#20351;&#12358;&#12363;&#21542;&#12363;&#12290;&#20351;&#12431;&#12394;&#12356;&#12394;&#12425; 0&#12289;&#20351;&#12358;&#12394;&#12425; 0 &#20197;&#22806;&#12434;&#25351;&#23450; (bst &#12501;&#12449;&#12452;</span>
<span class="comment">% &#12523;&#12391;&#12399;&#25972;&#25968;&#12434;&#34920;&#12377;&#12392;&#12365;&#25968;&#23383;&#12395; # &#12434;&#20184;&#12369;&#12427;)&#12290;</span>
<span class="comment">% \bysame &#12392;&#12399;&#12289;&#21442;&#32771;&#25991;&#29486;&#37096;&#20998;&#21516;&#12376;&#33879;&#32773;&#21517;&#12364;&#36899;&#32154;&#12377;&#12427;&#12392;&#12365;&#12395; --- &#12391;&#30465;&#30053;&#12377;&#12427;&#12418;&#12398;&#12290;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.use.bysame</span>}
<span class="comment">% { #0 }    % Not use \bysame</span>
{ #1 }    <span class="comment">% -&gt; Use \bysame (default)</span>
<span class="comment">% { #2 }    % -&gt; Use \bysame of alternative style.</span>

<span class="comment">% \bysame &#12398;&#23450;&#32681;&#12290;\bysame &#12434;&#20351;&#12387;&#12383;&#12392;&#12365;&#12398;&#27178;&#26834;&#12398;&#24418;&#24335;&#12434;&#22793;&#12360;&#12427;&#12395;&#12399;&#20197;&#19979;&#12398;&#23450;&#32681;&#12434;&#20462;&#27491;</span>
<span class="comment">% &#12377;&#12427;&#12290;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.bysame.definition</span>}
{ <span class="string">"\hskip.3em \leavevmode\rule[.5ex]{2.5em}{.3pt}\hskip0.5em"</span> } 

<span class="comment">% &#26085;&#26412;&#35486;&#25991;&#29486;&#29992;&#12398; \bysame &#65288;\bysamejp&#65289;&#12398;&#23450;&#32681;</span>
<span class="comment">% &#12392;&#12426;&#12354;&#12360;&#12378;&#33521;&#35486;&#25991;&#29486;&#29992;&#12392;&#21516;&#12376;&#23450;&#32681;&#12395;&#12375;&#12390;&#12362;&#12367;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.bysame.definition.jp</span>}
{ <span class="string">"\hskip.2em \leavevmode\rule[.7ex]{2.5em}{.3pt}\hskip0.3em"</span> } 

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">% Economics &#12398; reference &#12391;&#12399;, first author &#21517;&#12399;&#12300;&#22995;, &#21517;&#12301;&#12398;&#38918;&#30058;&#12391;&#34920;&#35352;&#12375;&#12289;</span>
<span class="comment">% second author &#20197;&#19979;&#12399;&#12300;&#21517; &#22995;&#12301;&#12392;&#12377;&#12427;&#12392;&#12356;&#12358;&#22580;&#21512;&#12364;&#22810;&#12356;&#12364;&#12289;&#12371;&#12428;&#12434;&#22793;&#26356;&#12377;&#12427;&#12383;&#12417;&#12398;&#38306;&#25968;&#12290;</span>
<span class="comment">% Editor &#12395;&#12418;&#36969;&#29992;&#12290;&#26085;&#26412;&#35486;&#25991;&#29486;&#12399;&#38306;&#20418;&#12394;&#12375;&#12290;#0 &#12363; #1 &#12363; #2 &#12434;&#36984;&#25246;&#21487;&#12290;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.author.name</span>}
{ #0 }    <span class="comment">% (default)</span>
<span class="comment">% { #1 }</span>
<span class="comment">% { #2 }</span>

<span class="comment">% [#0 &#12398;&#12465;&#12540;&#12473;] &#12371;&#12428;&#26222;&#36890;&#12398;&#32076;&#28168;&#23398;&#39080;&#12290;</span>
<span class="comment">% Fujita, Masahisa, Paul R. Krugman, and Anthony J. Venables. </span>

<span class="comment">% [#1 &#12398;&#12465;&#12540;&#12473;] &#20840;&#21729;&#12300;&#22995;, &#21517;&#12301;&#12398;&#12465;&#12540;&#12473;&#12290;</span>
<span class="comment">% Fujita, Masahisa, Krugman, Paul R., and Venables, Anthony J.</span>

<span class="comment">% [#2 &#12398;&#12465;&#12540;&#12473;] &#20840;&#21729;&#12300;&#21517; &#22995;&#12301;&#12398;&#12465;&#12540;&#12473;&#12290;</span>
<span class="comment">% Masahisa Fujita, Paul R. Krugman, and Anthony J. Venables.</span>

<span class="comment">% Economics &#12398; reference &#12391;&#12399;, first author &#21517;&#12399;&#12300;&#22995;, &#21517;&#12301;&#12398;&#38918;&#30058;&#12391;&#34920;&#35352;&#12375;&#12289;</span>
<span class="comment">% second author &#20197;&#19979;&#12399;&#12300;&#21517; &#22995;&#12301;&#12392;&#12377;&#12427;&#12392;&#12356;&#12358;&#22580;&#21512;&#12364;&#22810;&#12356;&#12364;&#12289;&#12371;&#12428;&#12434;&#22793;&#26356;&#12377;&#12427;&#12383;&#12417;&#12398;&#38306;&#25968;&#12290;</span>
<span class="comment">% Editor &#12395;&#12418;&#36969;&#29992;&#12290;&#26085;&#26412;&#35486;&#25991;&#29486;&#12399;&#38306;&#20418;&#12394;&#12375;&#12290;#0 &#12363; #1 &#12363; #2 &#12434;&#36984;&#25246;&#21487;&#12290;</span>
<span class="comment">%</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">% bib&#12501;&#12449;&#12452;&#12523;&#12395;&#12362;&#12369;&#12427;&#26085;&#26412;&#20154;&#21517;&#12398;&#35352;&#36848;&#26041;&#27861;&#12398;&#36984;&#25246;&#12290;</span>
<span class="comment">%</span>
<span class="comment">% &#26222;&#36890;&#12398;bib&#12501;&#12449;&#12452;&#12523;&#12391;&#12399;&#26085;&#26412;&#20154;&#21517;&#12399;&#12300;author = {&#22995; &#21517;}&#12301;&#12392;&#12356;&#12358;&#26360;&#12365;&#26041;&#12434;&#12377;&#12427;&#12290;&#12375;&#12363;&#12375;&#12289;</span>
<span class="comment">% &#19968;&#37096;&#12398;&#25991;&#29486;&#31649;&#29702;&#12477;&#12501;&#12488;&#12399;&#26085;&#26412;&#20154;&#21517;&#12434;&#12300;author = {&#22995;, &#21517;}&#12301;&#12392;&#12356;&#12358;&#24418;&#24335;&#12391;bib&#12501;&#12449;&#12452;&#12523;&#12395;</span>
<span class="comment">% &#20986;&#21147;&#12377;&#12427;&#12290;bib&#12501;&#12449;&#12452;&#12523;&#12364;&#12371;&#12398;&#12393;&#12385;&#12425;&#12398;&#24418;&#24335;&#12391;&#35352;&#36848;&#12373;&#12428;&#12390;&#12356;&#12427;&#12363;&#12398;&#36984;&#25246;&#12290;editor&#12289;yomi&#12289;</span>
<span class="comment">% jauthor&#12395;&#12418;&#21516;&#12376;&#36984;&#25246;&#12364;&#36969;&#29992;&#12373;&#12428;&#12414;&#12377;&#12290;&#35443;&#12375;&#12367;&#12399;jecon-sample.pdf&#12391;&#12290;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.sei.mei.order</span>}
{ #0 }    <span class="comment">% (default) &#26222;&#36890;&#12398;&#26360;&#12365;&#26041; &#8594; author = {&#27494;&#30000; &#21490;&#37070;} or author = {&#21490;&#37070;, &#27494;&#30000;}</span>
<span class="comment">% { #1 }    % &#36870;&#12398;&#26360;&#12365;&#26041; &#8594; author = {&#27494;&#30000;, &#21490;&#37070;} or author = {&#21490;&#37070; &#27494;&#30000;} </span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">% Author (editor) &#21517;&#12398; first name &#12434;&#38957;&#25991;&#23383;&#12384;&#12369;&#12395;&#30053;&#12377;&#12290;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.first.name.initial</span>}
{ #0 }    <span class="comment">% #0 -&gt; &#30053;&#12373;&#12394;&#12356;&#12290; (default)</span>
<span class="comment">% { #1 }    % #0 &#20197;&#22806; -&gt; first name &#12434;&#38957;&#25991;&#23383;&#12395;&#30053;&#12377;&#12290;</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">% Title &#12398;&#20808;&#38957;&#25991;&#23383;&#20197;&#22806;&#12434;&#23567;&#25991;&#23383;&#12395;&#22793;&#25563;&#12377;&#12427; (book &#12398; tile &#12399;&#38500;&#12367;&#12290;&#20803;&#12293;&#23567;&#25991;</span>
<span class="comment">% &#23383;&#12394;&#12425;&#12394;&#12395;&#12418;&#22793;&#12431;&#12425;&#12394;&#12356;)&#12290;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.title.lower.case</span>}
{ #0 }    <span class="comment">% #0 &#12394;&#12425;&#23567;&#25991;&#23383;&#12395;&#22793;&#25563;&#12375;&#12394;&#12356; (&#12381;&#12398;&#12414;&#12414;)  (default)</span>
<span class="comment">% { #1 }    % #0 &#20197;&#22806;&#12394;&#12425;&#12289;&#23567;&#25991;&#23383;&#12395;&#22793;&#25563;&#12377;&#12427;&#12290;</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">% Title &#12434;&#34920;&#31034;&#12377;&#12427;&#12363;&#12375;&#12394;&#12356;&#12363;&#65294;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.hide.title</span>}
{ #0 }    <span class="comment">% #0 -&gt; &#34920;&#31034;&#12377;&#12427;&#65294;&#26222;&#36890;&#12399;&#12371;&#12385;&#12425;&#65294; (default)</span>
<span class="comment">% { #1 }    % #0 &#20197;&#22806; -&gt; &#38560;&#12377; (&#34920;&#31034;&#12375;&#12394;&#12356;)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">% &#21516;&#12376;&#24180;&#12395;&#21516;&#12376;&#33879;&#32773;&#12398;&#33521;&#35486;&#12289;&#26085;&#26412;&#35486;&#25991;&#29486;&#12398;&#20001;&#26041;&#12364;&#12354;&#12426;&#12289;&#12363;&#12388;&#26085;&#26412;&#35486;&#25991;&#29486;&#12398; yomi</span>
<span class="comment">% &#12395;&#33521;&#35486;&#25991;&#29486;&#12398;&#33879;&#32773;&#12392;&#21516;&#12376;&#12418;&#12398;&#12364;&#25351;&#23450;&#12375;&#12390;&#12354;&#12427;&#12392;&#12365;&#12395;&#12289;&#20001;&#32773;&#12434;&#28151;&#12380;&#12390;&#34920;&#31034;&#12377;&#12427;&#12383;</span>
<span class="comment">% &#12417;&#12398;&#12458;&#12503;&#12471;&#12519;&#12531;&#12290;</span>
<span class="comment">% yomi&#12434;&#26085;&#26412;&#35486;&#12391;&#26360;&#12356;&#12390;&#12356;&#12427;&#12394;&#12425;&#38306;&#20418;&#12394;&#12375;&#65294;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.mixed.order</span>}
{ #0 }    <span class="comment">% #0 -&gt; &#28151;&#12380;&#12394;&#12356;&#65294;&#26222;&#36890;&#12399;&#12371;&#12385;&#12425;&#65294; (default)</span>
<span class="comment">% { #1 }    % #0 &#20197;&#22806; -&gt; &#28151;&#12380;&#12427;&#12290;</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">% month &#12434;&#34920;&#31034;&#12377;&#12427;&#12363;&#21542;&#12363;&#12290;&#38560;&#12377;(&#34920;&#31034;&#12375;&#12394;&#12356;)&#12394;&#12425; 0 &#20197;&#22806;&#12289;&#38560;&#12373;&#12394;&#12356;(&#34920;&#31034;&#12377;&#12427;)&#12394;&#12425; </span>
<span class="comment">% 0 &#12434;&#25351;&#23450;&#12290;&#38560;&#12377;&#22580;&#21512;&#12391;&#12418; month &#12501;&#12451;&#12540;&#12523;&#12489;&#12398;&#20516;&#12399;&#20006;&#12409;&#26367;&#12360;&#12398;&#12461;&#12540;&#12392;&#12375;&#12390;&#12399;&#21033;&#29992;&#12373;&#12428;</span>
<span class="comment">% &#12427;&#12290;&#12371;&#12428;&#12418;&#26222;&#36890;&#12399;&#22793;&#26356;&#12375;&#12394;&#12356;&#65294;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.hide.month</span>}
{ #0 }    <span class="comment">% #0 -&gt; &#34920;&#31034;&#12377;&#12427;&#65294;&#26222;&#36890;&#12399;&#12371;&#12385;&#12425;&#65294; (default)</span>
<span class="comment">% { #1 }    % #0 &#20197;&#22806; -&gt; &#38560;&#12377; (&#34920;&#31034;&#12375;&#12394;&#12356;)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">% number filed &#12434;&#34920;&#31034;&#12377;&#12427;&#12363;&#21542;&#12363;&#12290;&#38560;&#12377;(&#34920;&#31034;&#12375;&#12394;&#12356;)&#12394;&#12425; 0 &#20197;&#22806;&#12289;&#38560;&#12373;&#12394;&#12356;(&#34920;&#31034;&#12377;</span>
<span class="comment">% &#12427;)&#12394;&#12425; 0 &#12434;&#25351;&#23450;&#12290;&#12371;&#12428;&#12418;&#26222;&#36890;&#12399;&#22793;&#26356;&#12375;&#12394;&#12356;&#65294;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.hide.number</span>}
{ #0 }    <span class="comment">% #0 -&gt; &#34920;&#31034;&#12377;&#12427;&#65294;&#26222;&#36890;&#12399;&#12371;&#12385;&#12425;&#65294; (default)</span>
<span class="comment">% { #1 }    % #0 &#20197;&#22806; -&gt; &#38560;&#12377; (&#34920;&#31034;&#12375;&#12394;&#12356;)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">% &#12371;&#12428;&#12398;&#20516;&#12395; 0 &#20197;&#22806;&#12434;&#25351;&#23450;&#12377;&#12427;&#12392;&#12289;reference &#37096;&#20998;&#12391; plain.bst &#12398;&#12424;&#12358;&#12395;&#25991;&#29486;</span>
<span class="comment">% &#12398;&#21069;&#12395; number index ([1]&#12398;&#12424;&#12358;&#12394;&#12418;&#12398;)&#12434;&#20184;&#12369;&#12427;&#12371;&#12392;&#12364;&#12391;&#12365;&#12427; (&#24341;&#29992;&#37096;&#20998;&#12399;</span>
<span class="comment">% author-year&#12391;&#22793;&#12431;&#12425;&#12394;&#12356;)&#12290;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.use.number.index</span>}
{ #0 }    <span class="comment">% Not use number index  (default)</span>
<span class="comment">% { #1 }    % #0 &#20197;&#22806; -&gt; Use number index</span>

<span class="comment">% number index &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (bst.use.number.index&#12395;0&#20197;&#22806;&#12434;&#25351;&#23450;&#12375;&#12390;&#12356;&#12427;&#12392;</span>
<span class="comment">% &#12365;&#12398;&#12415;&#26377;&#21177;)&#65294;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.number.index.pre</span>}
{ <span class="string">"["</span> }    <span class="comment">% (default) </span>

<span class="comment">% number index &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015;&#12290; \hskip1.0em &#12399;&#31354;&#30333;&#12398;&#22823;&#12365;&#12373;&#12290;&#31354;&#30333;&#12398;&#38263;&#12373;&#12399;&#33258;</span>
<span class="comment">% &#20998;&#12391;&#35519;&#25972;&#12375;&#12383;&#12411;&#12358;&#12364;&#12424;&#12356;&#12290; (bst.use.number.index&#12395;0&#20197;&#22806;&#12434;&#25351;&#23450;&#12375;&#12390;&#12356;&#12427;&#12392;&#12365;&#12398;&#12415;</span>
<span class="comment">% &#26377;&#21177;)&#65294;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.number.index.post</span>}
{ <span class="string">"]\hskip1.0em "</span> }    <span class="comment">% (default)</span>

<span class="comment">% number index &#12398;&#26368;&#22823;&#12398;&#26689;&#25968; (&#25991;&#29486;&#12364;100&#20491;&#20197;&#19978;&#12394;&#12425;3&#12289;100&#20491;&#12424;&#12426;&#23569;&#12394;&#12356;&#12394;&#12425;2&#12289;10&#20491;&#12424;</span>
<span class="comment">% &#12426;&#23569;&#12394;&#12369;&#12428;&#12400;1&#12434;&#25351;&#23450;)&#12290;&#12392;&#12426;&#12354;&#12360;&#12378; 3 &#12434;&#25351;&#23450;&#12375;&#12390;&#12362;&#12369;&#12400;&#21839;&#38988;&#12394;&#12356;&#12364;&#12289;3 &#12384;&#12392;&#12452;&#12531;&#12487;&#12531;</span>
<span class="comment">% &#12488;&#12364;&#22823;&#12365;&#30446;&#12395;&#12394;&#12427;&#12290;&#20516;&#12399; 1, 2, 3 &#12398;&#12393;&#12428;&#12363;&#12434;&#25351;&#23450;&#65294;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.number.index.digit</span>}
{ <span class="string">"3"</span> }    <span class="comment">% (default)</span>

<span class="comment">% &#20197;&#19979;&#12399;&#12289;number index &#12434;&#34920;&#31034;&#12377;&#12427;&#12392;&#12365;&#12395;&#35211;&#12383;&#30446;&#12434;&#35519;&#25972;&#12377;&#12427;&#12383;&#12417;&#12398;&#38306;&#25968;&#12290;computer</span>
<span class="comment">% modern &#20197;&#22806;&#12398;&#12501;&#12457;&#12531;&#12488;&#12434;&#20351;&#29992;&#12377;&#12427;&#12424;&#12358;&#12394;&#12392;&#12365;&#12399;&#35201;&#35519;&#25972;&#12290;</span>
<span class="comment">%</span>
<span class="comment">% Reference &#37096;&#20998;&#12398;&#25991;&#29486;&#12398;2&#34892;&#30446;&#20197;&#38477;&#12398;&#12452;&#12531;&#12487;&#12531;&#12488;&#24133;&#12398;&#20516;&#12434;&#25351;&#23450;&#65294;</span>
<span class="comment">%</span>
<span class="comment">% bst.number.index.digit &#12398;&#20516;&#12395;&#12424;&#12387;&#12390;&#12452;&#12531;&#12487;&#12531;&#12488;&#24133;&#12399;&#22793;&#12431;&#12427;&#12398;&#12391;&#65292;&#12381;&#12428;&#12382;&#12428;&#12398;&#12465;&#12540;&#12473;</span>
<span class="comment">% &#12395;&#12388;&#12356;&#12390;&#25351;&#23450;&#12377;&#12427;&#65294;</span>
<span class="comment">%</span>
<span class="comment">% bst.number.index.digit = 1 &#12398;&#12392;&#12365;&#12398;&#35373;&#23450;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.number.index.bibhang.one</span>}
{ <span class="string">"2.05em"</span> }    <span class="comment">% (default)</span>
<span class="comment">% bst.number.index.digit = 2 &#12398;&#12392;&#12365;&#12398;&#35373;&#23450;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.number.index.bibhang.ten</span>}
{ <span class="string">"2.55em"</span> }    <span class="comment">% (default)</span>
<span class="comment">% bst.number.index.digit = 3 &#12398;&#12392;&#12365;&#12398;&#35373;&#23450;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.number.index.bibhang.hund</span>}
{ <span class="string">"3.05em"</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">% &#12518;&#12491;&#12467;&#12540;&#12489;&#25991;&#23383;&#12434;&#21033;&#29992;&#12377;&#12427;&#12392;&#12365;&#12395;&#12399;&#38750;&#12476;&#12525;&#12395;&#12377;&#12427;&#12290;</span>
<span class="comment">% &#20351;&#12356;&#26041;&#12395;&#12388;&#12356;&#12390;&#12399;&#12300;jecon_unicode_xelatex.pdf&#12301;&#12434;&#35211;&#12390;&#12367;&#12384;&#12373;&#12356;&#12290;</span>
<span class="comment">% </span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.use.unicode</span>}
{ #0 }    <span class="comment">% Not use unicode font (default)</span>
<span class="comment">% { #1 }    % Use unicode font</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">% &#26085;&#26412;&#35486;&#25991;&#29486;&#12398;&#25968;&#23383;&#12434;&#28450;&#25968;&#23383;&#12395;&#12377;&#12427;&#65294;</span>
<span class="comment">%</span>
<span class="comment">% &#32294;&#26360;&#12365;&#29992;&#12391;&#12377;&#65294;</span>
<span class="comment">%</span>
<span class="comment">% 0 &#20197;&#22806;&#12394;&#12425;&#28450;&#25968;&#23383;&#12395;&#22793;&#25563;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.kansuji.jp</span>}
{ #0 }    <span class="comment">% &#22793;&#25563;&#12375;&#12394;&#12356;&#12290;(default)</span>
<span class="comment">% { #1 }    % &#28450;&#25968;&#23383;&#12395;&#22793;&#25563;&#12377;&#12427;&#12290;</span>

<span class="comment">% bst.kansuji.jp &#12364;&#38750;&#12476;&#12525;&#12398;&#12392;&#12365;&#12395;&#65292;pages &#12391;&#12398;&#12506;&#12540;&#12472;&#25968;&#12392;&#12506;&#12540;&#12472;&#25968;&#12434;&#32080;&#12406;&#32218;&#12398;&#23450;&#32681;</span>
<span class="comment">% &#12434;&#25351;&#23450;&#12377;&#12427;&#65294;pages = 100-200 &#12392;&#25351;&#23450;&#12375;&#12390;&#12356;&#12427;&#12392;&#12365;&#12395;&#65292;"-" &#12395;&#32622;&#12365;&#25563;&#12431;&#12427;&#32218;&#12398;&#23450;&#32681;&#65294;</span>
<span class="comment">%</span>
<span class="comment">% &#32294;&#26360;&#12365;&#12398;&#34920;&#31034;&#12434;&#25351;&#23450;&#12375;&#12390;&#12356;&#12427;&#12392;&#12365;&#12391;&#12418; - &#12399;&#27178;&#26834;&#12398;&#12414;&#12414;&#34920;&#31034;&#12373;&#12428;&#12414;&#12377;&#65294;&#12371;&#12428;&#12434;&#32294;&#26834;&#12395;</span>
<span class="comment">% &#34920;&#31034;&#12377;&#12427;&#12383;&#12417;&#12398;&#25351;&#23450;&#12391;&#12377;&#65294;</span>
<span class="comment">% </span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.tatebo.definition</span>}
{ <span class="string">"\hskip.1em \leavevmode\rule[0ex]{1em}{.3pt}\hskip0.1em"</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">% year &#12398;&#34920;&#31034;&#20301;&#32622;&#12434;&#22793;&#26356;&#12290;</span>
<span class="comment">%</span>
<span class="comment">% &#12371;&#12398;&#38306;&#25968;&#12391;year&#12364;&#34920;&#31034;&#12373;&#12428;&#12427;&#20301;&#32622;&#12434;&#22793;&#26356;&#12391;&#12365;&#12414;&#12377;&#12290;</span>
<span class="comment">%</span>
<span class="comment">% #0 -&gt;  year&#12399; author &#12398;&#12377;&#12368;&#24460;&#12395;&#34920;&#31034;&#12373;&#12428;&#12414;&#12377;&#12290;</span>
<span class="comment">% &#38750;&#12476;&#12525; -&gt; article &#12479;&#12452;&#12503;&#20197;&#22806;&#12391;&#12399; year &#12399; &#26368;&#24460;&#65288;note &#12501;&#12451;&#12540;&#12523;&#12489;&#12398;&#21069;&#65289;&#12395;&#34920;&#31034;&#12373;&#12428;&#12414;&#12377;&#12290;</span>
<span class="comment">%</span>
<span class="comment">% Article &#12479;&#12452;&#12503;&#12398;&#12456;&#12531;&#12488;&#12522;&#12540;&#12391;&#12399;&#27425;&#12398;&#12424;&#12358;&#12395;&#22793;&#12431;&#12426;&#12414;&#12377;&#12290;</span>
<span class="comment">% </span>
<span class="comment">% #1 -&gt; year &#12399;&#26368;&#24460;&#12395;&#34920;&#31034;&#12373;&#12428;&#12414;&#12377;&#12290;</span>
<span class="comment">% #2 -&gt; year &#12399; journal name &#12398;&#24460;&#12395;&#34920;&#31034;&#12373;&#12428;&#12414;&#12377;&#12290;</span>
<span class="comment">% #3 -&gt; year &#12399; volume &#12398;&#24460;&#12395;&#34920;&#31034;&#12373;&#12428;&#12414;&#12377;&#12290;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.year.position</span>}
{ #0 }    <span class="comment">% autho &#12398;&#12377;&#12368;&#24460; (default).</span>
<span class="comment">% { #1 }    % &#26368;&#24460;&#65288;note &#12398;&#21069;&#65289;</span>
<span class="comment">% { #2 }    % journal name &#12398;&#24460;&#65288;article entry&#12398;&#12415;&#65289;</span>
<span class="comment">% { #3 }    % volume &#12398;&#24460;&#65288;article entry&#12398;&#12415;&#65289;</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">% 0 &#20197;&#22806;&#12434;&#25351;&#23450;&#12377;&#12427;&#12392;&#26032;&#12375;&#12356;&#24180;&#12398;&#25991;&#29486;&#12434;&#21069;&#12395;&#12418;&#12387;&#12390;&#12367;&#12427;&#12290;</span>
<span class="comment">%</span>
<span class="comment">% 0 &#12394;&#12425;&#26222;&#36890;&#12398;&#20006;&#12403;&#38918;&#12290;&#36890;&#24120;&#12399; 0 &#12398;&#12414;&#12414;&#12391;&#12356;&#12356;&#12391;&#12375;&#12423;&#12358;&#65294;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.reverse.year</span>}
{ #0 }    <span class="comment">% &#26222;&#36890;&#12398;&#20006;&#12403;&#38918; (&#21476;&#12356;&#25991;&#29486;&#12411;&#12393;&#19978;) (default)</span>
<span class="comment">% { #1 }    % &#26222;&#36890;&#12392;&#12399;&#36870; (&#26032;&#12375;&#12356;&#25991;&#29486;&#12411;&#12393;&#19978;)</span>

<span class="comment">% 0 &#20197;&#22806;&#12394;&#12425; year &#12434;&#20778;&#20808;&#30340;&#12394;&#12461;&#12540;&#12392;&#12375;&#12390;&#12477;&#12540;&#12488;(&#20006;&#12409;&#26367;&#12360;)&#12434;&#12377;&#12427;&#12290;</span>
<span class="comment">% </span>
<span class="comment">% &#26222;&#36890;&#12391;&#12399;&#21476;&#12356;&#25991;&#29486;&#12411;&#12393;&#19978;&#12395;&#20006;&#12409;&#12425;&#12428;&#12427;&#12364;&#12289;bst.reverse.year &#12364;&#38750;&#12476;&#12525;&#12394;&#12425;&#26032;&#12375;&#12356;&#25991;</span>
<span class="comment">% &#29486;&#12411;&#12393;&#19978;&#12392;&#12394;&#12427;&#12290;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.sort.year</span>}
{ #0 }    <span class="comment">% &#12371;&#12398;&#22580;&#21512;&#12289;year &#12399; author &#12395;&#27425;&#12368;&#12477;&#12540;&#12488;&#12398;&#12461;&#12540; (&#26222;&#36890;&#12398;&#12465;&#12540;&#12473;) (default)</span>
<span class="comment">% { #1 }    % &#12371;&#12398;&#22580;&#21512;&#12289;year &#12399;&#26368;&#20778;&#20808;&#12373;&#12428;&#12427;&#12477;&#12540;&#12488;&#12398;&#12461;&#12540;</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">% &#24341;&#29992;&#38918;&#12391;&#21442;&#32771;&#25991;&#29486;&#12434;&#20006;&#12409;&#12427;&#35373;&#23450;&#65294;</span>
<span class="comment">%</span>
<span class="comment">% 0 &#20197;&#22806;&#12434;&#25351;&#23450;&#12377;&#12427;&#12392;&#24341;&#29992;&#12434;&#12375;&#12383;&#12381;&#12398;&#12414;&#12414;&#12398;&#38918;&#12391; reference &#12395;&#25991;&#29486;&#12434;&#20006;&#12409;&#12427;&#65294;\bysame </span>
<span class="comment">% &#12392;&#19968;&#32210;&#12395;&#21033;&#29992;&#12377;&#12427;&#12392;&#34920;&#31034;&#12364;&#12362;&#12363;&#12375;&#12367;&#12394;&#12427;&#12465;&#12540;&#12473;&#12354;&#12426;&#65294;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.no.sort</span>}
{ #0 }    <span class="comment">% &#25991;&#29486;&#12398;&#38918;&#30058;&#12434;&#26222;&#36890;&#12395;&#12477;&#12540;&#12488;&#12377;&#12427;&#65294;(default)</span>
<span class="comment">% { #1 }    % &#24341;&#29992;&#38918;&#12395;&#20006;&#12409;&#12427;&#65294;</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">% &#25991;&#29486;&#12398;&#20006;&#12409;&#26367;&#12360;&#12398;&#12392;&#12365;&#25991;&#29486;&#12456;&#12531;&#12488;&#12522;&#12540;&#12398;&#12479;&#12452;&#12503;&#21029; (article, book, incollection &#31561;)</span>
<span class="comment">% &#12395;&#12414;&#12392;&#12417;&#12427;&#12383;&#12417;&#12398;&#35373;&#23450;&#65294;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.sort.entry.type</span>}
{ #0 }    <span class="comment">% #0 -&gt; &#12479;&#12452;&#12503;&#21029;&#12395;&#12414;&#12392;&#12417;&#12394;&#12356;&#65294;(default)</span>
<span class="comment">% { #1 }    % &#12414;&#12392;&#12417;&#12427;&#65294;</span>
<span class="comment">%</span>
<span class="comment">% &#12371;&#12398;&#35373;&#23450;&#12399; absorder &#12424;&#12426;&#12418;&#20778;&#20808;&#12375;&#12414;&#12377;&#65294;&#12393;&#12358;&#12356;&#12358;&#38918;&#30058;&#12391;&#20006;&#12409;&#12427;&#12363; (article, book,</span>
<span class="comment">% incollection &#31561;&#12434;&#12393;&#12358;&#20006;&#12409;&#12427;&#12363;) &#12399; bst.sort.entry.type.order &#12392;&#12356;&#12358;&#38306;&#25968;&#12398;&#35373;&#23450;</span>
<span class="comment">% &#12391;&#27770;&#12414;&#12426;&#12414;&#12377;&#65294;&#12487;&#12501;&#12457;&#12540;&#12523;&#12488;&#12391;&#12399; alphabet &#38918;&#12395;&#12375;&#12390;&#12354;&#12426;&#12414;&#12377; (article, book,</span>
<span class="comment">% booklet, comment,..., unpublished &#38918;)&#65294;&#35443;&#12375;&#12367;&#12399; jecon-sample.pdf &#12434;&#21442;&#29031;&#12290;</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">% &#25991;&#29486;&#12398;&#20006;&#12409;&#26367;&#12360;&#12398;&#12392;&#12365; absorder filed &#12398;&#20516;&#12434;&#21033;&#29992;&#12377;&#12427;&#12363;&#21542;&#12363;&#12290;&#21033;&#29992;&#12377;&#12427;&#12394;&#12425;</span>
<span class="comment">% 0&#12289;&#21033;&#29992;&#12375;&#12394;&#12356;&#12394;&#12425; 0 &#20197;&#22806;&#12434;&#25351;&#23450;&#12290;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.notuse.absorder.field</span>}
{ #0 }    <span class="comment">% #0 -&gt; &#21033;&#29992;&#12377;&#12427;&#12290;(default)</span>
<span class="comment">% { #1 }    % #0 &#20197;&#22806; -&gt; &#21033;&#29992;&#12375;&#12394;&#12356;&#12290;</span>
<span class="comment">%</span>
<span class="comment">% Reference &#12391;&#12398;&#25991;&#29486;&#20006;&#12409;&#26367;&#12360;&#12398;&#20778;&#20808;&#38918;&#24207;&#12395;&#12388;&#12356;&#12390;&#12399; </span>
<span class="comment">% </span>
<span class="comment">% absorder -&gt; author (or yomi) -&gt; year -&gt; order -&gt; month -&gt; title</span>
<span class="comment">%</span>
<span class="comment">% &#12392;&#12375;&#12390;&#12354;&#12427;&#12290;&#35443;&#12375;&#12367;&#12399; jecon-sample.pdf &#12434;&#21442;&#29031;&#12290;</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">% &#25991;&#29486;&#12398;&#20006;&#12409;&#26367;&#12360;&#12398;&#12392;&#12365; order filed &#12398;&#20516;&#12434;&#21033;&#29992;&#12377;&#12427;&#12363;&#21542;&#12363;&#12290;&#21033;&#29992;&#12377;&#12427;&#12394;&#12425;</span>
<span class="comment">% 0&#12289;&#21033;&#29992;&#12375;&#12394;&#12356;&#12394;&#12425; 0 &#20197;&#22806;&#12434;&#25351;&#23450;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.notuse.order.field</span>}
{ #0 }    <span class="comment">% #0 -&gt; &#21033;&#29992;&#12377;&#12427;&#12290;(default)</span>
<span class="comment">% { #1 }    % #0 &#20197;&#22806; -&gt; &#21033;&#29992;&#12375;&#12394;&#12356;&#12290;</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%%%     and</span>

<span class="comment">%%% &#20108;&#20154;&#12398; authors, editors &#12398;&#38291;&#12398;&#25991;&#23383;&#21015;</span>
<span class="comment">%</span>
<span class="comment">% "Mr.A _ Mr.B " &#12398; "_" &#12398;&#37096;&#20998;&#12395;&#20837;&#12427;&#25991;&#23383;&#21015;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.and</span>}
{ <span class="string">" and "</span> }    <span class="comment">% (default)</span>

<span class="comment">%%% &#19977;&#20154;&#20197;&#19978;&#12398; authors, editors &#12398;&#38291;&#12398;&#25991;&#23383;&#21015;</span>
<span class="comment">%</span>
<span class="comment">% "Mr.A, Mr.B _ Mr.C" &#12398; "_" &#12398;&#37096;&#20998;&#12395;&#20837;&#12427;&#25991;&#23383;&#21015;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.ands</span>}
{ <span class="string">", and "</span> }    <span class="comment">% (default)</span>

<span class="comment">% &#35079;&#25968;&#12398; authors, editors &#12398;&#38291;&#12398;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="comment">% "A&#27663; _ B&#27663; _ C&#27663;" &#12398; "_" &#12398;&#37096;&#20998;&#12395;&#20837;&#12427;&#25991;&#23383;&#21015;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.and.jp</span>}
{ <span class="string">"&#12539;"</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%%%     &#12300;&#24341;&#29992;&#37096;&#20998;&#12301;&#12391;&#12398; author &#21517;&#12398;&#38291;&#12395;&#20837;&#12427;&#25991;&#23383;&#21015;</span>

<span class="comment">%%% &#20108;&#20154;&#12398; authors, editors &#12398;&#38291;&#12398;&#25991;&#23383;&#21015;</span>
<span class="comment">%</span>
<span class="comment">% &#24341;&#29992;&#37096;&#20998;&#12398; "Mr.A _ Mr.B " &#12398; "_" &#12398;&#37096;&#20998;&#12395;&#20837;&#12427;&#25991;&#23383;&#21015;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.cite.and</span>}
{ <span class="string">" and "</span> }    <span class="comment">% (default)</span>

<span class="comment">%%% &#19977;&#20154;&#20197;&#19978;&#12398; authors, editors &#12398;&#38291;&#12398;&#25991;&#23383;&#21015;</span>
<span class="comment">%</span>
<span class="comment">% &#24341;&#29992;&#37096;&#20998;&#12398; "Mr.A, Mr.B _ Mr.C" &#12398; "_" &#12398;&#37096;&#20998;&#12395;&#20837;&#12427;&#25991;&#23383;&#21015;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.cite.ands</span>}
{ <span class="string">" and "</span> }    <span class="comment">% (default)</span>

<span class="comment">% &#35079;&#25968;&#12398; authors, editors &#12398;&#38291;&#12398;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="comment">% &#24341;&#29992;&#37096;&#20998;&#12398; "A&#27663; _ B&#27663; _ C&#27663;" &#12398; "_" &#12398;&#37096;&#20998;&#12395;&#20837;&#12427;&#25991;&#23383;&#21015;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.cite.and.jp</span>}
{ <span class="string">"&#12539;"</span> }    <span class="comment">% (default)</span>


<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%</span>
<span class="comment">% &#20309;&#20154;&#20197;&#19978;&#12398;&#33879;&#32773;&#12364;&#12356;&#12427;&#12392;&#12365;&#12395;&#24341;&#29992;&#37096;&#20998;&#12391; et al.&#12391;&#30465;&#30053;&#12377;&#12427;&#12363;&#12290;3&#20154;&#20197;&#19978;&#12398;&#12392;&#12365;</span>
<span class="comment">% &#12395;&#30053;&#12377;&#12392;&#12365;&#12399; #3 &#12434;&#25351;&#23450;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.and.others.num</span>}
{ #3 }    <span class="comment">% 3&#20154;&#20197;&#19978;&#12394;&#12425;&#30465;&#30053;&#12377;&#12427;&#12290;(default)</span>
<span class="comment">% { #4 }</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%%%     author &#21517;&#12434;&#30053;&#12377;&#38555;&#12398;&#25991;&#23383;&#21015;</span>

<span class="comment">%%% &#33521;&#35486;&#29992;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.and.others</span>}
{ <span class="string">" et~al."</span> }    <span class="comment">% (default)</span>

<span class="comment">%%% &#26085;&#26412;&#35486;&#29992;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.and.others.jp</span>}
{ <span class="string">"&#20182;"</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       author </span>

<span class="comment">% author &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.author.pre</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">% author &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.author.post</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">% author &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.author.pre.jp</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">% author &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.author.post.jp</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">%%% &#26085;&#26412;&#35486;&#25991;&#29486;&#12398; author, editor &#12398;&#22995;&#12539;&#21517;&#12398;&#38291;&#12395;&#20837;&#12428;&#12427;&#25991;&#23383;&#21015; </span>
<span class="comment">% (&#22995;&#21517;&#12398;&#12393;&#12385;&#12425;&#12363;&#19968;&#26041;&#12364;&#19968;&#25991;&#23383;&#12398;&#12465;&#12540;&#12473;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.sei.mei.one.jp</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>
<span class="comment">% { "&#12288;" }</span>

<span class="comment">%%% &#26085;&#26412;&#35486;&#25991;&#29486;&#12398; author, editor &#12398;&#22995;&#12539;&#21517;&#12398;&#38291;&#12395;&#20837;&#12428;&#12427;&#25991;&#23383;&#21015; </span>
<span class="comment">% (&#22995;&#12539;&#21517;&#12392;&#12418;&#20108;&#25991;&#23383;&#20197;&#19978;&#12398;&#12465;&#12540;&#12473;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.sei.mei.two.jp</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>
<span class="comment">% { " " }</span>


<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       year</span>

<span class="comment">% year &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.year.pre</span>}
{ <span class="string">" ("</span> }    <span class="comment">% (default)</span>

<span class="comment">% year &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.year.post</span>}
{ <span class="string">") "</span> }    <span class="comment">% (default)</span>

<span class="comment">% year &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.year.pre.jp</span>}
{ <span class="string">" ("</span> }    <span class="comment">% (default)</span>

<span class="comment">% year &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.year.post.jp</span>}
{ <span class="string">") "</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       title (book &#20197;&#22806;)</span>

<span class="comment">% title &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.title.pre</span>}
{ <span class="string">"``"</span> }    <span class="comment">% (default)</span>

<span class="comment">% title &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.title.post</span>}
{ <span class="string">",''"</span> }    <span class="comment">% (default)</span>

<span class="comment">% title &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.title.pre.jp</span>}
{ <span class="string">"&#12300;"</span> }    <span class="comment">% (default)</span>

<span class="comment">% title &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.title.post.jp</span>}
{ <span class="string">"&#12301;&#65292;"</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       book &#29992; title</span>

<span class="comment">% book &#12398; title &#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.book.pre</span>}
{ <span class="string">" \textit{ "</span> }    <span class="comment">% (default)</span>

<span class="comment">% book &#12398; title &#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.book.post</span>}
{ <span class="string">"}"</span> }    <span class="comment">% (default)</span>

<span class="comment">% book &#12398; title &#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.book.pre.jp</span>}
{ <span class="string">"&#12302;"</span> }    <span class="comment">% (default)</span>

<span class="comment">% book &#12398; title &#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.book.post.jp</span>}
{ <span class="string">"&#12303;"</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       booktitle</span>

<span class="comment">% booktitle &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.btitle.pre</span>}
{ <span class="string">" \textit{ "</span> }    <span class="comment">% (default)</span>

<span class="comment">% booktitle &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.btitle.post</span>}
{ <span class="string">"}"</span> }    <span class="comment">% (default)</span>

<span class="comment">% booktitle &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.btitle.pre.jp</span>}
{ <span class="string">"&#12302;"</span> }    <span class="comment">% (default)</span>

<span class="comment">% booktitle &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.btitle.post.jp</span>}
{ <span class="string">"&#12303;"</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       journal name</span>

<span class="comment">% journal name &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.journal.pre</span>}
{ <span class="string">" \textit{ "</span> }    <span class="comment">% (default)</span>

<span class="comment">% journal name &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.journal.post</span>}
{ <span class="string">"}"</span> }    <span class="comment">% (default)</span>

<span class="comment">% journal name &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.journal.pre.jp</span>}
{ <span class="string">"&#12302;"</span> }    <span class="comment">% (default)</span>

<span class="comment">% journal name &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.journal.post.jp</span>}
{ <span class="string">"&#12303;"</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       editor &#35352;&#21495;</span>

<span class="comment">% &#35079;&#25968; editor &#12434;&#34920;&#12377;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.editors</span>}
{ <span class="string">" eds. "</span> }    <span class="comment">% (default)</span>

<span class="comment">% &#19968;&#20154;&#12398; editor &#12434;&#34920;&#12377;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.editor</span>}
{ <span class="string">" ed. "</span> }    <span class="comment">% (default)</span>

<span class="comment">% editor &#12434;&#34920;&#12377;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.editor.jp</span>}
{ <span class="string">"&#65288;&#32232;&#65289;"</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       kanyaku (&#30435;&#35379;&#32773;)</span>

<span class="comment">% kanyaku &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.kanyaku.pre.jp</span>}
{ <span class="string">"&#65292;"</span> }    <span class="comment">% (default)</span>

<span class="comment">% kanyaku &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.kanyaku.post.jp</span>}
{ <span class="string">"&#30435;&#35379;"</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       translator (&#32763;&#35379;&#32773;)</span>

<span class="comment">% translator &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.translator.pre.jp</span>}
{ <span class="string">"&#65292;"</span> }    <span class="comment">% (default)</span>

<span class="comment">% translator &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.translator.post.jp</span>}
{ <span class="string">"&#35379;"</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       edition</span>

<span class="comment">% edition &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.edition.pre</span>}
{ <span class="string">", "</span> }    <span class="comment">% (default)</span>

<span class="comment">% edition &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.edition.post</span>}
{ <span class="string">" edition"</span> }    <span class="comment">% (default)</span>

<span class="comment">% edition &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.edition.pre.jp</span>}
{ <span class="string">"&#65292;&#31532;"</span> }    <span class="comment">% (default)</span>

<span class="comment">% edition &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.edition.post.jp</span>}
{ <span class="string">"&#29256;"</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       volume</span>

<span class="comment">% volume &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.volume.pre</span>}
{ <span class="string">", Vol. "</span> }    <span class="comment">% (default)</span>

<span class="comment">% volume &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.volume.post</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">% volume &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.volume.pre.jp</span>}
{ <span class="string">"&#65292;&#31532;"</span> }    <span class="comment">% (default)</span>

<span class="comment">% volume &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.volume.post.jp</span>}
{ <span class="string">"&#24059;"</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       number</span>

<span class="comment">% number &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.number.pre</span>}
{ <span class="string">", No. "</span> }    <span class="comment">% (default)</span>

<span class="comment">% number &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.number.post</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">% number &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.number.pre.jp</span>}
{ <span class="string">"&#65292;&#31532;"</span> }    <span class="comment">% (default)</span>

<span class="comment">% number &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.number.post.jp</span>}
{ <span class="string">"&#21495;"</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       in </span>

<span class="comment">% In (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.in</span>}
{ <span class="string">" in "</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       page</span>

<span class="comment">% page &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#35079;&#25968;&#12506;&#12540;&#12472;) (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.pages.pre</span>}
{ <span class="string">", pp."</span> }    <span class="comment">% (default)</span>

<span class="comment">% page &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.page.pre</span>}
{ <span class="string">", p."</span> }    <span class="comment">% (default)</span>

<span class="comment">% page &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#35079;&#25968;&#12506;&#12540;&#12472;) (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.pages.post</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">% page &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.page.post</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">% page &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.page.pre.jp</span>}
{ <span class="string">"&#65292;"</span> }    <span class="comment">% (default)</span>

<span class="comment">% page &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.page.post.jp</span>}
{ <span class="string">"&#38913;"</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       chapter</span>

<span class="comment">% chapter &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.chapter.pre</span>}
{ <span class="string">", Chap."</span> }    <span class="comment">% (default)</span>

<span class="comment">% chapter &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.chapter.post</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">% chapter &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.chapter.pre.jp</span>}
{ <span class="string">"&#65292;&#31532;"</span> }    <span class="comment">% (default)</span>

<span class="comment">% chapter &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.chapter.post.jp</span>}
{ <span class="string">"&#31456;"</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       month</span>

<span class="comment">% month &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.month.pre</span>}
{ <span class="string">", "</span> }    <span class="comment">% (default)</span>

<span class="comment">% month &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.month.post</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">% month &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.month.pre.jp</span>}
{ <span class="string">"&#65292;"</span> }    <span class="comment">% (default)</span>

<span class="comment">% month &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.month.post.jp</span>}
{ <span class="string">"&#26376;"</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       address</span>
<span class="comment">% address &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.address.pre</span>}
{ <span class="string">", "</span> }    <span class="comment">% (default)</span>

<span class="comment">% address &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.address.post</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">% address &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.address.pre.jp</span>}
{ <span class="string">"&#65292;"</span> }    <span class="comment">% (default)</span>

<span class="comment">% address &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.address.post.jp</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       publisher</span>

<span class="comment">% publisher &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.publisher.pre</span>}
{ <span class="string">": "</span> }    <span class="comment">% (default)</span>

<span class="comment">% publisher &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.publisher.post</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">% publisher &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.publisher.pre.jp</span>}
{ <span class="string">"&#65292;"</span> }    <span class="comment">% (default)</span>

<span class="comment">% publisher &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.publisher.post.jp</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       series</span>

<span class="comment">% series &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.series.pre</span>}
{ <span class="string">", "</span> }    <span class="comment">% (default)</span>

<span class="comment">% series &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.series.post</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">% series &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.series.pre.jp</span>}
{ <span class="string">"&#65292;"</span> }    <span class="comment">% (default)</span>

<span class="comment">% series &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.series.post.jp</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       organization</span>

<span class="comment">% organization &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.organization.pre</span>}
{ <span class="string">", "</span> }    <span class="comment">% (default)</span>

<span class="comment">% organization &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.organization.post</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>
<span class="comment">% organization &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.organization.pre.jp</span>}
{ <span class="string">"&#65292;"</span> }    <span class="comment">% (default)</span>

<span class="comment">% organization &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.organization.post.jp</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       school</span>

<span class="comment">% school &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.school.pre</span>}
{ <span class="string">", "</span> }    <span class="comment">% (default)</span>

<span class="comment">% school &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.school.post</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">% school &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.school.pre.jp</span>}
{ <span class="string">"&#65292;"</span> }    <span class="comment">% (default)</span>

<span class="comment">% school &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.school.post.jp</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       institution</span>

<span class="comment">% institution &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.institution.pre</span>}
{ <span class="string">", "</span> }    <span class="comment">% (default)</span>

<span class="comment">% institution &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.institution.post</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">% institution &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.institution.pre.jp</span>}
{ <span class="string">"&#65292;"</span> }    <span class="comment">% (default)</span>

<span class="comment">% institution &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.institution.post.jp</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       howpublished</span>

<span class="comment">% howpublished &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.howpublished.pre</span>}
{ <span class="string">" "</span> }    <span class="comment">% (default)</span>

<span class="comment">% howpublished &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.howpublished.post</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">% howpublished &#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.howpublished.pre.jp</span>}
{ <span class="string">"&#65292;"</span> }    <span class="comment">% (default)</span>

<span class="comment">% howpublished &#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.howpublished.post.jp</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       url</span>

<span class="comment">% URL&#12501;&#12451;&#12540;&#12523;&#12489;&#65294;&#38750;&#12476;&#12525;&#12434;&#25351;&#23450;&#12377;&#12427;&#12392;URL&#12364;&#34920;&#31034;&#12373;&#12428;&#12427;&#65294;&#12476;&#12525;&#12398;&#12392;&#12365;&#12399;&#38750;&#34920;&#31034;&#65294;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.show.url</span>}
{ #1 }    <span class="comment">% non-#0 -&gt; URL&#12434;&#34920;&#31034; (default)</span>
<span class="comment">% { #0 }    % #0 -&gt; URL&#12434;&#38750;&#34920;&#31034;</span>

<span class="comment">% URL&#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.url.pre</span>}
{ <span class="string">", URL: \url{"</span> }      <span class="comment">% (default)</span>

<span class="comment">% URL&#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.url.post</span>}
{ <span class="string">"}"</span> }    <span class="comment">% (default)</span>

<span class="comment">% URL&#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.url.pre.jp</span>}
{ <span class="string">"&#65292;URL&#65306;\url{"</span> }      <span class="comment">% (default)</span>

<span class="comment">% URL&#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.url.post.jp</span>}
{ <span class="string">"}"</span> }    <span class="comment">% (default)</span>


<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       Access</span>

<span class="comment">% Access&#12501;&#12451;&#12540;&#12523;&#12489;&#65294;access&#12501;&#12451;&#12540;&#12523;&#12489;&#12399;URL&#12395;&#12450;&#12463;&#12475;&#12473;&#12375;&#12383;&#26085;&#20184;&#12369;&#12434;&#25351;&#23450;&#12375;&#12390;&#12362;&#12367;&#65294;&#12371;</span>
<span class="comment">% &#12428;&#12399;&#26222;&#36890;&#12398;bib&#12501;&#12449;&#12452;&#12523;&#12395;&#12399;&#12394;&#12356;&#12501;&#12451;&#12540;&#12523;&#12489;&#65294;</span>

<span class="comment">% access&#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.access.pre</span>}
{ <span class="string">", accessed on "</span> } <span class="comment">% (default)</span>

<span class="comment">% access&#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.access.post</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">% access&#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.access.pre.jp</span>}
{ <span class="string">"&#65288;&#12450;&#12463;&#12475;&#12473;&#26085;: "</span> } <span class="comment">% (default)</span>

<span class="comment">% access&#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.access.post.jp</span>}
{ <span class="string">"&#65289;"</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       DOI (digital object identifier)</span>

<span class="comment">% DOI&#12501;&#12451;&#12540;&#12523;&#12489;&#65294;DOI&#12434;&#25351;&#23450;&#65294;&#12371;&#12428;&#12418;&#26222;&#36890;&#12398;bib&#12501;&#12449;&#12452;&#12523;&#12395;&#12399;&#12394;&#12356;&#12501;&#12451;&#12540;&#12523;&#12489;&#65294;</span>

<span class="comment">% &#38750;&#12476;&#12525;&#12394;&#12425;DOI&#12434;&#34920;&#31034;&#65294;&#12476;&#12525;&#12394;&#12425;&#38750;&#34920;&#31034;&#65294;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.show.doi</span>}
{ #1 }    <span class="comment">% non-#0 -&gt; Show DOI field (default)</span>
<span class="comment">% { #0 }    % #0 -&gt; Not show DOI field.</span>

<span class="comment">% DOI&#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.doi.pre</span>}
{ <span class="string">", DOI: \url{http://dx.doi.org/"</span> } <span class="comment">% (default)</span>

<span class="comment">% DOI&#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.doi.post</span>}
{ <span class="string">"}"</span> }    <span class="comment">% (default)</span>

<span class="comment">% DOI&#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.doi.pre.jp</span>}
{ <span class="string">"&#65292;DOI&#65306;\url{http://dx.doi.org/"</span> } <span class="comment">% (default)</span>

<span class="comment">% DOI&#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.doi.post.jp</span>}
{ <span class="string">"}"</span> }    <span class="comment">% (default)</span>

<span class="comment">% URL &#12392; DOI &#12398;&#34920;&#31034;&#26041;&#27861;</span>
<span class="comment">%</span>
<span class="comment">% DOI &#12392; URL &#12364;&#20001;&#26041;&#12354;&#12427;&#12465;&#12540;&#12473;&#12398; DOI &#12392; URL &#12398;&#20966;&#29702;&#26041;&#27861;</span>
<span class="comment">%</span>
<span class="comment">% #0 -&gt; &#20001;&#26041;&#34920;&#31034;</span>
<span class="comment">% #1 -&gt; URL &#12398;&#12415;&#34920;&#31034;</span>
<span class="comment">% #2 -&gt; DOI &#12398;&#12415;&#34920;&#31034;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.url.doi</span>}
{ #0 }    <span class="comment">% (default) -&gt; &#20001;&#26041;&#34920;&#31034;</span>
<span class="comment">% { #1 }    % -&gt; URL &#12398;&#12415;&#34920;&#31034;</span>
<span class="comment">% { #2 }    % -&gt; DOI &#12398;&#12415;&#34920;&#31034;</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       &#37030;&#35379;&#26360;</span>

<span class="keyword">FUNCTION</span> {<span class="function-name">bst.hoyakusho.pre.jp</span>}
{ <span class="string">"&#65288;"</span> }    <span class="comment">% (default)</span>

<span class="keyword">FUNCTION</span> {<span class="function-name">bst.hoyakusho.post.jp</span>}
{ <span class="string">"&#65289;"</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%</span>
<span class="comment">% &#21477;&#28857;&#12398;&#25351;&#23450;&#65294;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.kuten.jp</span>}
{ <span class="string">"&#65294;"</span> }    <span class="comment">% (default)</span>

<span class="comment">% &#35501;&#28857;&#12398;&#25351;&#23450;&#65294;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.touten.jp</span>}
{ <span class="string">"&#65292;"</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       </span>
<span class="comment">% 0 &#20197;&#22806;&#12434;&#25351;&#23450;&#12377;&#12428;&#12400;&#65292;page &#12434;&#32331;&#12368; "-" &#12434; "--" &#12395;&#22793;&#26356;&#12375;&#12394;&#12356;&#65294;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.dashify.off</span>}
<span class="comment">% { #0 }</span>
{ #1 }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%</span>
<span class="comment">% &#38750;&#12476;&#12525;&#12434;&#25351;&#23450;&#12377;&#12427;&#12392; \harvarditem &#12434;&#20986;&#21147;&#12375;&#12394;&#12356;&#65294;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.harvarditem.off</span>}
{ #0 }    <span class="comment">% (default)</span>
<span class="comment">% { #1 }</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       \thebibliography&#29872;&#22659;&#12398;&#23450;&#32681;</span>
<span class="comment">%</span>
<span class="comment">% thebibliography&#21629;&#20196;&#12398;&#21069;&#12420;&#24460;&#12395;&#20309;&#12363;&#12434;&#20837;&#12428;&#12383;&#12356;&#12392;&#12365;&#12399;&#22793;&#26356;&#12375;&#12390;&#12367;&#12384;&#12373;&#12356;&#65294;</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.thebibliography.begin</span>}
{
  <span class="string">""</span> <span class="builtin">write$</span> <span class="builtin">newline$</span>
  <span class="string">"\begin{thebibliography}{xxx}"</span> <span class="builtin">write$</span> <span class="builtin">newline$</span>
  <span class="string">""</span> <span class="builtin">write$</span> <span class="builtin">newline$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">bst.thebibliography.end</span>}
{ 
  <span class="string">""</span> <span class="builtin">write$</span> <span class="builtin">newline$</span>
  <span class="string">"\end{thebibliography}"</span> <span class="builtin">write$</span> <span class="builtin">newline$</span>
  <span class="string">""</span> <span class="builtin">write$</span> <span class="builtin">newline$</span>
}

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       &#12381;&#12398;&#20182;&#12398;&#38306;&#25968;</span>

<span class="comment">% note&#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.note.pre</span>}
{ <span class="string">", "</span> }    <span class="comment">% (default)</span>

<span class="comment">% note&#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.note.post</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">% note&#12398;&#21069;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.note.pre.jp</span>}
{ <span class="string">"&#65292;"</span> }    <span class="comment">% (default)</span>

<span class="comment">% note&#12398;&#24460;&#12395;&#20184;&#12369;&#12427;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.note.post.jp</span>}
{ <span class="string">""</span> }    <span class="comment">% (default)</span>

<span class="comment">% Technical report &#12434;&#34920;&#12377;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.techrep</span>}
{ <span class="string">" Tech. Rep."</span> }    <span class="comment">% (default)</span>

<span class="comment">% Technical report &#12434;&#34920;&#12377;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.techrep.jp</span>}
{ <span class="string">" &#12486;&#12463;&#12491;&#12459;&#12523;&#12539;&#12524;&#12509;&#12540;&#12488;"</span> }    <span class="comment">% (default)</span>

<span class="comment">% master thesis &#12434;&#34920;&#12377;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.mthesis</span>}
{ <span class="string">" Master's thesis"</span> }    <span class="comment">% (default)</span>

<span class="comment">% master thesis &#12434;&#34920;&#12377;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.mthesis.jp</span>}
{ <span class="string">"&#20462;&#22763;&#35542;&#25991;"</span> }    <span class="comment">% (default)</span>

<span class="comment">% phd thesis &#12434;&#34920;&#12377;&#25991;&#23383;&#21015; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.phdthesis</span>}
{ <span class="string">" Ph.D. dissertation"</span> }    <span class="comment">% (default)</span>

<span class="comment">% phd thesis &#12434;&#34920;&#12377;&#25991;&#23383;&#21015; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.phdthesis.jp</span>}
{ <span class="string">"&#21338;&#22763;&#35542;&#25991;"</span> }    <span class="comment">% (default)</span>

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%%</span>
<span class="comment">%%      &#12459;&#12473;&#12479;&#12510;&#12452;&#12474;&#12398;&#12383;&#12417;&#12398;&#38306;&#25968;&#12399;&#12371;&#12371;&#12414;&#12391;&#12290;</span>
<span class="comment">%%</span>
<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>

<span class="comment">%%% &#20197;&#19979;&#12399;&#33521;&#35486;&#25991;&#29486;&#29992;</span>

<span class="keyword">FUNCTION</span> {<span class="function-name">bst.first</span>}
{ <span class="string">"1st"</span> }

<span class="keyword">FUNCTION</span> {<span class="function-name">bst.second</span>}
{ <span class="string">"2nd"</span> }

<span class="keyword">FUNCTION</span> {<span class="function-name">bst.third</span>}
{ <span class="string">"3rd"</span> }

<span class="keyword">FUNCTION</span> {<span class="function-name">bst.fourth</span>}
{ <span class="string">"4th"</span> }

<span class="keyword">FUNCTION</span> {<span class="function-name">bst.fifth</span>}
{ <span class="string">"5th"</span> }

<span class="keyword">FUNCTION</span> {<span class="function-name">bst.st</span>}
{ <span class="string">"st"</span> }

<span class="keyword">FUNCTION</span> {<span class="function-name">bst.nd</span>}
{ <span class="string">"nd"</span> }

<span class="keyword">FUNCTION</span> {<span class="function-name">bst.rd</span>}
{ <span class="string">"rd"</span> }

<span class="keyword">FUNCTION</span> {<span class="function-name">bst.th</span>}
{ <span class="string">"th"</span> }

<span class="comment">%%%%% memo by Takeda</span>

<span class="comment">% "a" 'b := &#12399; b &#12392;&#12356;&#12358;&#22793;&#25968;&#12395; "a" &#12392;&#12356;&#12358;&#25991;&#23383;&#21015;&#12434;&#20195;&#20837;&#12377;&#12427;&#12392;&#12356;&#12358;&#12371;&#12392;&#12290;</span>

<span class="comment">% #0 &#12399;&#25972;&#25968;&#12398; 0&#12289;#1 &#12399;&#25972;&#25968;&#12398; 1&#65294;&#65294;&#65294;&#12434;&#34920;&#12377;&#12290;</span>

<span class="comment">%%% &#38306;&#25968;&#12398;&#26360;&#24335;</span>
<span class="comment">%</span>
<span class="comment">% FUNCTION {name}</span>
<span class="comment">% { 's :=</span>
<span class="comment">%</span>
<span class="comment">% }</span>
<span class="comment">%</span>
<span class="comment">% &#19978;&#12399; name &#12392;&#12356;&#12358;&#38306;&#25968;&#12398;&#23450;&#32681;&#12290;&#21628;&#20986;&#12375;&#20596;&#12391;&#12399;</span>
<span class="comment">%</span>
<span class="comment">% "hoge" name</span>
<span class="comment">%</span>
<span class="comment">% &#12392;&#12356;&#12358;&#24418;&#12391;&#25351;&#23450;&#12290;"hoge" &#12392;&#12356;&#12358;&#25991;&#23383;&#21015;&#12364;&#12289;&#22793;&#25968; s &#12395;&#20195;&#20837;&#12373;&#12428;&#12427;&#12290;</span>
<span class="comment">%</span>
<span class="comment">% &#24341;&#25968;&#12364;&#20108;&#12388;&#20197;&#19978;&#12398;&#38306;&#25968;&#12398;&#23450;&#32681; --&gt; &#38306;&#25968; chop.word &#12434;&#21442;&#29031;&#12290;</span>

<span class="keyword">ENTRY</span>

  <span class="comment">%%% &#25991;&#29486;&#12501;&#12451;&#12540;&#12523;&#12489;&#12398;&#23459;&#35328;</span>
  { <span class="variable-name">access</span> <span class="variable-name">address</span> <span class="variable-name">author</span> <span class="variable-name">booktitle</span> <span class="variable-name">chapter</span> <span class="variable-name">doi</span> <span class="variable-name">edition</span> <span class="variable-name">editor</span> <span class="variable-name">howpublished</span>
    <span class="variable-name">institution</span> <span class="variable-name">journal</span> <span class="variable-name">key</span> <span class="variable-name">month</span> <span class="variable-name">note</span> <span class="variable-name">number</span> <span class="variable-name">organization</span> <span class="variable-name">pages</span> <span class="variable-name">publisher</span>
    <span class="variable-name">school</span> <span class="variable-name">series</span> <span class="variable-name">title</span> <span class="variable-name">type</span> <span class="variable-name">url</span> <span class="variable-name">volume</span> <span class="variable-name">year</span> <span class="variable-name">yomi</span> <span class="variable-name">language</span>

    <span class="comment">% &#20197;&#19979;&#12399;&#26222;&#36890;&#12398; bst &#12501;&#12449;&#12452;&#12523;&#12391;&#12399;&#21033;&#29992;&#12373;&#12428;&#12394;&#12356;&#12501;&#12451;&#12540;&#12523;&#12489;</span>
    <span class="variable-name">jauthor</span> <span class="variable-name">jkanyaku</span> <span class="variable-name">jtitle</span> <span class="variable-name">jpublisher</span> <span class="variable-name">jyear</span>
    <span class="variable-name">order</span> <span class="variable-name">absorder</span> <span class="variable-name">translator</span> <span class="variable-name">kanyaku</span>
  }

  <span class="comment">% &#20197;&#19979;&#65292;&#12456;&#12531;&#12488;&#12522;&#12540;&#22793;&#25968;&#12398;&#23450;&#32681;&#65294;&#12456;&#12531;&#12488;&#12522;&#12540;&#22793;&#25968;&#12392;&#12399;&#65292;&#25991;&#29486;&#12456;&#12531;&#12488;&#12522;&#12540;&#21029;&#12395;&#30064;&#12394;&#12387;</span>
  <span class="comment">% &#12383;&#20516;&#12434;&#25345;&#12388;&#22793;&#25968;&#12398;&#12371;&#12392;&#65294;</span>

  <span class="comment">%% &#12371;&#12428;&#12399; entry &#21029;&#12398;&#25972;&#25968;&#22411;&#22793;&#25968; (&#25972;&#25968;&#22411;&#12456;&#12531;&#12488;&#12522;&#22793;&#25968;)</span>
  { is.kanji.entry is.kanji.entry.two order.cited is.kanji.entry.author }

  <span class="comment">%% &#12371;&#12428;&#12399; entry &#21029;&#12398;&#25991;&#23383;&#21015;&#22411;&#22793;&#25968; (&#25991;&#23383;&#21015;&#22411;&#12456;&#12531;&#12488;&#12522;&#22793;&#25968;)</span>
  { label cyear flabel alabel extra.label sort.label sort.label.abb
    extra.label.bysame }

<span class="comment">%%% &#22793;&#25968;&#23459;&#35328;</span>

<span class="comment">%% &#25991;&#23383;&#21015;&#22411;&#22823;&#22495;&#22793;&#25968;</span>
<span class="keyword">STRINGS</span> { s t ss tt sss }
<span class="keyword">STRINGS</span> { year.num }
<span class="keyword">STRINGS</span> { num.kanji }
<span class="keyword">STRINGS</span> { preone preten }
<span class="keyword">STRINGS</span> { last.sort.label next.extra this.author prev.author prev.author.jecon }
<span class="keyword">STRINGS</span> { hang }
<span class="keyword">STRINGS</span> { item.type }
<span class="keyword">STRINGS</span> { tempa tempb tempc }

<span class="comment">%% &#25972;&#25968;&#22411;&#22823;&#22495;&#22793;&#25968;</span>
<span class="keyword">INTEGERS</span> { nameptr namesleft numnames  alphabet.in.author name.num }
<span class="keyword">INTEGERS</span> { bysame.check }
<span class="keyword">INTEGERS</span> { multiresult }
<span class="keyword">INTEGERS</span> { index }
<span class="keyword">INTEGERS</span> { len }
<span class="keyword">INTEGERS</span> { last.extra.num }
<span class="keyword">INTEGERS</span> { output.state before.all mid.sentence after.sentence after.block int }
<span class="keyword">INTEGERS</span> { last.period.comma }
<span class="keyword">INTEGERS</span> { len1.jecon len2.jecon i.jecon }

<span class="comment">%%% &#22793;&#25968;&#12398;&#35500;&#26126;</span>

<span class="comment">% alabel: &#24341;&#29992;&#37096;&#20998;&#12391;&#21033;&#29992;&#12373;&#12428;&#12427; author (editor) &#21517; (&#30465;&#30053;&#24418;)&#12434;&#20445;&#25345;&#12377;&#12427;&#22793;&#25968;&#65294; </span>
<span class="comment">% reference &#37096;&#20998;&#12398;&#34920;&#31034;&#12395;&#12399;&#28961;&#38306;&#20418;&#65294;</span>

<span class="comment">% flabel: &#24341;&#29992;&#37096;&#20998;&#12391;&#21033;&#29992;&#12373;&#12428;&#12427; author (editor) &#21517;&#12434;&#20445;&#25345;&#12377;&#12427;&#22793;&#25968;&#65294; reference &#37096;</span>
<span class="comment">% &#20998;&#12398;&#34920;&#31034;&#12395;&#12399;&#28961;&#38306;&#20418;&#65294;</span>

<span class="comment">% sort.label: &#25991;&#29486;&#12398;&#12477;&#12540;&#12488;&#12398;&#12383;&#12417;&#12398; author (editor) &#21517;&#12434;&#20445;&#25345;&#12377;&#12427;&#22793;&#25968;&#65294;</span>

<span class="comment">% sort.label.abb: &#25991;&#29486;&#12398;&#12477;&#12540;&#12488;&#12398;&#12383;&#12417;&#12398; author (editor) &#21517;&#12434;&#20445;&#25345;&#12377;&#12427;&#22793;&#25968;&#65294;&#12371;&#12385;&#12425;</span>
<span class="comment">% &#12399; abbreviated name &#12391;&#12398;&#34920;&#29694;&#65294;</span>

<span class="comment">% sort.key$: &#25991;&#29486;&#12398;&#12477;&#12540;&#12488; (&#20006;&#12409;&#26367;&#12360;) &#12398;&#12383;&#12417;&#12395;&#21033;&#29992;&#12373;&#12428;&#12427;&#25991;&#23383;&#21015;&#12434;&#20445;&#25345;&#12377;&#12427;&#65294;</span>
<span class="comment">% jecon.debug &#12434;&#38750;&#12476;&#12525;&#12395;&#12377;&#12428;&#12400;&#12393;&#12398;&#12424;&#12358;&#12394;&#20516;&#12364;&#20837;&#12387;&#12390;&#12356;&#12427;&#12363;&#34920;&#31034;&#12391;&#12365;&#12427; (&#36890;&#24120;&#12399; </span>
<span class="comment">% author - year - title - month &#31561;&#12364;&#32331;&#12387;&#12383;&#25991;&#23383;&#21015;&#12364;&#25351;&#23450;&#12373;&#12428;&#12427;)&#65294;</span>

<span class="comment">% extra.label: &#33879;&#32773;&#21517;&#12364;&#21516;&#12376;&#12392;&#12365;&#12395;&#24180;&#12395;&#20184;&#12369;&#12427;&#12450;&#12523;&#12501;&#12449;&#12505;&#12483;&#12488;&#12290;</span>

<span class="comment">% &#20197;&#19979;&#12399; Type 1 &#12398; bysame &#12434;&#21033;&#29992;&#12377;&#12427;&#12392;&#12365;&#12395;&#20351;&#12358;&#22793;&#25968;&#12290;</span>
<span class="comment">% </span>
<span class="comment">% this.author: &#29694;&#22312;&#12398; author (or editor) &#12434;&#20837;&#12428;&#12427;&#22793;&#25968;</span>
<span class="comment">% prev.author: &#19968;&#20491;&#21069;&#12398; author (or editor) &#12434;&#20837;&#12428;&#12427;&#22793;&#25968;</span>
<span class="comment">% extra.label.bysame:</span>
<span class="comment">% &#12371;&#12428;&#12399;&#12456;&#12531;&#12488;&#12522;&#12540;&#22793;&#25968;&#12290;bysame &#12434;&#21033;&#29992;&#12377;&#12427;&#25991;&#29486;&#12398;&#22580;&#21512;&#12395;&#12399;&#12289;"bysame" &#12434;&#20837;&#12428;&#12427;&#12290;</span>

<span class="comment">% &#20197;&#19979;&#12399; Type 2 &#12398; bysame &#12434;&#21033;&#29992;&#12377;&#12427;&#12392;&#12365;&#12395;&#20351;&#12358;&#22793;&#25968;&#12290;</span>
<span class="comment">% </span>
<span class="comment">% prev.author.jecon: &#19968;&#20491;&#21069;&#12398; author (or editor) &#12434;&#20837;&#12428;&#12427;&#22793;&#25968;</span>
<span class="comment">% len1.jecon len2.jecon i.jecon</span>


<span class="comment">%%% &#27726;&#29992;&#12398;&#38306;&#25968;&#12398;&#23450;&#32681;</span>

<span class="keyword">FUNCTION</span> {<span class="function-name">not</span>}
{   { #0 }
    { #1 }
  <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">and</span>}
{   '<span class="builtin">skip$</span>
    { <span class="builtin">pop$</span> #0 }
  <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">or</span>}
{   { <span class="builtin">pop$</span> #1 }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
}

<span class="comment">%%% &#22793;&#25968;&#12398;&#20516;&#12434;&#21021;&#26399;&#21270;&#12377;&#12427;&#38306;&#25968;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">init.state.consts</span>}
{ #0 'before.all <span class="constant">:=</span>
  #1 'mid.sentence <span class="constant">:=</span>
  #2 'after.sentence <span class="constant">:=</span>
  #3 'after.block <span class="constant">:=</span>
}

<span class="comment">%%% comma &#12434;&#38500;&#21435;&#12375;&#12289;period &#12434;&#20184;&#12369;&#12427;(&#12395;&#22793;&#12360;&#12427;)&#38306;&#25968; (&#33521;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="comment">%</span>
<span class="comment">% #-1 #1 substring$ &#12399;&#24460;&#12429;&#12363;&#12425;&#19968;&#25991;&#23383;&#30446;&#12434;&#25244;&#12365;&#20986;&#12377;&#20966;&#29702;&#12434;&#12377;&#12427;&#12290;</span>
<span class="comment">%%%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">add.period.x</span>}
{ <span class="builtin">duplicate$</span>
  <span class="comment">% &#24460;&#12429;&#12363;&#12425;1&#25991;&#23383;&#12392;&#12387;&#12390;&#27604;&#36611;</span>
  #-1 #1 <span class="builtin">substring$</span> <span class="string">","</span> =
    { #-2 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> <span class="string">"."</span> * }
    { <span class="builtin">duplicate$</span>
      <span class="comment">% &#24460;&#12429;&#12363;&#12425;2&#25991;&#23383;&#12392;&#12387;&#12390;&#27604;&#36611;</span>
      #-1 #2 <span class="builtin">substring$</span> <span class="string">". "</span> =
        { #-3 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> <span class="string">"."</span> * }
        { <span class="builtin">duplicate$</span>
          #-1 #2 <span class="builtin">substring$</span> <span class="string">". "</span> =
            { #-3 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> <span class="string">"."</span> * }
            { <span class="builtin">duplicate$</span>
              #-1 #2 <span class="builtin">substring$</span> <span class="string">",'"</span> =
                { #-3 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> <span class="string">".'"</span> * }
                { <span class="builtin">duplicate$</span>
                  #-1 #2 <span class="builtin">substring$</span> <span class="string">".'"</span> =
                    { #-3 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> <span class="string">".'"</span> * }
                    { <span class="builtin">duplicate$</span>
                      #-1 #2 <span class="builtin">substring$</span> <span class="string">".~"</span> =
                        { #-3 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> <span class="string">".~"</span> * }
                        { <span class="builtin">duplicate$</span>
                          #-1 #2 <span class="builtin">substring$</span> <span class="string">",~"</span> =
                          { #-3 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> <span class="string">".~"</span> * }
                          { <span class="builtin">duplicate$</span>
                            <span class="comment">% &#24460;&#12429;&#12363;&#12425;3&#25991;&#23383;&#12392;&#12387;&#12390;&#27604;&#36611;</span>
                            #-1 #3 <span class="builtin">substring$</span> <span class="string">",''"</span> =
                              { #-4 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> <span class="string">".''"</span> * }
                              { <span class="builtin">duplicate$</span>
                                #-1 #3 <span class="builtin">substring$</span> <span class="string">".''"</span> =
                                  { #-4 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> <span class="string">".''"</span> * }
                                  { <span class="builtin">add.period$</span> }
                                <span class="builtin">if$</span>
                              }
                            <span class="builtin">if$</span>
                          }
                        <span class="builtin">if$</span>
                      }
                    <span class="builtin">if$</span>
                  }
                <span class="builtin">if$</span>
              }
            <span class="builtin">if$</span>
          }
        <span class="builtin">if$</span>
      }
     <span class="builtin">if$</span>
   }
  <span class="builtin">if$</span>
}

<span class="comment">%%% "&#12289;" &#12420; "&#65292;" &#12434;&#38500;&#21435;&#12375;&#12289;"&#65294;" &#12434;&#20184;&#12369;&#12427;(&#12395;&#22793;&#12360;&#12427;)&#38306;&#25968; (&#26085;&#26412;&#35486;&#25991;&#29486;&#29992;)</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">add.kanji.period.x</span>}
{
  <span class="builtin">duplicate$</span>
  <span class="comment">% &#24460;&#12429;&#12363;&#12425;1&#25991;&#23383;&#12392;&#12387;&#12390;&#27604;&#36611;</span>
  #-1 #1 <span class="builtin">substring$</span> <span class="string">"&#65292;"</span> =
    { #-2 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> bst.kuten.jp * }
    { <span class="builtin">duplicate$</span>
      <span class="comment">% &#24460;&#12429;&#12363;&#12425;1&#25991;&#23383;&#12392;&#12387;&#12390;&#27604;&#36611;</span>
      #-1 #1 <span class="builtin">substring$</span> <span class="string">"&#12289;"</span> =
        { #-2 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> bst.kuten.jp * }
        { <span class="builtin">duplicate$</span>
          <span class="comment">% &#24460;&#12429;&#12363;&#12425;1&#25991;&#23383;&#12392;&#12387;&#12390;&#27604;&#36611;</span>
          #-1 #1 <span class="builtin">substring$</span> <span class="string">"."</span> =
            {#-2 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> bst.kuten.jp * }
            {#-1 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> bst.kuten.jp * }
          <span class="builtin">if$</span>
        }
     <span class="builtin">if$</span>
   }
  <span class="builtin">if$</span>
}

<span class="comment">%%% &#26368;&#24460;&#12398;&#25991;&#23383;&#12364; period or comma &#12363;&#12393;&#12358;&#12363;&#12434;&#21028;&#23450;&#12290; period or comma &#12398;&#22580;&#21512;&#12395;&#12399;</span>
<span class="comment">%%% last.period.comma &#12395;&#38750;&#12476;&#12525;&#12434;&#20195;&#20837;&#12377;&#12427;&#12290; </span>
<span class="keyword">INTEGERS</span> { comma.period.a.p comma.period.b.p }
<span class="keyword">STRINGS</span> { pc }
<span class="keyword">FUNCTION</span> {<span class="function-name">period.comma.a.p</span>}
{ 'pc <span class="constant">:=</span>
  pc #-1 #1 <span class="builtin">substring$</span> <span class="string">"."</span> = 
  pc #-1 #1 <span class="builtin">substring$</span> <span class="string">","</span> = or
  pc #-1 #2 <span class="builtin">substring$</span> <span class="string">". "</span> = or
  pc #-1 #2 <span class="builtin">substring$</span> <span class="string">", "</span> = or
  pc #-1 #2 <span class="builtin">substring$</span> <span class="string">".'"</span> = or
  pc #-1 #2 <span class="builtin">substring$</span> <span class="string">",'"</span> = or
  pc #-1 #3 <span class="builtin">substring$</span> <span class="string">".''"</span> = or
  pc #-1 #3 <span class="builtin">substring$</span> <span class="string">",''"</span> = or
    { #1 'comma.period.a.p <span class="constant">:=</span> }
    { #0 'comma.period.a.p <span class="constant">:=</span> }
  <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">period.comma.b.p</span>}
{ 'pc <span class="constant">:=</span>
  pc #-1 #3 <span class="builtin">substring$</span> <span class="string">".' "</span> =
  pc #-1 #3 <span class="builtin">substring$</span> <span class="string">",' "</span> = or
  pc #-1 #4 <span class="builtin">substring$</span> <span class="string">".'' "</span> = or
  pc #-1 #4 <span class="builtin">substring$</span> <span class="string">",'' "</span> = or
  pc #-1 #2 <span class="builtin">substring$</span> <span class="string">".~"</span> = or
  pc #-1 #2 <span class="builtin">substring$</span> <span class="string">",~"</span> = or
  pc #-1 #1 <span class="builtin">substring$</span> <span class="string">"&#12290;"</span> = or
  pc #-1 #1 <span class="builtin">substring$</span> <span class="string">"&#65294;"</span> = or
  pc #-1 #1 <span class="builtin">substring$</span> <span class="string">"&#12289;"</span> = or
  pc #-1 #1 <span class="builtin">substring$</span> <span class="string">"&#65292;"</span> = or
    { #1 'comma.period.b.p <span class="constant">:=</span> }
    { #0 'comma.period.b.p <span class="constant">:=</span> }
  <span class="builtin">if$</span>
}

<span class="comment">% &#30452;&#36817;&#12398; field &#12364; period or comma &#12391;&#32066;&#12387;&#12390;&#12356;&#12427;&#12363;&#21028;&#26029;&#12290;&#32066;&#12387;&#12390;&#12356;&#12383;&#12425;</span>
<span class="comment">% last.period.comma &#12395; #1 &#12434;&#20195;&#20837;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">period.comma.p</span>}
{ <span class="builtin">duplicate$</span> 't <span class="constant">:=</span>
  t period.comma.a.p
  t period.comma.b.p
  comma.period.a.p #1 =
  comma.period.b.p #1 = or
    { #1 'last.period.comma <span class="constant">:=</span> }
    { #0 'last.period.comma <span class="constant">:=</span> }
  <span class="builtin">if$</span>
}

<span class="comment">%%% &#25991;&#23383;&#21015;&#12398;&#26368;&#21021;&#12395;&#12388;&#12356;&#12390;&#12356;&#12427; comma or period &#12434;&#38500;&#21435;&#12375;&#12383;&#25991;&#23383;&#21015;&#12434;&#36820;&#12377;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">remove.pre.comma.period</span>}
{ 's <span class="constant">:=</span>
  s <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    <span class="comment">%% ascii character</span>
    { s #1 #1 <span class="builtin">substring$</span> <span class="string">","</span> =
      s #1 #1 <span class="builtin">substring$</span> <span class="string">"."</span> = or
       { s #2 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> }
       <span class="comment">%% multi-byte character</span>
       { s #1 #2 <span class="builtin">substring$</span> <span class="string">"&#65292;"</span> =
         s #1 #2 <span class="builtin">substring$</span> <span class="string">"&#12289;"</span> = or
         s #1 #2 <span class="builtin">substring$</span> <span class="string">"&#12290;"</span> = or
         s #1 #2 <span class="builtin">substring$</span> <span class="string">"&#65294;"</span> = or
          { s #3 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> }
          's
         <span class="builtin">if$</span>
       }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%</span>
<span class="comment">% </span>
<span class="comment">%</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">output.nonnull.nocomma</span>}
{ 's <span class="constant">:=</span>
  output.state mid.sentence =
    <span class="comment">% mid.sentence &#12398;&#12392;&#12365;&#12290; </span>
    { <span class="comment">% &#12388;&#12356;&#12391;&#12395;&#30452;&#36817;&#12398; field &#12364; period or comma &#12391;&#32066;&#12387;&#12390;&#12356;&#12427;&#12363;&#21028;&#26029;&#12290;</span>
      period.comma.p
      <span class="comment">% pop &#12375;&#12390;&#26360;&#12365;&#36796;&#12415;&#12290;</span>
      <span class="builtin">write$</span>
    }
    <span class="comment">% mid.sentence &#12391;&#12399;&#12394;&#12356;&#12392;&#12365;</span>
    { output.state after.block =

        <span class="comment">% after.block &#12398;&#12392;&#12365;&#12290; period &#12434;&#20184;&#21152;&#12375;&#12390; write&#12290;</span>
        { is.kanji.entry
            { add.kanji.period.x <span class="builtin">write$</span>}
            { add.period.x <span class="string">" "</span> * <span class="builtin">write$</span> }
          <span class="builtin">if$</span>
        }
        <span class="comment">% after.block &#12376;&#12419;&#12394;&#12356;&#12392;&#12365;&#12290;</span>
        { output.state before.all =
            <span class="comment">% before.all &#12398;&#12392;&#12365;&#12290;&#12381;&#12398;&#12414;&#12414; write&#12290;</span>
            '<span class="builtin">write$</span>
            <span class="comment">% before.all &#12376;&#12419;&#12394;&#12356;&#12392;&#12365;&#12290; period &#12434;&#20184;&#21152;&#12375;&#12390; write&#12290;</span>
            { is.kanji.entry
                { add.kanji.period.x <span class="builtin">write$</span> }
                { <span class="builtin">add.period$</span> <span class="string">" "</span> * <span class="builtin">write$</span> }
              <span class="builtin">if$</span>
            }
          <span class="builtin">if$</span>
        }
      <span class="builtin">if$</span>
      
      <span class="comment">% mid.sentence &#20197;&#22806;&#12398;&#12392;&#12365;&#12399; mid.sentence &#12395;&#29366;&#24907;&#12434;&#22793;&#26356;&#12290;</span>
      mid.sentence 'output.state <span class="constant">:=</span>
    }
  <span class="builtin">if$</span>
  <span class="comment">% &#30452;&#36817;&#12398; filed &#12364; period or comma &#12391;&#32066;&#12431;&#12387;&#12390;&#12356;&#12427;&#12394;&#12425;&#12289;&#12381;&#12398;&#24460;&#12398; comma &#12399;&#38500;&#21435;&#12377;&#12427;&#12290;</span>
  last.period.comma #0 =
    { s }
    { s remove.pre.comma.period }
  <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">output.nocomma</span>}
{ <span class="builtin">duplicate$</span> <span class="builtin">empty$</span>
    '<span class="builtin">pop$</span>
    'output.nonnull.nocomma
  <span class="builtin">if$</span>
}
<span class="comment">%%% output.nonnull.nocomma &#12395;&#12481;&#12455;&#12483;&#12463;&#27231;&#33021;&#12434;&#20184;&#21152;&#12375;&#12383;&#12418;&#12398;&#12290;&#12456;&#12531;&#12488;&#12522;&#12540;&#12364;&#31354;&#12394;&#12425; </span>
<span class="comment">%%% warning &#12364;&#20986;&#21147;&#12373;&#12428;&#12427;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">output.check.nocomma</span>}
{ 't <span class="constant">:=</span>
  <span class="builtin">duplicate$</span> <span class="builtin">empty$</span>
    { <span class="builtin">pop$</span> <span class="string">"empty "</span> t * <span class="string">" in "</span> * <span class="builtin">cite$</span> * <span class="builtin">warning$</span> }
    'output.nonnull.nocomma
  <span class="builtin">if$</span>
}

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%%% bbl &#12501;&#12449;&#12452;&#12523;&#12408;&#12398;&#20986;&#21147;&#12398;&#24418;&#24335;</span>

<span class="comment">% \harvarditem[Brezis et~al.]{Brezis, Krugman and</span>
<span class="comment">%   Tsiddon}{1993}{brezis93:_leapf_inter_compet}</span>
<span class="comment">% Brezis, Elise~S., Paul~R. Krugman, and Daniel Tsiddon  (1993) ``Leapfrogging in</span>
<span class="comment">%   International Competition: A Theory of Cycles in National Technological</span>
<span class="comment">%   Leadership.'', {\em American Economic Review.}, Vol.~83. No.~5. pp.</span>
<span class="comment">%   1211--1219.</span>

<span class="comment">% \harvarditem[abbreviated citation]{full citation}{year}{keyword} ...</span>
<span class="comment">%</span>
<span class="comment">% &#12392;&#12356;&#12358;&#24418;&#24335;&#12391;&#20986;&#21147;&#12377;&#12427;&#12290;</span>

<span class="comment">%%% period &#12434;&#20184;&#12369;&#12390;&#12289;&#25913;&#34892;&#12377;&#12427;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">fin.entry</span>}
{ is.kanji.entry
    { add.kanji.period.x }
    { add.period.x }
  <span class="builtin">if$</span>
  <span class="builtin">write$</span>
  <span class="builtin">newline$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">new.block</span>}
{ output.state before.all =
    '<span class="builtin">skip$</span>
    { after.block 'output.state <span class="constant">:=</span> }
  <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">new.sentence</span>}
{ output.state after.block =
    '<span class="builtin">skip$</span>
    { output.state before.all =
        '<span class="builtin">skip$</span>
        { after.sentence 'output.state <span class="constant">:=</span> }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">new.block.check</span>}
{ <span class="builtin">empty$</span>
    '<span class="builtin">skip$</span>
    'new.block
  <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">field.or.null</span>}
{ <span class="builtin">duplicate$</span> <span class="builtin">empty$</span>
    { <span class="builtin">pop$</span> <span class="string">""</span> }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
}

<span class="keyword">INTEGERS</span> {l1 l2 f1 f2 kan.p}
<span class="keyword">STRINGS</span> {kan.fn kan.ln zzz zz}
<span class="keyword">FUNCTION</span> {<span class="function-name">check.kanji.str.sub</span>}
{ 'zzz <span class="constant">:=</span>
  zzz #1 <span class="string">"{ll}"</span> <span class="builtin">format.name$</span> 'kan.ln <span class="constant">:=</span>         <span class="comment">% kan.ln        &lt;- 1st author &#12398; Last name</span>
  zzz #1 <span class="string">"{ff}"</span> <span class="builtin">format.name$</span> 'kan.fn <span class="constant">:=</span>         <span class="comment">% kan.fn        &lt;- 1st author &#12398; first name</span>
  kan.ln #1 #1 <span class="builtin">substring$</span> <span class="builtin">is.kanji.str$</span> 'l1 <span class="constant">:=</span>  <span class="comment">% l1            &lt;- Last name &#12398;1&#25991;&#23383;&#30446;</span>
  kan.fn #1 #1 <span class="builtin">substring$</span> <span class="builtin">is.kanji.str$</span> 'f1 <span class="constant">:=</span>  <span class="comment">% f1            &lt;- First name &#12398;1&#25991;&#23383;&#30446;</span>
  kan.ln #-1 #1 <span class="builtin">substring$</span> <span class="builtin">is.kanji.str$</span> 'l2 <span class="constant">:=</span> <span class="comment">% l2            &lt;- Last name &#12398;&#26368;&#24460;&#12398;1&#25991;&#23383;&#30446;</span>
  kan.fn #-1 #1 <span class="builtin">substring$</span> <span class="builtin">is.kanji.str$</span> 'f2 <span class="constant">:=</span> <span class="comment">% f2            &lt;- First name &#12398;&#26368;&#24460;&#12398;1&#25991;&#23383;&#30446;</span>

  is.kanji.entry #0 =
     <span class="comment">% &#12381;&#12418;&#12381;&#12418; is.kanji.entry &#12364; 0 &#12394;&#12425; 0 &#12434;&#36820;&#12377;&#12290;</span>
     { #0 'kan.p <span class="constant">:=</span> }
     { l1 #0 = f1 #0 = and l2 #0 = and f2 #0 = and
        <span class="comment">% &#26368;&#21021;&#12398;1&#25991;&#23383;&#30446;&#12289;&#26368;&#24460;&#12398;1&#25991;&#23383;&#30446;&#12364;&#12393;&#12428;&#12418;&#12450;&#12473;&#12461;&#12540;&#12394;&#12425; 0 </span>
        { #0 'kan.p <span class="constant">:=</span> }
        { l1 #0 = l2 #0 = and
          f1 #0 = f2 #0 = or and
            <span class="comment">% </span>
            { #0 'kan.p <span class="constant">:=</span> }
            { #1 'kan.p <span class="constant">:=</span> }
          <span class="builtin">if$</span>
        }
      <span class="builtin">if$</span>
     }
  <span class="builtin">if$</span>
  kan.p
}

<span class="keyword">FUNCTION</span> {<span class="function-name">check.kanji.str</span>}
{ 'zzz <span class="constant">:=</span>
  zzz <span class="builtin">empty$</span>
    { #1 }
    { bst.use.unicode #0 =
       { zzz <span class="builtin">is.kanji.str$</span> }
       { zzz check.kanji.str.sub }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% booktitle &#12398;&#25972;&#24418;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.btitle</span>}
{ <span class="variable-name">booktitle</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { is.kanji.entry
        { bst.btitle.pre.jp <span class="variable-name">booktitle</span> * bst.btitle.post.jp * }
        { bst.btitle.pre <span class="variable-name">booktitle</span> * bst.btitle.post * }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% journal &#12398;&#25972;&#24418;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.journal</span>}
{ <span class="variable-name">journal</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { is.kanji.entry
        { bst.journal.pre.jp <span class="variable-name">journal</span> * bst.journal.post.jp * }
        { bst.journal.pre <span class="variable-name">journal</span> * bst.journal.post * }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% book &#12398; title &#12398;&#25972;&#24418;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.book</span>}
{ <span class="variable-name">title</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { is.kanji.entry
        { bst.book.pre.jp <span class="variable-name">title</span> * bst.book.post.jp * }
        { bst.book.pre <span class="variable-name">title</span> * bst.book.post * }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% &#20197;&#19979;&#12289;author, editor &#12398;&#20966;&#29702;</span>

<span class="comment">% &#26085;&#26412;&#35486; author &#21517;&#12398;&#12392;&#12365;&#12395; alphabet &#12364;&#21547;&#12414;&#12428;&#12390;&#12356;&#12427;&#12363;&#12393;&#12358;&#12363;&#21028;&#26029;&#12377;&#12427;&#38306;&#25968;&#12290;&#21547;&#12414;&#12428;</span>
<span class="comment">% &#12390;&#12356;&#12427;&#12394;&#12425; alphabet.in.author &#12395; 1 &#12434;&#20195;&#20837;&#12289;&#21547;&#12414;&#12428;&#12390;&#12356;&#12394;&#12356;&#12394;&#12425; 0 &#12434;&#20195;&#20837;&#12290;&#12371;&#12428;</span>
<span class="comment">% &#12399; Alphabet + &#29255;&#20206;&#21517;&#12398;&#22806;&#22269;&#20154;&#21517;&#12434;&#20966;&#29702;&#12377;&#12427;&#12383;&#12417;&#12398;&#12418;&#12398;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">set.alphabet.in.author</span>}
{ name.num <span class="string">"{ff}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span>
  #0 'alphabet.in.author <span class="constant">:=</span>
  <span class="string">""</span> t =
    <span class="comment">% first name &#12364;&#12394;&#12356;&#12392;&#12365;&#12399; 0&#12290;</span>
    { #0 'alphabet.in.author <span class="constant">:=</span> }
    { 
      <span class="comment">% &#35352;&#21495;&#38500;&#21435;</span>
      t <span class="builtin">purify$</span> 't <span class="constant">:=</span>
      <span class="comment">% &#19968;&#25991;&#23383;&#30446;&#12384;&#12369;&#21462;&#12426;&#20986;&#12377;&#12290;</span>
      t #1 <span class="builtin">text.prefix$</span> 't <span class="constant">:=</span>
      <span class="comment">% &#26085;&#26412;&#35486;&#12363; alphabet &#12363;&#65311;</span>
      t <span class="builtin">is.kanji.str$</span>
        { #0 'alphabet.in.author <span class="constant">:=</span>
        }
        { #1 'alphabet.in.author <span class="constant">:=</span>
        }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% &#25991;&#23383;&#12398;&#25968;&#12434;&#21028;&#26029;&#12377;&#12427;&#38306;&#25968; (&#26085;&#26412;&#35486;&#29992;)&#12290;</span>
<span class="comment">% &#26085;&#26412;&#35486;&#12398;&#22580;&#21512; 1 &#25991;&#23383;&#12364; 2 &#25991;&#23383;&#12392;&#21028;&#26029;&#12373;&#12428;&#12427;&#12371;&#12392;&#12395;&#27880;&#24847;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">count.number.of.letters</span>}
{ 'sss <span class="constant">:=</span>
   sss <span class="builtin">text.length$</span> #2 =
      <span class="comment">% &#19968;&#25991;&#23383;&#12398;&#12465;&#12540;&#12473;&#12391;&#12399; "1" &#12434;&#36820;&#12377;&#12290;</span>
      { <span class="string">"1"</span> }
      <span class="comment">% &#19968;&#25991;&#23383;&#20197;&#22806;&#12398;&#12465;&#12540;&#12473;&#12391;&#12399; "0" &#12434;&#36820;&#12377;&#12290;</span>
      { <span class="string">"0"</span> }
   <span class="builtin">if$</span>
}

<span class="comment">%%% name &#12434;&#20966;&#29702;&#12377;&#12427;&#38306;&#25968;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.names</span>}
{ 's <span class="constant">:=</span>
  <span class="comment">% nameptr &#12395; 1 &#12434;&#20195;&#20837;</span>
  #1 'nameptr <span class="constant">:=</span>
  <span class="comment">% numnames &#12395; author (editor) &#12398;&#25968;&#12434;&#20195;&#20837;</span>
  s <span class="builtin">num.names$</span> 'numnames <span class="constant">:=</span>
  numnames 'namesleft <span class="constant">:=</span>
  <span class="comment">% namesleft &#12364; 0 &#12424;&#12426;&#22823;&#12394;&#12425;&#32368;&#12426;&#36820;&#12375; (while)</span>
  { namesleft #0 &gt; }
    <span class="comment">% s &#12395;&#26085;&#26412;&#35486;&#21547;&#12416;&#12363;&#65311;</span>
    { s check.kanji.str
        <span class="comment">% &#26085;&#26412;&#35486;&#21547;&#12416;&#12465;&#12540;&#12473;&#12398;&#20966;&#29702;</span>
        { nameptr 'name.num <span class="constant">:=</span>
          s set.alphabet.in.author
          alphabet.in.author #0 =
            <span class="comment">% first name&#12364;&#26085;&#26412;&#35486;&#12398;&#12465;&#12540;&#12473;&#65288;&#26085;&#26412;&#20154;&#21517;&#12392;&#12356;&#12358;&#12371;&#12392;&#65289;</span>

            <span class="comment">% &#27880;&#65306;&#26085;&#26412;&#35486;&#12398; author &#12399; "&#22995; &#21517;" &#12398;&#38918;&#12391;&#25351;&#23450;&#12373;&#12428;&#12427;&#12364;&#12289;bst &#12391;&#12399;</span>
            <span class="comment">% &#38918;&#30058;&#36890;&#12426;&#12395;&#22995;&#65309;first name&#12289;&#21517;&#65309;last name &#12392;&#12375;&#12390;&#25201;&#12431;&#12428;&#12427;&#12290;</span>
            { bst.sei.mei.order #0 =
                { s nameptr <span class="string">"{ff}"</span> <span class="builtin">format.name$</span> 'ss <span class="constant">:=</span>
                  s nameptr <span class="string">"{ll}"</span> <span class="builtin">format.name$</span> 'tt <span class="constant">:=</span> }
                <span class="comment">% &#26222;&#36890;&#12392;&#36870;&#38918;&#12398;&#12465;&#12540;&#12473;</span>
                { s nameptr <span class="string">"{ll}"</span> <span class="builtin">format.name$</span> 'ss <span class="constant">:=</span>
                  s nameptr <span class="string">"{ff}"</span> <span class="builtin">format.name$</span> 'tt <span class="constant">:=</span> }
              <span class="builtin">if$</span>
              ss <span class="string">""</span> =
                <span class="comment">%% &#22995;&#12398;&#12415;&#12398;&#12465;&#12540;&#12473;&#12399;&#12381;&#12398;&#12414;&#12414;</span>
                { tt 't <span class="constant">:=</span> }
                <span class="comment">%% &#22995;&#12539;&#21517;&#12392;&#12418;&#12395;&#12354;&#12427;&#12465;&#12540;&#12473;</span>
                { ss count.number.of.letters <span class="string">"1"</span> =
                  tt count.number.of.letters <span class="string">"1"</span> = or
                    { ss bst.sei.mei.one.jp * tt * 't <span class="constant">:=</span> }
                    { ss bst.sei.mei.two.jp * tt * 't <span class="constant">:=</span> }
                  <span class="builtin">if$</span>
                }
              <span class="builtin">if$</span>
            }
            <span class="comment">% first name &#12364; alphabet &#12398;&#12465;&#12540;&#12473; (&#12388;&#12414;&#12426;&#12289;&#12459;&#12479;&#12459;&#12490;&#12398;&#22806;&#22269;&#20154;&#21517;)</span>
            { nameptr #1 =
               <span class="comment">% first author &#12398;&#12465;&#12540;&#12473; (last name - first name &#12398; order)</span>
               { bst.author.name #0 =
                 bst.author.name #1 = or
                   <span class="comment">% Last name - first name</span>
                   { s nameptr <span class="string">"{ll}"</span> <span class="builtin">format.name$</span> 'ss <span class="constant">:=</span>
                     s nameptr <span class="string">"{ff}"</span> <span class="builtin">format.name$</span> 'tt <span class="constant">:=</span>
                     ss bst.touten.jp * tt * 't <span class="constant">:=</span> }
                   <span class="comment">% First name - Last name</span>
                   { s nameptr <span class="string">"{ff~}{ll}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                 <span class="builtin">if$</span>
               }
               <span class="comment">% first author &#20197;&#22806;&#12398;&#12465;&#12540;&#12473; (first name - last name &#12398; order)</span>
               { bst.author.name #0 =
                 bst.author.name #2 = or
                   <span class="comment">% First name - Last name</span>
                   { s nameptr <span class="string">"{ff~}{ll}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                   <span class="comment">% Last name - First name</span>
                   { s nameptr <span class="string">"{ll}"</span> <span class="builtin">format.name$</span> 'ss <span class="constant">:=</span>
                     s nameptr <span class="string">"{ff}"</span> <span class="builtin">format.name$</span> 'tt <span class="constant">:=</span>
                     ss bst.touten.jp * tt * 't <span class="constant">:=</span> }
                 <span class="builtin">if$</span>
               }
              <span class="builtin">if$</span>
            }
          <span class="builtin">if$</span>
        }
        <span class="comment">% author &#12395;&#26085;&#26412;&#35486;&#21547;&#12414;&#12394;&#12356;&#12465;&#12540;&#12473;&#12398;&#20966;&#29702;</span>
        { nameptr #1 =
           <span class="comment">% &#19968;&#30058;&#30446;&#12398; author</span>
           { bst.author.name #0 =
             bst.author.name #1 =
             or
                { bst.first.name.initial #0 = 
                   { s nameptr <span class="string">"{vv~}{ll}{, ff}{, jj}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                   { s nameptr <span class="string">"{vv~}{ll}{, f.}{, jj}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                  <span class="builtin">if$</span>
                }
                { bst.first.name.initial #0 = 
                   { s nameptr <span class="string">"{ff~}{vv~}{ll}{, jj}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                   { s nameptr <span class="string">"{f.~}{vv~}{ll}{, jj}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                  <span class="builtin">if$</span>
                }
             <span class="builtin">if$</span>
           }
           <span class="comment">% &#20108;&#30058;&#30446;&#20197;&#38477;&#12398; author</span>
           { bst.author.name #0 =
             bst.author.name #2 =
             or
                { bst.first.name.initial #0 = 
                   { s nameptr <span class="string">"{ff~}{vv~}{ll}{, jj}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                   { s nameptr <span class="string">"{f.~}{vv~}{ll}{, jj}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                 <span class="builtin">if$</span>
                }
                { bst.first.name.initial #0 = 
                   { s nameptr <span class="string">"{vv~}{ll}{, ff}{, jj}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                   { s nameptr <span class="string">"{vv~}{ll}{, f.}{, jj}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                 <span class="builtin">if$</span>
                }
             <span class="builtin">if$</span>
           }
          <span class="builtin">if$</span>
        }
      <span class="builtin">if$</span>
      nameptr #1 &gt;
        <span class="comment">% &#20108;&#30058;&#30446;&#20197;&#38477;&#12398; author &#12398;&#12465;&#12540;&#12473;&#12391;&#12398;&#20966;&#29702;</span>
        { namesleft #1 &gt;
            { s check.kanji.str
                { bst.and.jp  * t * }
                { <span class="string">", "</span> * t * }
              <span class="builtin">if$</span>
            }
            { t <span class="string">"others"</span> =
                { s check.kanji.str
                    { bst.and.others.jp * }
                    { bst.and.others * }
                  <span class="builtin">if$</span>
                }
                { s check.kanji.str
                    { bst.and.jp * t * }
                    { numnames #2 =
                        { bst.and * t * }
                        { bst.ands * t * }
                      <span class="builtin">if$</span>
                    }
                   <span class="builtin">if$</span>
                }
              <span class="builtin">if$</span>
            }
          <span class="builtin">if$</span>
        }
        't
      <span class="builtin">if$</span>
      nameptr #1 <span class="constant">+</span> 'nameptr <span class="constant">:=</span>
      namesleft #1 - 'namesleft <span class="constant">:=</span>
    }
  <span class="builtin">while$</span>
}

<span class="comment">%%% name &#12434;&#20966;&#29702;&#12377;&#12427;&#38306;&#25968;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.names.alt</span>}
{ 'sss <span class="constant">:=</span>  <span class="comment">% &#30465;&#30053;&#12373;&#12428;&#12390;&#12356;&#12394;&#12356;&#21517;&#21069;</span>
  's <span class="constant">:=</span>  <span class="comment">% &#30465;&#30053;&#12373;&#12428;&#12383;&#21517;&#21069;</span>
<span class="comment">%   "abbreviated (s) = \texttt{" s * "}\\" * write$ </span>
<span class="comment">%   "full (sss) = \texttt{" sss * "}\\" * write$ </span>
  jecon.debug #0 = not <span class="comment">% for debug</span>
     { <span class="string">"abbreviated (s) = \texttt{"</span> s * <span class="string">"}\\"</span> * <span class="builtin">write$</span> 
       <span class="string">"full (sss) = \texttt{"</span> sss * <span class="string">"}\\"</span> * <span class="builtin">write$</span> }
     '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
  <span class="comment">% nameptr &#12395; 1 &#12434;&#20195;&#20837;</span>
  #1 'nameptr <span class="constant">:=</span>
  <span class="comment">% numnames &#12395; author (editor) &#12398;&#25968;&#12434;&#20195;&#20837;</span>
  s <span class="builtin">num.names$</span> 'numnames <span class="constant">:=</span>
  numnames 'namesleft <span class="constant">:=</span>
  <span class="comment">% namesleft &#12364; 0 &#12424;&#12426;&#22823;&#12394;&#12425;&#32368;&#12426;&#36820;&#12375; (while)</span>
  { namesleft #0 &gt; }
    <span class="comment">% s &#12395;&#26085;&#26412;&#35486;&#21547;&#12416;&#12363;&#65311;</span>
    { sss check.kanji.str
        <span class="comment">% &#26085;&#26412;&#35486;&#21547;&#12416;&#12465;&#12540;&#12473;&#12398;&#20966;&#29702;</span>
        { nameptr 'name.num <span class="constant">:=</span>
          s set.alphabet.in.author
          alphabet.in.author #0 =
            <span class="comment">% first name&#12364;&#26085;&#26412;&#35486;&#12398;&#12465;&#12540;&#12473;&#65288;&#26085;&#26412;&#20154;&#21517;&#12392;&#12356;&#12358;&#12371;&#12392;&#65289;</span>

            <span class="comment">% &#27880;&#65306;&#26085;&#26412;&#35486;&#12398; author &#12399; "&#22995; &#21517;" &#12398;&#38918;&#12391;&#25351;&#23450;&#12373;&#12428;&#12427;&#12364;&#12289;bst &#12391;&#12399;</span>
            <span class="comment">% &#38918;&#30058;&#36890;&#12426;&#12395;&#22995;&#65309;first name&#12289;&#21517;&#65309;last name &#12392;&#12375;&#12390;&#25201;&#12431;&#12428;&#12427;&#12290;</span>
            { bst.sei.mei.order #0 =
                { s nameptr <span class="string">"{ff}"</span> <span class="builtin">format.name$</span> 'ss <span class="constant">:=</span>
                  s nameptr <span class="string">"{ll}"</span> <span class="builtin">format.name$</span> 'tt <span class="constant">:=</span> }
                <span class="comment">% &#26222;&#36890;&#12392;&#36870;&#38918;&#12398;&#12465;&#12540;&#12473;</span>
                { s nameptr <span class="string">"{ll}"</span> <span class="builtin">format.name$</span> 'ss <span class="constant">:=</span>
                  s nameptr <span class="string">"{ff}"</span> <span class="builtin">format.name$</span> 'tt <span class="constant">:=</span> }
              <span class="builtin">if$</span>
              ss <span class="string">""</span> =
                <span class="comment">%% &#22995;&#12398;&#12415;&#12398;&#12465;&#12540;&#12473;&#12399;&#12381;&#12398;&#12414;&#12414;</span>
                { tt 't <span class="constant">:=</span> }
                <span class="comment">%% &#22995;&#12539;&#21517;&#12392;&#12418;&#12395;&#12354;&#12427;&#12465;&#12540;&#12473;</span>
                { ss count.number.of.letters <span class="string">"1"</span> =
                  tt count.number.of.letters <span class="string">"1"</span> = or
                    { ss bst.sei.mei.one.jp * tt * 't <span class="constant">:=</span> }
                    { ss bst.sei.mei.two.jp * tt * 't <span class="constant">:=</span> }
                  <span class="builtin">if$</span>
                }
              <span class="builtin">if$</span>
            }
            <span class="comment">% first name &#12364; alphabet &#12398;&#12465;&#12540;&#12473; (&#12388;&#12414;&#12426;&#12289;&#12459;&#12479;&#12459;&#12490;&#12398;&#22806;&#22269;&#20154;&#21517;)</span>
            { nameptr #1 =
               <span class="comment">% first author &#12398;&#12465;&#12540;&#12473; (last name - first name &#12398; order)</span>
               { bst.author.name #0 =
                 bst.author.name #1 = or
                   <span class="comment">% Last name - first name</span>
                   { s nameptr <span class="string">"{ll}"</span> <span class="builtin">format.name$</span> 'ss <span class="constant">:=</span>
                     s nameptr <span class="string">"{ff}"</span> <span class="builtin">format.name$</span> 'tt <span class="constant">:=</span>
                     ss bst.touten.jp * tt * 't <span class="constant">:=</span> }
                   <span class="comment">% First name - Last name</span>
                   { s nameptr <span class="string">"{ff~}{ll}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                 <span class="builtin">if$</span>
               }
               <span class="comment">% first author &#20197;&#22806;&#12398;&#12465;&#12540;&#12473; (first name - last name &#12398; order)</span>
               { bst.author.name #0 =
                 bst.author.name #2 = or
                   <span class="comment">% First name - Last name</span>
                   { s nameptr <span class="string">"{ff~}{ll}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                   <span class="comment">% Last name - First name</span>
                   { s nameptr <span class="string">"{ll}"</span> <span class="builtin">format.name$</span> 'ss <span class="constant">:=</span>
                     s nameptr <span class="string">"{ff}"</span> <span class="builtin">format.name$</span> 'tt <span class="constant">:=</span>
                     ss bst.touten.jp * tt * 't <span class="constant">:=</span> }
                 <span class="builtin">if$</span>
               }
              <span class="builtin">if$</span>
            }
          <span class="builtin">if$</span>
        }
        <span class="comment">% author &#12395;&#26085;&#26412;&#35486;&#21547;&#12414;&#12394;&#12356;&#12465;&#12540;&#12473;&#12398;&#20966;&#29702;</span>
        { nameptr #1 =
           <span class="comment">% &#19968;&#30058;&#30446;&#12398; author</span>
           { bst.author.name #0 =
             bst.author.name #1 =
             or
                { bst.first.name.initial #0 = 
                   { s nameptr <span class="string">"{vv~}{ll}{, ff}{, jj}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                   { s nameptr <span class="string">"{vv~}{ll}{, f.}{, jj}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                  <span class="builtin">if$</span>
                }
                { bst.first.name.initial #0 = 
                   { s nameptr <span class="string">"{ff~}{vv~}{ll}{, jj}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                   { s nameptr <span class="string">"{f.~}{vv~}{ll}{, jj}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                  <span class="builtin">if$</span>
                }
             <span class="builtin">if$</span>
           }
           <span class="comment">% &#20108;&#30058;&#30446;&#20197;&#38477;&#12398; author</span>
           { bst.author.name #0 =
             bst.author.name #2 =
             or
                { bst.first.name.initial #0 = 
                   { s nameptr <span class="string">"{ff~}{vv~}{ll}{, jj}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                   { s nameptr <span class="string">"{f.~}{vv~}{ll}{, jj}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                 <span class="builtin">if$</span>
                }
                { bst.first.name.initial #0 = 
                   { s nameptr <span class="string">"{vv~}{ll}{, ff}{, jj}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                   { s nameptr <span class="string">"{vv~}{ll}{, f.}{, jj}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                 <span class="builtin">if$</span>
                }
             <span class="builtin">if$</span>
           }
          <span class="builtin">if$</span>
        }
      <span class="builtin">if$</span>
      nameptr #1 &gt;
        <span class="comment">% &#20108;&#30058;&#30446;&#20197;&#38477;&#12398; author &#12398;&#12465;&#12540;&#12473;&#12391;&#12398;&#20966;&#29702;</span>
        { namesleft #1 &gt;
            { sss check.kanji.str
                { bst.and.jp  * t * }
                { <span class="string">", "</span> * t * }
              <span class="builtin">if$</span>
            }
            { t <span class="string">"others"</span> =
                { s check.kanji.str
                    { bst.and.others.jp * }
                    { bst.and.others * }
                  <span class="builtin">if$</span>
                }
                { sss check.kanji.str
                    { bst.and.jp * t * }
                    { numnames #2 =
                        { bst.and * t * }
                        { bst.ands * t * }
                      <span class="builtin">if$</span>
                    }
                   <span class="builtin">if$</span>
                }
              <span class="builtin">if$</span>
            }
          <span class="builtin">if$</span>
        }
        't
      <span class="builtin">if$</span>
      nameptr #1 <span class="constant">+</span> 'nameptr <span class="constant">:=</span>
      namesleft #1 - 'namesleft <span class="constant">:=</span>
    }
  <span class="builtin">while$</span>
}

<span class="comment">% remove successive periods (commas) from author</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">remove.ss.period.auth</span>}
{ 's <span class="constant">:=</span> <span class="comment">% &#12371;&#12385;&#12425;&#12399; bysame &#12391;&#30465;&#30053;&#12373;&#12428;&#12383;&#21517;&#21069;</span>
  'tempc <span class="constant">:=</span>  <span class="comment">% &#12371;&#12385;&#12425;&#12399;&#20803;&#12398; author (or editor) &#21517;</span>
  s tempc format.names.alt 'tempa <span class="constant">:=</span>
  <span class="comment">% For debug</span>
  jecon.debug #0 = not <span class="comment">% for debug</span>
     { <span class="string">"tempa = \texttt{"</span> tempa * <span class="string">"}\\"</span> * <span class="builtin">write$</span> }
     '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>

  tempc check.kanji.str
    { bst.author.pre.jp tempa * 'tempa <span class="constant">:=</span> }
    { bst.author.pre tempa * 'tempa <span class="constant">:=</span> }
  <span class="builtin">if$</span>

  tempc check.kanji.str
    { bst.author.post.jp 'tempb <span class="constant">:=</span> }
    { bst.author.post 'tempb <span class="constant">:=</span> }
  <span class="builtin">if$</span>

  tempb #1 #1 <span class="builtin">substring$</span> <span class="string">"}"</span> =
    <span class="comment">% bst.author.post(.jp) &#12398;1&#25991;&#23383;&#30446;&#12364;"}"&#12394;&#12425;&#12289;&#20309;&#12418;&#12375;&#12394;&#12356;&#12290;</span>
    { tempa tempb * }
    <span class="comment">% &#12381;&#12358;&#12376;&#12419;&#12394;&#12356;&#12394;&#12425;&#12289;tempa &#12398;&#26368;&#24460;&#12398;&#19968;&#25991;&#23383;&#12392; tempb &#12398;&#26368;&#21021;&#12398;&#19968;&#25991;&#23383;&#12434;&#27604;&#36611;</span>
    { tempa #-1 #1 <span class="builtin">substring$</span> tempb #1 #1 <span class="builtin">substring$</span> =
        <span class="comment">% &#31561;&#12375;&#12369;&#12428;&#12400;&#12300;tempa + tempb &#12398;&#26368;&#21021;&#12398;&#19968;&#25991;&#23383;&#12434;&#38500;&#12356;&#12383;&#25991;&#23383;&#21015;&#12301;</span>
        { tempa tempb #2 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> * }
        <span class="comment">% &#31561;&#12375;&#12367;&#12394;&#12428;&#12400;&#12300;tempa + tempb&#12301;</span>
        { tempa tempb * }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">insert.bysame</span>}
{ 'zz <span class="constant">:=</span> 
  bst.use.unicode #0 = 
    { is.kanji.entry.author
       { <span class="string">" \bysamejp{} "</span> }
       { <span class="string">" \bysame{} "</span> }
      <span class="builtin">if$</span>
    }
    { zz check.kanji.str.sub
       { <span class="string">" \bysamejp{} "</span> }
       { <span class="string">" \bysame{} "</span> }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">% &lt;prev name list&gt; &lt;new name list&gt; compare.names -&gt; &lt;modified name list&gt;</span>
<span class="comment">% &#12371;&#12398;&#38306;&#25968;&#12399; bst.use.bysame &#12364; 2 &#12398;&#12392;&#12365;&#12398;&#12415;&#21033;&#29992;&#12377;&#12427;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">compare.names.jecon</span>}
<span class="comment">% &lt;&#19968;&#20491;&#21069;&#12398; author&gt; &lt;&#29694;&#22312;&#12398; author&gt; &#12434;&#24341;&#25968;&#12395;&#12392;&#12427;&#12290;</span>
{ 's <span class="constant">:=</span>
  'tempa <span class="constant">:=</span>

<span class="comment">%   "author = " author * "\\" * write$ newline$ % For debug</span>
<span class="comment">%   "current author = " s * "\\" * write$ newline$ % For debug</span>
<span class="comment">%   "prev.author = " tempa * "\\" * write$ newline$ % For dedug</span>

  tempa <span class="builtin">num.names$</span> 'len1.jecon <span class="constant">:=</span>  <span class="comment">% len1 = the number of previous authors</span>
  s <span class="builtin">num.names$</span> 'len2.jecon <span class="constant">:=</span>      <span class="comment">% len2 = the number of current authors</span>

<span class="comment">% len1.jecon := min(len1.jecon,len2.jecon)</span>
<span class="comment">% len1 -&gt; min{the number of previous authors, the number of current authors}</span>
  len1.jecon len2.jecon &gt;
    { len2.jecon 'len1.jecon <span class="constant">:=</span> }
    { }
  <span class="builtin">if$</span>

<span class="comment">% start with an empty string, then while the components are the same</span>
<span class="comment">% add "bysame"</span>
  <span class="string">""</span>
  #1 'i.jecon <span class="constant">:=</span>
  <span class="comment">% i.jecon &gt; len1.jeon &#12391;&#12394;&#12356;&#12394;&#12425;&#32368;&#12426;&#36820;&#12375;</span>
  { i.jecon len1.jecon &gt; not }
    <span class="comment">% current author &#12392; previous author &#12364;&#31561;&#12375;&#12356;&#12363;&#65311;</span>
    { tempa i.jecon <span class="string">"{ff }{vv }{ll}{ jj}"</span> <span class="builtin">format.name$</span>
      s     i.jecon <span class="string">"{ff }{vv }{ll}{ jj}"</span> <span class="builtin">format.name$</span> =
        <span class="comment">% &#31561;&#12375;&#12356;&#12392;&#12365;</span>
        { #1 i.jecon &lt;
            { <span class="string">" and "</span> * }       <span class="comment">% bysame &#12391;&#30465;&#30053;&#12377;&#12427;&#33879;&#32773;&#12398;&#21069;&#12395;&#12388;&#12367; and </span>
            { }
          <span class="builtin">if$</span>
          s insert.bysame *
          i.jecon #1 <span class="constant">+</span> 'i.jecon <span class="constant">:=</span> }
        <span class="comment">% &#31561;&#12375;&#12367;&#12394;&#12356;&#12392;&#12365;&#12399; len1.jecon &#12395;&#12510;&#12452;&#12490;&#12473;1&#12434;&#20195;&#20837; &#8594; loop &#12434;&#25244;&#12369;&#12427;&#12290;</span>
        { #-1 'len1.jecon <span class="constant">:=</span> }
      <span class="builtin">if$</span>
    }
  <span class="builtin">while$</span>

  jecon.debug #0 = not <span class="comment">% for debug</span>
     { <span class="string">"i.jecon = "</span> i.jecon <span class="builtin">int.to.str$</span> * <span class="string">"\\"</span> * <span class="builtin">write$</span> }
     '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
  <span class="comment">% i.jecon &#12395;&#12399;&#12300;prev.author &#12392;&#31561;&#12375;&#12356; author &#12398;&#25968; + 1&#12301;&#12364;&#20837;&#12387;&#12390;&#12356;&#12427;&#12290;</span>

<span class="comment">% add the rest of the second string</span>
  { i.jecon len2.jecon &gt; not }
    { #1 i.jecon &lt;
        <span class="comment">% prev.author &#12392;&#21516;&#12376; author &#12364;&#19968;&#20154;&#20197;&#19978;&#12356;&#12427;&#12392;&#12365;</span>
        { <span class="string">" and "</span> * }
        { }
      <span class="builtin">if$</span>
      s i.jecon <span class="string">"{ff }{vv }{ll}{ jj}"</span> <span class="builtin">format.name$</span> *
      i.jecon #1 <span class="constant">+</span> 'i.jecon <span class="constant">:=</span>
    }
  <span class="builtin">while$</span>
}

<span class="comment">%%% author &#12398;&#25972;&#24418;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.authors</span>}
{ <span class="variable-name">author</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { bst.use.bysame #2 =
        <span class="comment">% 2 &#12398;&#12479;&#12452;&#12503;&#12398; bysame &#12434;&#21033;&#29992;&#12377;&#12427;&#12392;&#12365;&#12290;</span>
        { prev.author.jecon <span class="variable-name">author</span> compare.names.jecon 's <span class="constant">:=</span>

          jecon.debug #0 = not <span class="comment">% for debug</span>
            { <span class="string">"prev.author.jecon = \texttt{"</span> prev.author.jecon * <span class="string">"}\\"</span> * <span class="builtin">write$</span>
              <span class="string">"\noindent s = \texttt{"</span> s * <span class="string">"}\\"</span> * <span class="builtin">write$</span>
            }
            '<span class="builtin">skip$</span>
          <span class="builtin">if$</span>

          <span class="comment">% prev.author.jecon &#12395;&#29694;&#22312;&#12398; author &#12434;&#20195;&#20837;&#12375;&#12390;&#12362;&#12367;</span>
          <span class="variable-name">author</span> 'prev.author.jecon <span class="constant">:=</span>
        }
        <span class="comment">% bysame &#12434;&#21033;&#29992;&#12375;&#12394;&#12356;&#12363;&#12289;1 &#12398;&#12479;&#12452;&#12503;&#12398; bysame &#12434;&#21033;&#29992;&#12377;&#12427;&#12392;&#12365;&#12399; author &#12434;</span>
        <span class="comment">% s &#12395;&#20195;&#20837;&#12290;</span>
        { <span class="variable-name">author</span> 's <span class="constant">:=</span> }
      <span class="builtin">if$</span>
      <span class="comment">% extra.label.bysame &#12395; bysame &#12392;&#12356;&#12358;&#20516;&#12364;&#20837;&#12387;&#12390;&#12356;&#12427;&#12363;&#65311;</span>
      extra.label.bysame <span class="string">"bysame"</span> =
        <span class="comment">% Yes &#12394;&#12425; bysame &#12434;&#25407;&#20837;&#12290;</span>
        { <span class="variable-name">author</span> insert.bysame }
        <span class="comment">% No &#12394;&#12425; ? &#12434;&#36820;&#12377;&#12290;</span>
        { <span class="variable-name">author</span> s remove.ss.period.auth }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% editor &#12398;&#25972;&#24418;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.editors</span>}
{ <span class="variable-name">editor</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { bst.use.bysame #2 =
        { prev.author.jecon <span class="variable-name">editor</span> compare.names.jecon 's <span class="constant">:=</span>
          jecon.debug #0 = not
            { <span class="string">"prev.author.jecon = \texttt{"</span> prev.author.jecon * <span class="string">"}\\"</span> * <span class="builtin">write$</span> <span class="comment">% for debug</span>
              <span class="string">"\noindent s = \texttt{"</span> s * <span class="string">"}\\"</span> * <span class="builtin">write$</span> <span class="comment">% for debug</span>
            }
            '<span class="builtin">skip$</span>
          <span class="builtin">if$</span>
          <span class="variable-name">editor</span> 'prev.author.jecon <span class="constant">:=</span>
        }
        { <span class="variable-name">editor</span> 's <span class="constant">:=</span> }
      <span class="builtin">if$</span>
      <span class="comment">% extra.label.bysame &#12395; bysame &#12392;&#12356;&#12358;&#20516;&#12364;&#20837;&#12387;&#12390;&#12356;&#12427;&#12363;&#65311;</span>
      extra.label.bysame <span class="string">"bysame"</span> =
        <span class="comment">% Yes &#12394;&#12425; bysame.check &#12395; 1 &#12434;&#20195;&#20837;&#12375;&#12289;bysame &#12434;&#25407;&#20837;</span>
        { #1 'bysame.check <span class="constant">:=</span>
          <span class="variable-name">editor</span> insert.bysame }
        { <span class="variable-name">editor</span> s remove.ss.period.auth }
      <span class="builtin">if$</span>
      #1 bysame.check =
        { <span class="string">""</span> * }
        { <span class="variable-name">editor</span> <span class="builtin">num.names$</span> #1 &gt;
          { <span class="variable-name">editor</span> check.kanji.str
              { bst.editor.jp * }
              { bst.editors * }
            <span class="builtin">if$</span>
          }
          { <span class="variable-name">editor</span> check.kanji.str
              { bst.editor.jp * }
              { bst.editor * }
            <span class="builtin">if$</span>
          }
        <span class="builtin">if$</span>
        }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% author &#12398;&#25972;&#24418;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.authors.alt</span>}
{ <span class="variable-name">author</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    <span class="comment">% extra.label.bysame &#12395; bysame &#12392;&#12356;&#12358;&#20516;&#12364;&#20837;&#12387;&#12390;&#12356;&#12427;&#12363;&#65311;</span>
    { extra.label.bysame <span class="string">"bysame"</span> =
        <span class="comment">% Yes &#12394;&#12425; bysame &#12434;&#25407;&#20837;</span>
        { <span class="variable-name">author</span> insert.bysame }
        { <span class="variable-name">author</span> check.kanji.str
            { bst.author.pre.jp <span class="variable-name">author</span> format.names * bst.author.post.jp * }
            { bst.author.pre <span class="variable-name">author</span> format.names * bst.author.post * }
          <span class="builtin">if$</span>
        }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% editor &#12398;&#25972;&#24418;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.editors.alt</span>}
{ <span class="variable-name">editor</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    <span class="comment">% extra.label.bysame &#12395; bysame &#12392;&#12356;&#12358;&#20516;&#12364;&#20837;&#12387;&#12390;&#12356;&#12427;&#12363;&#65311;</span>
    { extra.label.bysame <span class="string">"bysame"</span> =
        <span class="comment">% Yes &#12394;&#12425; bysame.check &#12395; 1 &#12434;&#20195;&#20837;&#12375;&#12289;bysame &#12434;&#25407;&#20837;</span>
        { #1 'bysame.check <span class="constant">:=</span>
          <span class="variable-name">editor</span> insert.bysame }
        { <span class="variable-name">editor</span> check.kanji.str
            { bst.author.pre.jp <span class="variable-name">editor</span> format.names * }
            { bst.author.pre <span class="variable-name">editor</span> format.names * bst.author.post * }
          <span class="builtin">if$</span>
        }
      <span class="builtin">if$</span>
      #1 bysame.check =
        { <span class="string">""</span> * }
        { <span class="variable-name">editor</span> <span class="builtin">num.names$</span> #1 &gt;
          { <span class="variable-name">editor</span> check.kanji.str
              { bst.editor.jp * }
              { bst.editors * }
            <span class="builtin">if$</span>
          }
          { <span class="variable-name">editor</span> check.kanji.str
              { bst.editor.jp * }
              { bst.editor * }
            <span class="builtin">if$</span>
          }
        <span class="builtin">if$</span>
        }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% format.in.ed.booktitle &#29992;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.editors.x</span>}
{ <span class="variable-name">editor</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { <span class="variable-name">editor</span> format.names 
      <span class="variable-name">editor</span> <span class="builtin">num.names$</span> #1 &gt;
        { <span class="variable-name">editor</span> check.kanji.str
            { bst.editor.jp * }
            { bst.editors * }
          <span class="builtin">if$</span>
        }
        { <span class="variable-name">editor</span> check.kanji.str
            { bst.editor.jp * }
            { bst.editor * }
          <span class="builtin">if$</span>
        }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% &#12300;?.&#12301;&#12289;&#12300;?,&#12301;&#12398;&#12424;&#12358;&#12394;&#12465;&#12540;&#12473;&#12391;&#12289;period&#12289;comma &#12434;&#38500;&#21435;&#12377;&#12427;&#38306;&#25968;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">remove.irrelevant.period.comma</span>}
{ 's <span class="constant">:=</span>
  s <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    <span class="comment">% &#24460;&#12429;&#12363;&#12425;3&#25991;&#23383;&#12392;&#12387;&#12390;&#27604;&#36611;</span>
    { s #-1 #3 <span class="builtin">substring$</span> <span class="string">"?,'"</span> =
      s #-1 #3 <span class="builtin">substring$</span> <span class="string">"?.'"</span> = or
        <span class="comment">% &#24460;&#12429;&#12363;&#12425;3&#25991;&#23383;&#12434;&#38500;&#12356;&#12383;&#12418;&#12398;&#12395; "'" &#12434;&#20184;&#12369;&#12427;&#65294;</span>
        { s #-3 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> <span class="string">"'"</span> * }
        { s #-1 #4 <span class="builtin">substring$</span> <span class="string">"?,''"</span> =
          s #-1 #4 <span class="builtin">substring$</span> <span class="string">"?.''"</span> = or
            { s #-4 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> <span class="string">"''"</span> * }
            { s #-1 #2 <span class="builtin">substring$</span> <span class="string">"?,"</span> =
              s #-1 #2 <span class="builtin">substring$</span> <span class="string">"?."</span> = or
                { s #-2 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> <span class="string">""</span> * }
                { s #-1 #3 <span class="builtin">substring$</span> <span class="string">"?,~"</span> =
                  s #-1 #3 <span class="builtin">substring$</span> <span class="string">"?.~"</span> = or
                    { s #-4 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> <span class="string">"?~"</span> * }
                    { s #-1 #3 <span class="builtin">substring$</span> <span class="string">"?, "</span> =
                      s #-1 #3 <span class="builtin">substring$</span> <span class="string">"?. "</span> = or
                        { s #-4 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> <span class="string">"? "</span> * }
                        's
                      <span class="builtin">if$</span>
                    }
                  <span class="builtin">if$</span>
                }
              <span class="builtin">if$</span>
            }
          <span class="builtin">if$</span>
        }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% &#26368;&#24460;&#12395;&#12388;&#12356;&#12390;&#12356;&#12427;&#12300;&#65292;&#12301;&#12289;&#12300;&#12289;&#12301;&#12289;&#12300;&#65294;&#12301;&#12289;&#12300;&#65294;&#12301;&#12434;&#38500;&#21435;&#12377;&#12427;&#38306;&#25968; (&#37030;&#35379;&#26360;&#29992;)</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">remove.irrelevant.kutoten</span>}
{ 's <span class="constant">:=</span>
  s <span class="builtin">empty$</span>
    { <span class="string">""</span> * }
    { s #-1 #1 <span class="builtin">substring$</span> <span class="string">"&#12289;"</span> =
      s #-1 #1 <span class="builtin">substring$</span> <span class="string">"&#65292;"</span> = or
      s #-1 #1 <span class="builtin">substring$</span> <span class="string">"&#12290;"</span> = or
      s #-1 #1 <span class="builtin">substring$</span> <span class="string">"&#65294;"</span> = or
        { s #-2 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> <span class="string">""</span> * }
        { s }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% &#26368;&#21021;&#12395;&#12300;&#65292;&#65292;&#12301;&#12289;&#12300;&#12289;&#12289;&#12301;&#12289;&#12300;&#65292;&#12289;&#12301;&#12289;&#12300;&#12289;&#65292;&#12301;&#31561;&#12364;&#20184;&#12356;&#12390;&#12356;&#12383;&#12425;&#19968;&#20491;&#30446;&#12434;&#38500;&#21435;&#12375;&#12383;</span>
<span class="comment">%%% &#25991;&#23383;&#21015;&#12434;&#36820;&#12377;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">remove.irrelevant.pre.kutoten</span>}
{ 's <span class="constant">:=</span>
  s <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { s #1 #4 <span class="builtin">substring$</span> <span class="string">"&#12289;&#12289;"</span> =
      s #1 #4 <span class="builtin">substring$</span> <span class="string">"&#65292;&#65292;"</span> = or
      s #1 #4 <span class="builtin">substring$</span> <span class="string">"&#65292;&#12289;"</span> = or
      s #1 #4 <span class="builtin">substring$</span> <span class="string">"&#12289;&#65292;"</span> = or
        { s #3 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> }
        { s }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% title &#12398;&#25972;&#24418;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.title.sub</span>}
{ bst.title.lower.case #0 =
     { bst.title.pre <span class="variable-name">title</span> * bst.title.post * }
     { bst.title.pre <span class="variable-name">title</span> <span class="string">"t"</span> <span class="builtin">change.case$</span> * bst.title.post * }
  <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">format.title</span>}
{ <span class="variable-name">title</span> <span class="builtin">empty$</span>
  bst.hide.title #0 = not or
    { <span class="string">""</span> }
    { is.kanji.entry
      { bst.title.pre.jp <span class="variable-name">title</span> * bst.title.post.jp * }
      { format.title.sub remove.irrelevant.period.comma }
     <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% jtitle &#12398;&#25972;&#24418;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.jtitle</span>}
{ <span class="variable-name">jtitle</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { bst.book.pre.jp <span class="variable-name">jtitle</span> * bst.book.post.jp * }
  <span class="builtin">if$</span>
}

<span class="comment">%%% misc &#12398; title &#12398;&#20966;&#29702;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.misc.title</span>}
{ <span class="variable-name">title</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { is.kanji.entry
      { bst.title.pre.jp <span class="variable-name">title</span> * bst.title.post.jp * }
      { bst.title.pre <span class="variable-name">title</span> * bst.title.post * }
     <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">% - &#12434; -- &#12395;&#12377;&#12427;&#38306;&#25968; (pages &#29992;)</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">n.dashify</span>}
{ 't <span class="constant">:=</span>
  <span class="string">""</span>
  <span class="comment">%% while$ &#12398;&#26465;&#20214; (t &#12364; empty &#12391;&#12394;&#12356;&#12394;&#12425;&#23455;&#34892;)</span>
  { t <span class="builtin">empty$</span> not }
  <span class="comment">%% &#20966;&#29702;</span>
  { t #1 #1 <span class="builtin">substring$</span> <span class="string">"-"</span> =
      { t #1 #2 <span class="builtin">substring$</span> <span class="string">"--"</span> = not
          { bst.dashify.off
              { <span class="string">"-"</span> * }
              { <span class="string">"--"</span> * }
            <span class="builtin">if$</span>
            t #2 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> 't <span class="constant">:=</span>
          }
          { { t #1 #1 <span class="builtin">substring$</span> <span class="string">"-"</span> = }
            { <span class="string">"-"</span> *
              t #2 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> 't <span class="constant">:=</span>
            }
            <span class="builtin">while$</span>
          }
        <span class="builtin">if$</span>
      }
      { t #1 #1 <span class="builtin">substring$</span> <span class="builtin">is.kanji.str$</span>
        { t #1 #2 <span class="builtin">substring$</span> *
          t #3 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> 't <span class="constant">:=</span>
        }
         { t #1 #1 <span class="builtin">substring$</span> *
          t #2 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> 't <span class="constant">:=</span>
        }
        <span class="builtin">if$</span>
      }
    <span class="builtin">if$</span>
  }
  <span class="builtin">while$</span>
}

<span class="comment">%%% &#19982;&#12360;&#12425;&#12428;&#12383;&#25968;&#12434;&#28450;&#25968;&#23383;&#12395;&#22793;&#25563;: 0-&gt;&#12295;, 1-&gt;&#19968;, 2-&gt;&#20108;,..., 9-&gt;&#20061; &#12392;&#12356;&#12358;&#23550;&#24540;&#38306;&#20418;&#12290;</span>
<span class="comment">%%% &#12373;&#12425;&#12395;&#12289;"-" &#12399;&#32294;&#26834;&#12395;&#22793;&#25563;&#12377;&#12427;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">convert.num.kanji</span>}
{ 's <span class="constant">:=</span>
  s <span class="string">"1"</span> =
    { <span class="string">"&#19968;"</span> }
    { s <span class="string">"2"</span> =
        { <span class="string">"&#20108;"</span> }
        { s <span class="string">"3"</span> =
            { <span class="string">"&#19977;"</span> }
            { s <span class="string">"4"</span> =
                { <span class="string">"&#22235;"</span> }
                { s <span class="string">"5"</span> =
                    { <span class="string">"&#20116;"</span> }
                    { s <span class="string">"6"</span> =
                        { <span class="string">"&#20845;"</span> }
                        { s <span class="string">"7"</span> =
                            { <span class="string">"&#19971;"</span> }
                            { s <span class="string">"8"</span> =
                                { <span class="string">"&#20843;"</span> }
                                { s <span class="string">"9"</span> =
                                    { <span class="string">"&#20061;"</span> }
                                    { s <span class="string">"0"</span> =
                                        { <span class="string">"&#12295;"</span> }
                                        { s <span class="string">"-"</span> =
                                           { <span class="string">"\tatebo{}"</span> }
                                           { s }
                                          <span class="builtin">if$</span>
                                        }
                                      <span class="builtin">if$</span>
                                    }
                                <span class="builtin">if$</span>
                                }
                            <span class="builtin">if$</span>
                            }
                        <span class="builtin">if$</span>
                        }
                    <span class="builtin">if$</span>
                    }
                <span class="builtin">if$</span>
                }
            <span class="builtin">if$</span>
            }
        <span class="builtin">if$</span>
        }
    <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% &#21322;&#35282;&#12398; alphabet &#12434;&#20840;&#35282;&#12398; alphabet &#12395;&#22793;&#26356;&#12377;&#12427;&#38306;&#25968; (a-j &#12414;&#12391;&#12398;&#12415;)&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">convert.alphabet.zenkaku</span>}
{ 's <span class="constant">:=</span>
  s <span class="string">"a"</span> =
    { <span class="string">"&#65345;"</span> }
    { s <span class="string">"b"</span> =
        { <span class="string">"&#65346;"</span> }
        { s <span class="string">"c"</span> =
            { <span class="string">"&#65347;"</span> }
            { s <span class="string">"d"</span> =
                { <span class="string">"&#65348;"</span> }
                { s <span class="string">"e"</span> =
                    { <span class="string">"&#65349;"</span> }
                    { s <span class="string">"f"</span> =
                        { <span class="string">"&#65350;"</span> }
                        { s <span class="string">"g"</span> =
                            { <span class="string">"&#65351;"</span> }
                            { s <span class="string">"h"</span> =
                                { <span class="string">"&#65352;"</span> }
                                { s <span class="string">"i"</span> =
                                    { <span class="string">"&#65353;"</span> }
                                    { s <span class="string">"j"</span> =
                                        { <span class="string">"&#65354;"</span> }
                                        { s }
                                    <span class="builtin">if$</span>
                                    }
                                <span class="builtin">if$</span>
                                }
                            <span class="builtin">if$</span>
                            }
                        <span class="builtin">if$</span>
                        }
                    <span class="builtin">if$</span>
                    }
                <span class="builtin">if$</span>
                }
            <span class="builtin">if$</span>
            }
        <span class="builtin">if$</span>
        }
    <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% year &#12434;&#28450;&#25968;&#23383;&#12395;&#22793;&#25563;</span>
<span class="keyword">FUNCTION</span>{<span class="function-name">convert.year.kanji</span>}
{ 't <span class="constant">:=</span>
  <span class="comment">%% bst.kansuji.jp &#12364;&#38750;&#12476;&#12525;&#12391;&#12363;&#12388;&#65292;t &#12364;&#28450;&#23383;&#12376;&#12419;&#12394;&#12356;&#12398;&#12394;&#12425;&#65292;&#28450;&#23383;&#12395;&#22793;&#25563;</span>
  bst.kansuji.jp #0 = not t <span class="builtin">is.kanji.str$</span> not and 
     { <span class="string">""</span> 'tt <span class="constant">:=</span>
       { t <span class="builtin">empty$</span> not }
       { tt t #1 #1 <span class="builtin">substring$</span> convert.num.kanji convert.alphabet.zenkaku * 'tt <span class="constant">:=</span>
         t #2 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> 't <span class="constant">:=</span> }
       <span class="builtin">while$</span>
     }
     { t 'tt <span class="constant">:=</span> }
  <span class="builtin">if$</span>
 tt
}

<span class="comment">%%% bst.kansuji.jp &#12364;&#38750;&#12476;&#12525;&#12398;&#12392;&#12365;&#12289;&#25968;&#23383;&#12434;&#28450;&#25968;&#23383;&#12395;&#22793;&#25563;&#12377;&#12427;&#38306;&#25968;&#12290;</span>
<span class="keyword">FUNCTION</span>{<span class="function-name">convert.num</span>}
{ 't <span class="constant">:=</span>
  bst.kansuji.jp #0 = t <span class="builtin">is.kanji.str$</span> or
     { t 'tt <span class="constant">:=</span> }
     { <span class="string">""</span> 'tt <span class="constant">:=</span>
       { t <span class="builtin">empty$</span> not }
       { t #1 #1 <span class="builtin">substring$</span> convert.num.kanji 'ss <span class="constant">:=</span>
         tt ss * 'tt <span class="constant">:=</span>
         t #2 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> 't <span class="constant">:=</span>
         }
       <span class="builtin">while$</span>
     }
  <span class="builtin">if$</span>
 tt
}

<span class="comment">%% &#22793;&#25968;&#23450;&#32681;</span>
<span class="keyword">STRINGS</span> { da db dc dd }
<span class="comment">%% pages &#12398; "--" &#12434; "-" &#12395;&#22793;&#25563;&#12377;&#12427;&#65294;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">remove.duplicate.dash</span>}
{ 'da <span class="constant">:=</span>
  <span class="string">""</span> 'db <span class="constant">:=</span>
  <span class="string">""</span> 'dc <span class="constant">:=</span>
  <span class="string">""</span> 'dd <span class="constant">:=</span>
  { da <span class="builtin">empty$</span> not }
  { da #1 #1 <span class="builtin">substring$</span> 'db <span class="constant">:=</span>
    db <span class="string">"-"</span> = dc <span class="string">"-"</span> = and
       '<span class="builtin">skip$</span>
       { dd db * 'dd <span class="constant">:=</span> }
    <span class="builtin">if$</span>
    db 'dc <span class="constant">:=</span>
    da #2 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> 'da <span class="constant">:=</span>
  }
  <span class="builtin">while$</span>
  dd
}

<span class="comment">%%% bst.kansuji.jp &#12364;&#38750;&#12476;&#12525;&#12398;&#12392;&#12365;&#12289;pages &#12434;&#28450;&#25968;&#23383;&#12395;&#22793;&#25563;&#12377;&#12427;&#38306;&#25968;&#12290;</span>
<span class="keyword">FUNCTION</span>{<span class="function-name">convert.num.pages</span>}
{ 't <span class="constant">:=</span>
  bst.kansuji.jp #0 = t <span class="builtin">is.kanji.str$</span> or
     { t 'tt <span class="constant">:=</span> }
     { <span class="string">""</span> 'tt <span class="constant">:=</span>
       t remove.duplicate.dash 't <span class="constant">:=</span>
       { t <span class="builtin">empty$</span> not }
       { t #1 #1 <span class="builtin">substring$</span> convert.num.kanji 'ss <span class="constant">:=</span>
         tt ss * 'tt <span class="constant">:=</span>
         t #2 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> 't <span class="constant">:=</span>
         }
       <span class="builtin">while$</span>
     }
  <span class="builtin">if$</span>
 tt
}

<span class="comment">%%% year &#12398;&#20966;&#29702;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.year</span>}
{ <span class="variable-name">year</span> <span class="builtin">empty$</span>
    { <span class="string">"there's no year in "</span> <span class="builtin">cite$</span> * <span class="builtin">warning$</span>
      <span class="string">""</span> }
    { is.kanji.entry
        { bst.kansuji.jp #0 =
           { bst.year.pre.jp <span class="variable-name">year</span> * extra.label * bst.year.post.jp * }
           { bst.year.pre.jp <span class="variable-name">year</span> convert.year.kanji *
             extra.label convert.alphabet.zenkaku * bst.year.post.jp * }
          <span class="builtin">if$</span>
        }
        { bst.year.pre <span class="variable-name">year</span> * extra.label * bst.year.post * }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% book &#12398; page &#12398;&#20966;&#29702;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.book.pages</span>}
{ <span class="variable-name">pages</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { is.kanji.entry
        { bst.page.pre.jp <span class="variable-name">pages</span> convert.num.pages * bst.page.post.jp * }
        { bst.pages.pre <span class="variable-name">pages</span> * bst.pages.post * }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% 2&#25991;&#23383;&#20197;&#19979;&#12394;&#12425;&#21069;&#12395; tie &#12434;&#20184;&#12369;&#12427;&#65294;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">tie.or.space.connect</span>}
{ <span class="builtin">duplicate$</span> <span class="builtin">text.length$</span> #3 &lt;
    { <span class="string">"~"</span> }
    { <span class="string">" "</span> }
  <span class="builtin">if$</span>
  <span class="builtin">swap$</span> * *
}

<span class="keyword">FUNCTION</span> {<span class="function-name">either.or.check</span>}
{ <span class="builtin">empty$</span>
    '<span class="builtin">pop$</span>
    { <span class="string">"can't use both "</span> <span class="builtin">swap$</span> * <span class="string">" fields in "</span> * <span class="builtin">cite$</span> * <span class="builtin">warning$</span> }
  <span class="builtin">if$</span>
}

<span class="comment">%%% book &#12398; volume &#12398;&#25972;&#24418;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.bvolume</span>}
{ <span class="variable-name">volume</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { is.kanji.entry
        { bst.volume.pre.jp <span class="variable-name">volume</span> convert.num * bst.volume.post.jp * }
        { bst.volume.pre <span class="variable-name">volume</span> * bst.volume.post * }
      <span class="builtin">if$</span>
      <span class="variable-name">series</span> <span class="builtin">empty$</span>
        '<span class="builtin">skip$</span>
        <span class="comment">%% series &#12418;&#12354;&#12427;&#12392;&#12365;</span>
        { is.kanji.entry
            { bst.series.pre.jp * <span class="variable-name">series</span> convert.num * bst.series.post.jp * }
            { <span class="string">" of "</span> * <span class="variable-name">series</span> * bst.series.post * }
          <span class="builtin">if$</span>
        }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% series &#12398;&#20986;&#21147;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">output.series</span>}
{ <span class="variable-name">series</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { is.kanji.entry
        { bst.series.pre.jp <span class="variable-name">series</span> convert.num * bst.series.post.jp * }
        { bst.series.pre <span class="variable-name">series</span> * bst.series.post * }
      <span class="builtin">if$</span>
    }
 <span class="builtin">if$</span>
}

<span class="comment">%%% number &#12392; series &#12434;&#20986;&#21147;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.number.series</span>}
{ <span class="variable-name">volume</span> <span class="builtin">empty$</span>
    { <span class="variable-name">number</span> <span class="builtin">empty$</span>
      bst.hide.number #0 = not or
        <span class="comment">% number is empty</span>
        { <span class="variable-name">series</span> <span class="builtin">empty$</span>
            { <span class="string">""</span> }
            <span class="comment">% series is not empty.</span>
            { output.series }
          <span class="builtin">if$</span>
        }
        <span class="comment">% number is not empty$</span>
        { <span class="variable-name">series</span> <span class="builtin">empty$</span>
            { is.kanji.entry
                { bst.number.pre.jp <span class="variable-name">number</span> convert.num * bst.number.post.jp * }
                { bst.number.pre <span class="variable-name">number</span> * bst.number.post * }
              <span class="builtin">if$</span>
            }
            <span class="comment">% series is not empty.  &#26085;&#26412;&#35486;&#12392;&#33521;&#35486;&#12391;&#38918;&#24207;&#36870;&#12395;&#12377;&#12427;&#12290;</span>
            { is.kanji.entry
                { bst.series.pre.jp <span class="variable-name">series</span> convert.num * bst.series.post.jp *
                  bst.number.pre.jp * <span class="variable-name">number</span> convert.num * bst.number.post.jp * }
                { bst.in bst.series.pre * <span class="variable-name">series</span> * bst.series.post *
                  bst.number.pre * <span class="variable-name">number</span> * bst.number.post * }
              <span class="builtin">if$</span>
            }
          <span class="builtin">if$</span>
        }
      <span class="builtin">if$</span>
    }
    { <span class="string">""</span> }
  <span class="builtin">if$</span>
}

<span class="comment">%%% &#25968;&#23383;&#12363;&#12393;&#12358;&#12363;&#21028;&#26029;&#12377;&#12427;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">is.num</span>}
{ <span class="builtin">chr.to.int$</span>
  <span class="builtin">duplicate$</span> <span class="string">"0"</span> <span class="builtin">chr.to.int$</span> &lt; not
  <span class="builtin">swap$</span> <span class="string">"9"</span> <span class="builtin">chr.to.int$</span> &gt; not and
}

<span class="keyword">FUNCTION</span> {<span class="function-name">extract.num</span>}
{ <span class="builtin">duplicate$</span> 't <span class="constant">:=</span>
  <span class="string">""</span> 's <span class="constant">:=</span>
  { t <span class="builtin">empty$</span> not }
  { t #1 #1 <span class="builtin">substring$</span>
    t #2 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> 't <span class="constant">:=</span>
    <span class="builtin">duplicate$</span> is.num
      { s <span class="builtin">swap$</span> * 's <span class="constant">:=</span> }
      { <span class="builtin">pop$</span> <span class="string">""</span> 't <span class="constant">:=</span> }
    <span class="builtin">if$</span>
  }
  <span class="builtin">while$</span>
  s <span class="builtin">empty$</span>
    '<span class="builtin">skip$</span>
    { <span class="builtin">pop$</span> s }
  <span class="builtin">if$</span>
}

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%%      edition &#20966;&#29702;&#29992;&#12398;&#12503;&#12525;&#12464;&#12521;&#12512;</span>

<span class="comment">% &#33521;&#35486;&#12398; edition &#12399;&#20840;&#12390; 1st, 2nd, 3rd, 4th etc. &#12395;&#22793;&#25563;&#12377;&#12427;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">eng.ord</span>}
{ <span class="builtin">duplicate$</span> <span class="string">"1"</span> <span class="builtin">swap$</span> *
  #-2 #1 <span class="builtin">substring$</span> <span class="string">"1"</span> =
     { bst.th * }
     { <span class="builtin">duplicate$</span> #-1 #1 <span class="builtin">substring$</span>
       <span class="builtin">duplicate$</span> <span class="string">"1"</span> =
         { <span class="builtin">pop$</span> bst.st * }
         { <span class="builtin">duplicate$</span> <span class="string">"2"</span> =
             { <span class="builtin">pop$</span> bst.nd * }
             { <span class="string">"3"</span> =
                 { bst.rd * }
                 { bst.th * }
               <span class="builtin">if$</span>
             }
           <span class="builtin">if$</span>
          }
       <span class="builtin">if$</span>
     }
   <span class="builtin">if$</span>
}

<span class="comment">% edition entry &#12398; first, second &#31561;&#12434; 1st, 2nd &#12395;&#22793;&#25563;&#12377;&#12427; (from jfm.bst)&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">convert.edition</span>}
{ <span class="variable-name">edition</span> extract.num <span class="string">"l"</span> <span class="builtin">change.case$</span> 's <span class="constant">:=</span>
  s <span class="string">"first"</span> = s <span class="string">"1"</span> = or
    { bst.first }
    { s <span class="string">"second"</span> = s <span class="string">"2"</span> = or
        { bst.second }
        { s <span class="string">"third"</span> = s <span class="string">"3"</span> = or
            { bst.third }
            { s <span class="string">"fourth"</span> = s <span class="string">"4"</span> = or
                { bst.fourth }
                { s <span class="string">"fifth"</span> = s <span class="string">"5"</span> = or
                    { bst.fifth }
                    { s #1 #1 <span class="builtin">substring$</span> is.num
                        { s eng.ord }
                        { <span class="variable-name">edition</span> }
                      <span class="builtin">if$</span>
                    }
                  <span class="builtin">if$</span>
                }
              <span class="builtin">if$</span>
            }
          <span class="builtin">if$</span>
        }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">% &#26085;&#26412;&#35486;&#25991;&#29486;&#12398;&#22580;&#21512;&#12395;&#12399;&#33521;&#35486;&#12398;&#26376;&#12434;&#25968;&#23383;&#12395;&#22793;&#25563;&#12377;&#12427;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">convert.month</span>}
{ 't <span class="constant">:=</span> 
  t <span class="string">"January"</span> =
    { <span class="string">"1"</span> }
    { t <span class="string">"February"</span> =
        { <span class="string">"2"</span> }
        { t <span class="string">"March"</span> =
            { <span class="string">"3"</span> }
            { t <span class="string">"April"</span> =
                { <span class="string">"4"</span> }
                { t <span class="string">"May"</span> =
                    { <span class="string">"5"</span> }
                    { t <span class="string">"June"</span> =
                        { <span class="string">"6"</span> }
                        { t <span class="string">"July"</span> =
                            { <span class="string">"7"</span> }
                            { t <span class="string">"August"</span> =
                                { <span class="string">"8"</span> }
                                { t <span class="string">"September"</span> =
                                    { <span class="string">"9"</span> }
                                    { t <span class="string">"October"</span> =
                                        { <span class="string">"10"</span> }
                                        { t <span class="string">"November"</span> =
                                            { <span class="string">"11"</span> }
                                            { t <span class="string">"December"</span> =
                                                { <span class="string">"12"</span> }
                                                't
                                            <span class="builtin">if$</span>
                                            }
                                        <span class="builtin">if$</span>
                                        }
                                    <span class="builtin">if$</span>
                                    }
                                <span class="builtin">if$</span>
                                }
                            <span class="builtin">if$</span>
                            }
                        <span class="builtin">if$</span>
                        }
                    <span class="builtin">if$</span>
                    }
                <span class="builtin">if$</span>
                }
            <span class="builtin">if$</span>
            }
        <span class="builtin">if$</span>
        }
    <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% edition &#12398;&#25972;&#24418;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.edition</span>}
{ <span class="variable-name">edition</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { is.kanji.entry
        { bst.edition.pre.jp <span class="variable-name">edition</span> convert.num * bst.edition.post.jp * }
        { output.state mid.sentence =
            { bst.edition.pre convert.edition <span class="string">"l"</span> <span class="builtin">change.case$</span> * bst.edition.post * }
            { bst.edition.pre convert.edition <span class="string">"t"</span> <span class="builtin">change.case$</span> * bst.edition.post * }
          <span class="builtin">if$</span>
        }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% month &#12398;&#25972;&#24418;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.month</span>}
{ <span class="variable-name">month</span> <span class="builtin">empty$</span>
  <span class="comment">% bst.hide.month &#12364;&#38750;&#12476;&#12525;&#12394;&#12425; month &#12399;&#20986;&#21147;&#12379;&#12378;</span>
  bst.hide.month #0 = not or
    { <span class="string">""</span> }
    { is.kanji.entry
        { bst.month.pre.jp <span class="variable-name">month</span> convert.month convert.num * bst.month.post.jp * }
        { bst.month.pre <span class="variable-name">month</span> * bst.month.post * }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% year &#12392; month &#12434;&#19968;&#32210;&#12395;&#20966;&#29702;&#12377;&#12427;&#12383;&#12417;&#12398;&#12418;&#12398;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.date</span>}
{ is.kanji.entry
   <span class="comment">%% &#26085;&#26412;&#35486;&#25991;&#29486; -&gt; &#24180; - &#26376;</span>
   { format.year format.month * }
   <span class="comment">%% &#33521;&#35486; -&gt; &#26376; - &#24180;</span>
   { format.month format.year * }
  <span class="builtin">if$</span>
}

<span class="comment">%%% &#35079;&#25968;&#12398;&#12506;&#12540;&#12472;&#12364;&#25351;&#23450;&#12373;&#12428;&#12390;&#12356;&#12427;&#12363;&#12481;&#12455;&#12483;&#12463; (1-100&#31561;&#12398;&#12424;&#12358;&#12395;)&#65294;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name"> multi.page.check </span>}
{ 't <span class="constant">:=</span>
  #0 'multiresult <span class="constant">:=</span>
    { multiresult not
      t <span class="builtin">empty$</span> not
      and
    }
    { t #1 #1 <span class="builtin">substring$</span>
      <span class="builtin">duplicate$</span> <span class="string">"-"</span> =
      <span class="builtin">swap$</span> <span class="builtin">duplicate$</span> <span class="string">","</span> =
      <span class="builtin">swap$</span> <span class="string">"+"</span> =
      or or
        { #1 'multiresult <span class="constant">:=</span> }
        { t #2 <span class="builtin">global.max$</span> <span class="builtin">substring$</span> 't <span class="constant">:=</span> }
      <span class="builtin">if$</span>
    }
  <span class="builtin">while$</span>
  multiresult
}

<span class="comment">%%% pages &#12398;&#25972;&#24418;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.pages</span>}
{ <span class="variable-name">pages</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { is.kanji.entry
        { <span class="variable-name">pages</span> multi.page.check
          { bst.page.pre.jp <span class="variable-name">pages</span> n.dashify convert.num.pages * bst.page.post.jp * }
          { bst.page.pre.jp <span class="variable-name">pages</span> convert.num.pages * bst.page.post.jp * }
         <span class="builtin">if$</span>
        }
        { <span class="variable-name">pages</span> multi.page.check
          { bst.pages.pre <span class="variable-name">pages</span> n.dashify tie.or.space.connect * bst.pages.post }
          { bst.page.pre <span class="variable-name">pages</span> tie.or.space.connect * bst.page.post }
         <span class="builtin">if$</span>
        }
       <span class="builtin">if$</span>
   }
 <span class="builtin">if$</span>
}

<span class="comment">%%% number &#12434;&#25972;&#24418;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.number</span>}
{ <span class="variable-name">number</span> <span class="builtin">empty$</span>
  <span class="comment">% bst.hide.number &#12364;&#38750;&#12476;&#12525;&#12394;&#12425; number &#12399;&#20986;&#21147;&#12379;&#12378;</span>
  bst.hide.number #0 = not or
    { <span class="string">""</span> }
    { is.kanji.entry
        { bst.number.pre.jp <span class="variable-name">number</span> convert.num * bst.number.post.jp * }
        { bst.number.pre <span class="variable-name">number</span> * bst.number.post * }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% volume &#12434;&#25972;&#24418;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.volume</span>}
{ <span class="variable-name">volume</span> <span class="builtin">empty$</span>
    '<span class="builtin">skip$</span>
    { is.kanji.entry
        { bst.volume.pre.jp <span class="variable-name">volume</span> convert.num * bst.volume.post.jp * }
        { bst.volume.pre <span class="variable-name">volume</span> * bst.volume.post * }
      <span class="builtin">if$</span>
      bst.year.position #3 =
        { format.year * }
        '<span class="builtin">skip$</span>
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% number&#12289;page &#12434;&#20986;&#21147;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.number.pages</span>}
{ <span class="variable-name">number</span> <span class="builtin">empty$</span>
    { format.pages }
    { format.number format.pages * }
  <span class="builtin">if$</span>
}

<span class="comment">%%% volume&#12289;page &#12434;&#20986;&#21147;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.volume.pages</span>}
{ <span class="variable-name">volume</span> <span class="builtin">empty$</span>
    { format.pages }
    { format.volume format.pages * }
  <span class="builtin">if$</span>
}

<span class="comment">%%% volume&#12289;number&#12289;page &#12434;&#20986;&#21147;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.volume.number.pages</span>}
{ <span class="variable-name">volume</span> <span class="builtin">empty$</span>
    { <span class="variable-name">number</span> <span class="builtin">empty$</span>
        { format.pages }
        { format.number format.pages * }
      <span class="builtin">if$</span>
    }
    { <span class="variable-name">number</span> <span class="builtin">empty$</span>
        { format.volume format.pages * }
        { format.volume format.number * format.pages * }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">% volume, number, page &#12434;&#19968;&#32210;&#12395;&#20966;&#29702;&#12377;&#12427;&#38306;&#25968;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.vol.num.pages</span>}
{ <span class="variable-name">volume</span> <span class="builtin">empty$</span>
    <span class="comment">%% volume is empty.</span>
    { <span class="variable-name">number</span> <span class="builtin">empty$</span>
        <span class="comment">%% number is empty.</span>
        { <span class="variable-name">pages</span> <span class="builtin">empty$</span>
            <span class="comment">% &#12371;&#12398;&#22580;&#21512;&#12399; warning &#12434;&#20986;&#12377;&#12290;</span>
            { <span class="string">"there is no volume, number, and pages in "</span> <span class="builtin">cite$</span> * <span class="builtin">warning$</span> <span class="string">""</span> } 
            { <span class="string">""</span> format.pages * }
         <span class="builtin">if$</span>
        }
        <span class="comment">%% number is not empty.</span>
        <span class="comment">% &#12371;&#12398;&#22580;&#21512;&#12399; warning &#12434;&#20986;&#12377;&#12290;</span>
        { <span class="string">"there's a number but no volume in "</span> <span class="builtin">cite$</span> * <span class="builtin">warning$</span>
          format.number.pages }
     <span class="builtin">if$</span>
    }
    <span class="comment">%% volume is not empty.</span>
    { <span class="variable-name">number</span> <span class="builtin">empty$</span>
        <span class="comment">%% number is empty.</span>
        { format.volume.pages }
        <span class="comment">%% number is not empty.</span>
        { format.volume.number.pages }
     <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% chapter &#12398;&#25972;&#24418;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.chapter</span>}
{ <span class="variable-name">chapter</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { <span class="variable-name">type</span> <span class="builtin">empty$</span>
        { is.kanji.entry
            { bst.chapter.pre.jp <span class="variable-name">chapter</span> convert.num * bst.chapter.post.jp * }
            { bst.chapter.pre <span class="variable-name">chapter</span> tie.or.space.connect * bst.chapter.post }
          <span class="builtin">if$</span>
        }
        { is.kanji.entry
            { bst.touten.jp * <span class="variable-name">type</span> <span class="string">" "</span> * <span class="variable-name">chapter</span> convert.num * }
            { <span class="string">", "</span> * <span class="variable-name">type</span> <span class="string">" "</span> * <span class="variable-name">chapter</span> * }
          <span class="builtin">if$</span>
        }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% chapter, pages &#12434;&#19968;&#32210;&#12395;&#20966;&#29702;&#12377;&#12427;&#38306;&#25968;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.chapter.pages</span>}
{ <span class="variable-name">chapter</span> <span class="builtin">empty$</span>
    { <span class="variable-name">pages</span> <span class="builtin">empty$</span>
        { <span class="string">""</span> }
        { <span class="string">""</span> format.pages * }
      <span class="builtin">if$</span>
    }
    { <span class="variable-name">pages</span> <span class="builtin">empty$</span>
        { <span class="string">""</span> format.chapter * }
        { <span class="string">""</span> format.chapter * format.pages * }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% editor and booktitle &#12398;&#25972;&#24418;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.in.ed.booktitle</span>}
{ <span class="variable-name">booktitle</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { <span class="variable-name">editor</span> <span class="builtin">empty$</span>
        { is.kanji.entry
            { format.btitle remove.pre.comma.period }
            { bst.in format.btitle * }
          <span class="builtin">if$</span>
        }
        { is.kanji.entry
            { format.editors.x <span class="string">""</span> * format.btitle * }
            { bst.in format.editors.x * <span class="string">" "</span> * format.btitle * }
          <span class="builtin">if$</span>
        }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% translator &amp; kanyaku &#12398;&#25972;&#24418;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.translator</span>}
{ <span class="variable-name">kanyaku</span> <span class="builtin">empty$</span>
   { <span class="variable-name">translator</span> <span class="builtin">empty$</span>
      { <span class="string">""</span> }
      { bst.translator.pre.jp <span class="variable-name">translator</span> format.names * bst.translator.post.jp * }
    <span class="builtin">if$</span>
   }
   { <span class="variable-name">translator</span> <span class="builtin">empty$</span>
      { bst.kanyaku.pre.jp <span class="variable-name">kanyaku</span> format.names * bst.kanyaku.post.jp * }
      { bst.kanyaku.pre.jp <span class="variable-name">kanyaku</span> format.names * bst.kanyaku.post.jp * 
        bst.translator.pre.jp * <span class="variable-name">translator</span> format.names * bst.translator.post.jp * }
     <span class="builtin">if$</span>
   }
  <span class="builtin">if$</span>
}

<span class="comment">%%% howpublished &#12398;&#25972;&#24418;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.howpublished</span>}
{ <span class="variable-name">howpublished</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { is.kanji.entry
        { bst.howpublished.pre.jp <span class="variable-name">howpublished</span> * bst.howpublished.post.jp * }
        { bst.howpublished.pre <span class="variable-name">howpublished</span> * bst.howpublished.post * }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% address &#12398;&#25972;&#24418;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.address</span>}
{ <span class="variable-name">address</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { is.kanji.entry
        { bst.address.pre.jp <span class="variable-name">address</span> * bst.address.post.jp * }
        { bst.address.pre <span class="variable-name">address</span> * bst.address.post * }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% publisher &#12398;&#25972;&#24418;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.publisher</span>}
{ <span class="variable-name">publisher</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { is.kanji.entry 
        { bst.publisher.pre.jp <span class="variable-name">publisher</span> * bst.publisher.post.jp * }
        { bst.publisher.pre <span class="variable-name">publisher</span> * bst.publisher.post * }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% organization &#12398;&#25972;&#24418;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.organization</span>}
{ <span class="variable-name">organization</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { is.kanji.entry
        { bst.organization.pre.jp <span class="variable-name">organization</span> * bst.organization.post.jp * }
        { bst.organization.pre <span class="variable-name">organization</span> * bst.organization.post * }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%% publisher &#12392; address &#12434;&#20986;&#21147;&#12377;&#12427;&#38306;&#25968;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">output.publisher.address</span>}
{ <span class="variable-name">address</span> <span class="builtin">empty$</span>
    { format.publisher <span class="string">"publisher"</span> output.check.nocomma }
    <span class="comment">% &#26085;&#26412;&#35486;&#12289;&#33521;&#35486;&#12391; publisher &#12392; address &#12398;&#38918;&#24207;&#12364;&#36870;</span>
    { is.kanji.entry
        { format.publisher <span class="string">"publisher"</span> output.check.nocomma
          format.address output.nocomma }
        { format.address output.nocomma
          format.publisher <span class="string">"publisher"</span> output.check.nocomma }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%% address, organization, publisher &#12434;&#20986;&#21147;&#12377;&#12427;&#38306;&#25968;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">output.address.organization.publisher</span>}
{ <span class="variable-name">address</span> <span class="builtin">empty$</span>
    <span class="comment">%% address is empty</span>
    { <span class="variable-name">organization</span> <span class="builtin">empty$</span>
        <span class="comment">%% organization is empty</span>
        { <span class="variable-name">publisher</span> <span class="builtin">empty$</span>
            '<span class="builtin">skip$</span>
            { format.publisher <span class="string">"publisher"</span> output.check.nocomma }
          <span class="builtin">if$</span>
        }
        <span class="comment">%% organization is not empty</span>
        { <span class="variable-name">publisher</span> <span class="builtin">empty$</span>
            { format.organization <span class="string">"organization"</span> output.check.nocomma }
            { format.organization <span class="string">"organization"</span> output.check.nocomma
              format.publisher <span class="string">"publisher"</span> output.check.nocomma }
          <span class="builtin">if$</span>
        }
     <span class="builtin">if$</span>
    }
    <span class="comment">%% address is not empty</span>
    { <span class="variable-name">organization</span> <span class="builtin">empty$</span>
        <span class="comment">%% organization is empty</span>
        { <span class="variable-name">publisher</span> <span class="builtin">empty$</span>
            <span class="comment">%% publisher is empty</span>
            { format.address output.nocomma }
            <span class="comment">%% publisher is not empty</span>
            { is.kanji.entry
                { format.publisher <span class="string">"publisher"</span> output.check.nocomma
                  format.address output.nocomma }
                { format.address output.nocomma
                  format.publisher <span class="string">"publisher"</span> output.check.nocomma }
              <span class="builtin">if$</span>
            }
         <span class="builtin">if$</span>
        }
        <span class="comment">%% organization is not empty</span>
        { <span class="variable-name">publisher</span> <span class="builtin">empty$</span>
            <span class="comment">%% publisher is empty</span>
            { format.organization <span class="string">"organization"</span> output.check.nocomma
              format.address output.nocomma }
            <span class="comment">%% publisher is not empty</span>
            { is.kanji.entry
                { format.organization <span class="string">"organization"</span> output.check.nocomma
                  format.publisher <span class="string">"publisher"</span> output.check.nocomma
                  format.address output.nocomma }
                { format.organization <span class="string">"organization"</span> output.check.nocomma
                  format.address output.nocomma
                  format.publisher <span class="string">"publisher"</span> output.check.nocomma }
              <span class="builtin">if$</span>
            }
         <span class="builtin">if$</span>
        }
     <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% misc &#29992;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">empty.misc.check</span>}
{ <span class="variable-name">author</span> <span class="builtin">empty$</span> <span class="variable-name">title</span> <span class="builtin">empty$</span> <span class="variable-name">howpublished</span> <span class="builtin">empty$</span>
  <span class="variable-name">month</span> <span class="builtin">empty$</span> <span class="variable-name">year</span> <span class="builtin">empty$</span> <span class="variable-name">note</span> <span class="builtin">empty$</span>
  and and and and and
  <span class="variable-name">key</span> <span class="builtin">empty$</span> not and
    { <span class="string">"all relevant fields are empty in "</span> <span class="builtin">cite$</span> * <span class="builtin">warning$</span> }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">format.thesis.type</span>}
{ <span class="variable-name">type</span> <span class="builtin">empty$</span>
    '<span class="builtin">skip$</span>
    { <span class="builtin">pop$</span> <span class="string">" "</span> <span class="variable-name">type</span> * }
  <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">format.tr.number</span>}
{ <span class="variable-name">type</span> <span class="builtin">empty$</span>
    { <span class="string">"Technical Report"</span> }
    { <span class="string">" "</span> <span class="variable-name">type</span> * }
  <span class="builtin">if$</span>
  <span class="variable-name">number</span> <span class="builtin">empty$</span>
    { <span class="string">"t"</span> <span class="builtin">change.case$</span> }
    { <span class="variable-name">number</span> tie.or.space.connect }
  <span class="builtin">if$</span>
}

<span class="comment">%%% phdthesis &#12398;&#25972;&#24418;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.phd</span>}
{ is.kanji.entry
    { bst.phdthesis.jp }
    { bst.phdthesis }
   <span class="builtin">if$</span>
}

<span class="comment">%%% mastersthesis &#12398;&#25972;&#24418;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.mthesis</span>}
{ is.kanji.entry
    { bst.mthesis.jp }
    { bst.mthesis }
   <span class="builtin">if$</span>
}

<span class="comment">%%% school &#12398;&#25972;&#24418;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.school</span>}
{ <span class="variable-name">school</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { is.kanji.entry
        { bst.school.pre.jp <span class="variable-name">school</span> * bst.school.post.jp * }
        { bst.school.pre <span class="variable-name">school</span> * bst.school.post * }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% institution &#12398;&#25972;&#24418;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.institution</span>}
{ <span class="variable-name">institution</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { is.kanji.entry
        { bst.institution.pre.jp <span class="variable-name">institution</span> * bst.institution.post.jp * }
        { bst.institution.pre <span class="variable-name">institution</span> * bst.institution.post * }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}  

<span class="comment">%%% hoyakusho &#12398;&#25972;&#24418;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.hoyakusho</span>}
{ <span class="variable-name">jauthor</span> <span class="builtin">empty$</span>
  <span class="variable-name">jkanyaku</span> <span class="builtin">empty$</span>
  <span class="variable-name">jtitle</span> <span class="builtin">empty$</span>
  <span class="variable-name">jpublisher</span> <span class="builtin">empty$</span>
  <span class="variable-name">jyear</span> <span class="builtin">empty$</span>
  and and and and
    { <span class="string">""</span> }
    {
      is.kanji.entry
        { bst.touten.jp }
        { <span class="string">", "</span> }
      <span class="builtin">if$</span>
      bst.hoyakusho.pre.jp * 
      <span class="variable-name">jauthor</span> <span class="builtin">empty$</span>
        { <span class="variable-name">jkanyaku</span> <span class="builtin">empty$</span>
            { <span class="string">""</span> * }
            { <span class="variable-name">jkanyaku</span> format.names * <span class="string">"&#30435;&#35379;"</span> * }
          <span class="builtin">if$</span>
        }
        { <span class="variable-name">jauthor</span> format.names * <span class="string">"&#35379;"</span> *
          <span class="variable-name">jkanyaku</span> <span class="builtin">empty$</span>
            { <span class="string">""</span> * }
            { bst.touten.jp * <span class="variable-name">jkanyaku</span> format.names * <span class="string">"&#30435;&#35379;"</span> * }
          <span class="builtin">if$</span>
        }
      <span class="builtin">if$</span>
      <span class="variable-name">jtitle</span> <span class="builtin">empty$</span>
        { <span class="string">""</span> * }
        { bst.touten.jp format.jtitle * bst.touten.jp * remove.irrelevant.pre.kutoten * }
      <span class="builtin">if$</span>
      <span class="variable-name">jpublisher</span> <span class="builtin">empty$</span>
        { <span class="string">""</span> * }
        { <span class="variable-name">jpublisher</span> * bst.touten.jp * }
      <span class="builtin">if$</span>
      <span class="variable-name">jyear</span> <span class="builtin">empty$</span>
        { <span class="string">""</span> * }
        { <span class="string">""</span> * <span class="variable-name">jyear</span> convert.year.kanji * <span class="string">"&#24180;"</span> * }
      <span class="builtin">if$</span>
      remove.irrelevant.kutoten bst.hoyakusho.post.jp *
    }
 <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">format.url</span>}
{ <span class="variable-name">url</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { <span class="builtin">type$</span> <span class="string">"online"</span> = bst.show.url or
        { is.kanji.entry
            { bst.url.pre.jp <span class="variable-name">url</span> * bst.url.post.jp *
                <span class="variable-name">access</span> <span class="builtin">empty$</span>
                    { <span class="string">""</span> * }
                    { bst.access.pre.jp * <span class="variable-name">access</span> * bst.access.post.jp * }
                <span class="builtin">if$</span>
            }
            { bst.url.pre <span class="variable-name">url</span> * bst.url.post *
                <span class="variable-name">access</span> <span class="builtin">empty$</span>
                    { <span class="string">""</span> * }
                    { bst.access.pre * <span class="variable-name">access</span> * bst.access.post * }
                <span class="builtin">if$</span>
            }
          <span class="builtin">if$</span>
        }
        { <span class="string">""</span> }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">format.doi</span>}
{ <span class="variable-name">doi</span> <span class="builtin">empty$</span> bst.show.doi not or
    { <span class="string">""</span> }
    { is.kanji.entry
        { bst.doi.pre.jp <span class="variable-name">doi</span> * bst.doi.post.jp * }
        { bst.doi.pre <span class="variable-name">doi</span> * bst.doi.post * }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">format.url.doi</span>}
{ <span class="variable-name">url</span> <span class="builtin">empty$</span>
    { format.doi }
    { <span class="variable-name">doi</span> <span class="builtin">empty$</span>
        { format.url }
        { bst.url.doi #0 =
            { format.url output.nocomma
              format.doi }
            { bst.url.doi #1 =
                { format.url } 
                { format.doi }
              <span class="builtin">if$</span>
            }
          <span class="builtin">if$</span>
        }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">format.note</span>}
{ <span class="variable-name">note</span> <span class="builtin">empty$</span>
    { <span class="string">""</span> }
    { is.kanji.entry
        { bst.note.pre.jp <span class="variable-name">note</span> * bst.note.post.jp * }
        { bst.note.pre <span class="variable-name">note</span> * bst.note.post * }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%        \havarditem &#12398;&#20986;&#21147;&#65294;</span>

<span class="keyword">FUNCTION</span> {<span class="function-name">output.number.index</span>}
{
  bst.use.number.index #0 =
     '<span class="builtin">skip$</span>
     { index #1 <span class="constant">+</span> 'index <span class="constant">:=</span>
       <span class="string">""</span> 'preone <span class="constant">:=</span>
       <span class="string">""</span> 'preten <span class="constant">:=</span>
       bst.number.index.digit <span class="string">"1"</span> =
         '<span class="builtin">skip$</span>
         { bst.number.index.digit <span class="string">"2"</span> =
           { <span class="string">"\hskip0.5em"</span> 'preone <span class="constant">:=</span> }
           { bst.number.index.digit <span class="string">"3"</span> =
              { <span class="string">"\hskip1em"</span> 'preone <span class="constant">:=</span>
                <span class="string">"\hskip0.5em"</span> 'preten <span class="constant">:=</span> }
              '<span class="builtin">skip$</span>
             <span class="builtin">if$</span>
           }
         <span class="builtin">if$</span>
         }
       <span class="builtin">if$</span>  
     }
  <span class="builtin">if$</span>
  <span class="builtin">newline$</span>
  <span class="string">""</span>
  <span class="comment">% &#20197;&#19979;&#12418;&#12289;number index &#12434;&#20184;&#12369;&#12427;&#22580;&#21512;&#12398;&#20966;&#29702;</span>
  bst.use.number.index #0 =
     '<span class="builtin">skip$</span>
     { index #10 &lt;
         <span class="comment">% number index &#12398;&#26689;&#12395;&#24540;&#12376;&#12390;&#21069;&#12395;&#31354;&#30333;&#12434;&#20837;&#12428;&#12427;&#12290;</span>
         { preone }
         { index #100 &lt;
             { preten }
             { <span class="string">""</span> }
           <span class="builtin">if$</span>
         }
       <span class="builtin">if$</span>
       bst.number.index.pre * index <span class="builtin">int.to.str$</span> * bst.number.index.post * <span class="builtin">write$</span>
     }
 <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">output.bibitem</span>}
{ bst.harvarditem.off
    { before.all 'output.state <span class="constant">:=</span>
      <span class="string">""</span> }
    { <span class="builtin">newline$</span>
      <span class="string">"\harvarditem["</span> <span class="builtin">write$</span>
      alabel <span class="builtin">write$</span>                     <span class="comment">% alabel &#12364; abbreviated citation</span>
      <span class="string">"]{"</span> <span class="builtin">write$</span>
      flabel <span class="builtin">write$</span>                     <span class="comment">% flabel &#12364; full citation</span>
      <span class="string">"}{"</span> <span class="builtin">write$</span>
      is.kanji.entry
         { cyear convert.year.kanji <span class="builtin">write$</span> }    <span class="comment">% cyear &#12364; year</span>
         { cyear <span class="builtin">write$</span> }
      <span class="builtin">if$</span>
      <span class="comment">% cyear &#12364; year</span>
      <span class="string">"}{"</span> <span class="builtin">write$</span>
      <span class="builtin">cite$</span> <span class="builtin">write$</span>                      <span class="comment">% cite$ &#12391; keyword &#12364;&#12503;&#12483;&#12471;&#12517;&#12373;&#12428;&#12427;&#12290;</span>
      <span class="string">"}"</span> <span class="builtin">write$</span>
      before.all 'output.state <span class="constant">:=</span>
    
      <span class="comment">% &#20197;&#19979;&#12399;&#12289;number index &#12434;&#20184;&#12369;&#12427;&#22580;&#21512;&#12398;&#20966;&#29702;</span>
      output.number.index
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%        &#12456;&#12531;&#12488;&#12522;&#12540;&#12398;&#12479;&#12452;&#12503;&#21029;&#12398;&#20966;&#29702;</span>

<span class="comment">% FUNCTION {article} &#12399; article &#12479;&#12452;&#12503;&#12398;&#12456;&#12531;&#12488;&#12522;&#12540;&#12434;&#20966;&#29702;&#12377;&#12427;&#12383;&#12417;&#12398;&#38306;&#25968;&#12290;</span>

<span class="keyword">FUNCTION</span> {<span class="function-name">test</span>}
{
  output.bibitem
  <span class="variable-name">author</span> output.nocomma
  <span class="variable-name">year</span> output.nocomma
  fin.entry
}

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%        article &#12398;&#20966;&#29702;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">article</span>}
{ output.bibitem
  format.authors <span class="string">"author"</span> output.check.nocomma
  bst.year.position #0 =
    { format.year <span class="string">"year"</span> output.check.nocomma }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
  format.title <span class="string">"title"</span> output.check.nocomma

  format.journal <span class="string">"journal"</span> output.check.nocomma
  bst.year.position #2 =
    { format.date output.nocomma }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
  format.vol.num.pages output.nocomma

  bst.year.position #1 =
    { format.date output.nocomma }
    { format.month output.nocomma }
  <span class="builtin">if$</span>

  format.url.doi output.nocomma
  format.note output.nocomma
  fin.entry
}

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%        book &#12398;&#20966;&#29702;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">book</span>}
{ output.bibitem
  <span class="variable-name">author</span> <span class="builtin">empty$</span>
    { format.editors <span class="string">"author and editor"</span> output.check.nocomma }
    { format.authors output.nonnull.nocomma
      <span class="string">"author and editor"</span> <span class="variable-name">editor</span> either.or.check 
    }
  <span class="builtin">if$</span>
  bst.year.position #0 =
    { format.year <span class="string">"year"</span> output.check.nocomma }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
  format.book <span class="string">"title"</span> output.check.nocomma

  format.translator output.nocomma
  format.bvolume output.nocomma
  format.number.series output.nocomma
  output.publisher.address

  format.edition output.nocomma
  format.book.pages output.nocomma

  bst.year.position #0 = not
    { format.year <span class="string">"year"</span> output.check.nocomma }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>

  format.hoyakusho output.nocomma
  format.url.doi output.nocomma
  format.doi output.nocomma

  format.note output.nocomma
  fin.entry
}

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%        booklet &#12398;&#20966;&#29702;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">booklet</span>}
{ output.bibitem
  format.authors output.nocomma
  format.year output.nocomma
  format.misc.title <span class="string">"title"</span> output.check.nocomma
  format.howpublished output.nocomma
  format.address output.nocomma

  format.url.doi output.nocomma

  format.note output.nocomma
  fin.entry
}

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       inbook &#12398;&#20966;&#29702;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">inbook</span>}
{ output.bibitem
  <span class="variable-name">author</span> <span class="builtin">empty$</span>
    { format.editors <span class="string">"author and editor"</span> output.check.nocomma }
    { format.authors output.nonnull.nocomma
      <span class="string">"author and editor"</span> <span class="variable-name">editor</span> either.or.check
    }
  <span class="builtin">if$</span>
  bst.year.position #0 =
    { format.year <span class="string">"year"</span> output.check.nocomma }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
  format.book <span class="string">"title"</span> output.check.nocomma
  format.edition output.nocomma

  format.bvolume output.nocomma
  format.chapter.pages <span class="string">"chapter and pages"</span> output.check.nocomma
  format.number.series output.nocomma
  output.publisher.address

  bst.year.position #0 = not
    { format.year <span class="string">"year"</span> output.check.nocomma }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>

  format.url.doi output.nocomma

  format.note output.nocomma
  fin.entry
}

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       incollection &#12398;&#20966;&#29702;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">incollection</span>}
{ output.bibitem
  format.authors <span class="string">"author"</span> output.check.nocomma
  bst.year.position #0 =
    { format.year <span class="string">"year"</span> output.check.nocomma }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
  format.title <span class="string">"title"</span> output.check.nocomma

  format.in.ed.booktitle <span class="string">"booktitle"</span> output.check.nocomma
  format.bvolume output.nocomma
  output.address.organization.publisher
  format.edition output.nocomma
  format.chapter.pages output.nocomma

  bst.year.position #0 = not
    { format.year <span class="string">"year"</span> output.check.nocomma }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>

  format.url.doi output.nocomma

  format.note output.nocomma
  fin.entry
}

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       inproceedings &#12398;&#20966;&#29702;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">inproceedings</span>}
{ output.bibitem
  format.authors <span class="string">"author"</span> output.check.nocomma
  bst.year.position #0 =
    { format.year <span class="string">"year"</span> output.check.nocomma }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
  format.title <span class="string">"title"</span> output.check.nocomma

  format.in.ed.booktitle <span class="string">"booktitle"</span> output.check.nocomma
  format.bvolume output.nocomma
  format.number.series output.nocomma
  format.pages output.nocomma
  output.address.organization.publisher

  bst.year.position #0 = not
    { format.date output.nocomma }
    { format.month output.nocomma }
  <span class="builtin">if$</span>

  format.url.doi output.nocomma

  format.note output.nocomma
  fin.entry
}

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       conference &#12398;&#20966;&#29702;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">conference</span>}
{ inproceedings }

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       manual &#12398;&#20966;&#29702;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">manual</span>}
{ output.bibitem
  <span class="variable-name">author</span> <span class="builtin">empty$</span>
    { <span class="variable-name">organization</span> <span class="builtin">empty$</span>
        '<span class="builtin">skip$</span>
        { <span class="variable-name">organization</span> output.nonnull.nocomma
          <span class="variable-name">address</span> output.nocomma
        }
      <span class="builtin">if$</span>
    }
    { format.authors output.nonnull.nocomma }
  <span class="builtin">if$</span>
  bst.year.position #0 =
    { format.year <span class="string">"year"</span> output.check.nocomma }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
  format.book <span class="string">"title"</span> output.check.nocomma
  <span class="variable-name">author</span> <span class="builtin">empty$</span>
    { <span class="variable-name">organization</span> <span class="builtin">empty$</span>
        { format.address new.block.check
          format.address output.nocomma
        }
        '<span class="builtin">skip$</span>
      <span class="builtin">if$</span>
    }
    { output.address.organization.publisher }
  <span class="builtin">if$</span>
  format.edition output.nocomma

  bst.year.position #0 = not
    { format.year <span class="string">"year"</span> output.check.nocomma }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>

  format.url.doi output.nocomma

  format.note output.nocomma
  fin.entry
}

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       mastersthesis &#12398;&#20966;&#29702;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">mastersthesis</span>}
{ output.bibitem
  format.authors <span class="string">"author"</span> output.check.nocomma
  bst.year.position #0 =
    { format.year <span class="string">"year"</span> output.check.nocomma }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
  format.title <span class="string">"title"</span> output.check.nocomma
  format.mthesis format.thesis.type output.nonnull.nocomma
  format.school <span class="string">"school"</span> output.check.nocomma
  format.address output.nocomma

  bst.year.position #0 = not
    { format.year <span class="string">"year"</span> output.check.nocomma }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>

  format.url.doi output.nocomma

  format.note output.nocomma
  fin.entry
}

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       misc &#12398;&#20966;&#29702;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">misc</span>}
{ output.bibitem
  format.authors <span class="string">"author"</span> output.check.nocomma
  bst.year.position #0 =
    { format.year <span class="string">"year"</span> output.check.nocomma }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
  format.misc.title output.nocomma
  format.howpublished output.nocomma

  remove.irrelevant.kutoten

  bst.year.position #0 = not
    { format.date output.nocomma }
    { format.month output.nocomma }
  <span class="builtin">if$</span>

  format.url.doi output.nocomma

  format.note output.nocomma
  fin.entry
  empty.misc.check
}

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       online &#12398;&#20966;&#29702;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">online</span>}
{ output.bibitem
  format.authors <span class="string">"author"</span> output.check.nocomma
  bst.year.position #0 =
    { format.year <span class="string">"year"</span> output.check.nocomma }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
  format.misc.title output.nocomma
  format.howpublished output.nocomma

  remove.irrelevant.kutoten

  bst.year.position #0 = not
    { format.date output.nocomma }
    { format.month output.nocomma }
  <span class="builtin">if$</span>

  format.url.doi output.nocomma

  format.note output.nocomma
  fin.entry
  empty.misc.check
}

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       phdthesis &#12398;&#20966;&#29702;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">phdthesis</span>}
{ output.bibitem
  format.authors <span class="string">"author"</span> output.check.nocomma
  bst.year.position #0 =
    { format.year <span class="string">"year"</span> output.check.nocomma }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
  format.title <span class="string">"title"</span> output.check.nocomma
  format.phd
  format.thesis.type output.nonnull.nocomma
  format.school <span class="string">"school"</span> output.check.nocomma
  <span class="variable-name">address</span> <span class="builtin">empty$</span>
    '<span class="builtin">skip$</span>
    { format.address output.nocomma }
  <span class="builtin">if$</span>

  bst.year.position #0 = not
    { format.year <span class="string">"year"</span> output.check.nocomma }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>

  format.url.doi output.nocomma

  format.note output.nocomma
  fin.entry
}

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       proceedings &#12398;&#20966;&#29702;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">proceedings</span>}
{ output.bibitem
  <span class="variable-name">editor</span> <span class="builtin">empty$</span>
    { <span class="variable-name">organization</span> output.nocomma }
    { format.editors output.nonnull.nocomma }
  <span class="builtin">if$</span>
  bst.year.position #0 =
    { format.year <span class="string">"year"</span> output.check.nocomma }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
  format.btitle remove.pre.comma.period <span class="string">"title"</span> output.check.nocomma
  format.bvolume output.nocomma
  format.number.series output.nocomma
  output.address.organization.publisher

  bst.year.position #0 = not
    { format.year <span class="string">"year"</span> output.check.nocomma }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>

  format.url.doi output.nocomma

  format.note output.nocomma
  fin.entry
}

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       techreport &#12398;&#20966;&#29702;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">techreport</span>}
{ output.bibitem
  format.authors <span class="string">"author"</span> output.check.nocomma
  bst.year.position #0 =
    { format.year <span class="string">"year"</span> output.check.nocomma }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
  format.title <span class="string">"title"</span> output.check.nocomma
  format.tr.number output.nonnull.nocomma
  format.institution <span class="string">"institution"</span> output.check.nocomma
  format.address output.nocomma
  format.chapter.pages output.nocomma <span class="comment">%%% added</span>

  bst.year.position #0 = not
    { format.year <span class="string">"year"</span> output.check.nocomma }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>

  format.url.doi output.nocomma

  format.note output.nocomma
  fin.entry
}

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       unpublished &#12398;&#20966;&#29702;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">unpublished</span>}
{ output.bibitem
  format.authors <span class="string">"author"</span> output.check.nocomma
  bst.year.position #0 =
    { format.year <span class="string">"year"</span> output.check.nocomma }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
  format.title <span class="string">"title"</span> output.check.nocomma

  bst.year.position #0 = not
    { format.date remove.pre.comma.period output.nocomma }
    { <span class="variable-name">month</span> <span class="builtin">empty$</span>
        '<span class="builtin">skip$</span>
        { format.month remove.pre.comma.period output.nocomma }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>

  format.url.doi output.nocomma

  format.note output.nocomma
  fin.entry
}

<span class="keyword">FUNCTION</span> {<span class="function-name">default.type</span>}
{ misc }

<span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%</span>
<span class="comment">%       &#26376;&#12398;&#30053;&#31216;&#23450;&#32681;</span>

<span class="keyword">MACRO</span> {<span class="function-name">jan</span>} {<span class="string">"January"</span>}
<span class="keyword">MACRO</span> {<span class="function-name">feb</span>} {<span class="string">"February"</span>}
<span class="keyword">MACRO</span> {<span class="function-name">mar</span>} {<span class="string">"March"</span>}
<span class="keyword">MACRO</span> {<span class="function-name">apr</span>} {<span class="string">"April"</span>}
<span class="keyword">MACRO</span> {<span class="function-name">may</span>} {<span class="string">"May"</span>}
<span class="keyword">MACRO</span> {<span class="function-name">jun</span>} {<span class="string">"June"</span>}
<span class="keyword">MACRO</span> {<span class="function-name">jul</span>} {<span class="string">"July"</span>}
<span class="keyword">MACRO</span> {<span class="function-name">aug</span>} {<span class="string">"August"</span>}
<span class="keyword">MACRO</span> {<span class="function-name">sep</span>} {<span class="string">"September"</span>}
<span class="keyword">MACRO</span> {<span class="function-name">oct</span>} {<span class="string">"October"</span>}
<span class="keyword">MACRO</span> {<span class="function-name">nov</span>} {<span class="string">"November"</span>}
<span class="keyword">MACRO</span> {<span class="function-name">dec</span>} {<span class="string">"December"</span>}

<span class="comment">%%% &#12456;&#12531;&#12488;&#12522;&#12434;&#35501;&#12415;&#36796;&#12416;</span>
<span class="keyword">READ</span>

<span class="comment">%%% &#12456;&#12531;&#12488;&#12522;&#12540;&#12364;&#26085;&#26412;&#35486;&#25991;&#29486;&#12363;&#21028;&#26029;&#12377;&#12427;&#12383;&#12417;&#12398;&#38306;&#25968;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">set.is.kanji.entry.author</span>}
{
  <span class="variable-name">author</span>    field.or.null <span class="builtin">is.kanji.str$</span>
  <span class="variable-name">editor</span>    field.or.null <span class="builtin">is.kanji.str$</span> or
  'is.kanji.entry.author <span class="constant">:=</span>
}

<span class="comment">%%% &#12456;&#12531;&#12488;&#12522;&#12540;&#12364;&#26085;&#26412;&#35486;&#25991;&#29486;&#12363;&#21028;&#26029;&#12377;&#12427;&#12383;&#12417;&#12398;&#38306;&#25968; (yomi &#12399;&#38500;&#12367;)</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">set.is.kanji.entry.auto</span>}
{
  <span class="variable-name">author</span>    field.or.null <span class="builtin">is.kanji.str$</span>
  <span class="variable-name">title</span>     field.or.null <span class="builtin">is.kanji.str$</span> or
  <span class="variable-name">editor</span>    field.or.null <span class="builtin">is.kanji.str$</span> or
  <span class="variable-name">journal</span>   field.or.null <span class="builtin">is.kanji.str$</span> or
  <span class="variable-name">booktitle</span> field.or.null <span class="builtin">is.kanji.str$</span> or
  <span class="variable-name">series</span>    field.or.null <span class="builtin">is.kanji.str$</span> or
  'is.kanji.entry <span class="constant">:=</span>
}

<span class="comment">%%% &#12456;&#12531;&#12488;&#12522;&#12540;&#12364;&#26085;&#26412;&#35486;&#25991;&#29486;&#12363;&#21028;&#26029;&#12377;&#12427;&#12383;&#12417;&#12398;&#38306;&#25968;&#12290;language &#12501;&#12451;&#12540;&#12523;&#12489;&#12395;&#12300;ja&#12301;&#12364;&#20837;&#12387;</span>
<span class="comment">%%% &#12390;&#12356;&#12428;&#12400;&#26085;&#26412;&#35486;&#25991;&#29486;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">set.is.kanji.entry.manual</span>}
{ <span class="variable-name">language</span> <span class="builtin">empty$</span>
    { #0 'is.kanji.entry <span class="constant">:=</span> }
    { <span class="variable-name">language</span> <span class="string">"ja"</span> =
      <span class="variable-name">language</span> <span class="string">"&#26085;&#26412;&#35486;"</span> = or
       { #1 'is.kanji.entry <span class="constant">:=</span> }
       { #0 'is.kanji.entry <span class="constant">:=</span> }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">set.is.kanji.entry</span>}
{ set.is.kanji.entry.auto
  bst.use.unicode #0 =
    '<span class="builtin">skip$</span>
    { set.is.kanji.entry.manual }
  <span class="builtin">if$</span>
}

<span class="comment">%%% &#12456;&#12531;&#12488;&#12522;&#12540;&#12364;&#26085;&#26412;&#35486;&#25991;&#29486;&#12363;&#21028;&#26029;&#12377;&#12427;&#12383;&#12417;&#12398;&#38306;&#25968; (yomi &#12418;&#21547;&#12417;&#12390;)</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">set.is.kanji.entry.two</span>}
{
  <span class="variable-name">author</span>    field.or.null <span class="builtin">is.kanji.str$</span>
  <span class="variable-name">title</span>     field.or.null <span class="builtin">is.kanji.str$</span> or
  <span class="variable-name">editor</span>    field.or.null <span class="builtin">is.kanji.str$</span> or
  <span class="variable-name">journal</span>   field.or.null <span class="builtin">is.kanji.str$</span> or
  <span class="variable-name">booktitle</span> field.or.null <span class="builtin">is.kanji.str$</span> or
  <span class="variable-name">series</span>    field.or.null <span class="builtin">is.kanji.str$</span> or
  <span class="variable-name">yomi</span>      field.or.null <span class="builtin">is.kanji.str$</span> or
  'is.kanji.entry.two <span class="constant">:=</span>
}

<span class="comment">%%% &#20840;&#12390;&#12398;&#12456;&#12531;&#12488;&#12522;&#12540;&#12395;&#23550;&#12375;&#23455;&#34892;</span>
<span class="keyword">ITERATE</span> {<span class="function-name">set.is.kanji.entry.author</span>}
<span class="keyword">ITERATE</span> {<span class="function-name">set.is.kanji.entry</span>}
<span class="keyword">ITERATE</span> {<span class="function-name">set.is.kanji.entry.two</span>}

<span class="comment">%%% &#24341;&#29992;&#38918;&#12434;&#20445;&#25345;&#12377;&#12427;&#22793;&#25968;</span>
<span class="keyword">INTEGERS</span> { order.num }
<span class="keyword">FUNCTION</span> {<span class="function-name">initialize.order.num</span>}
{
  #1 'order.num <span class="constant">:=</span>
}
<span class="comment">%%% &#21021;&#26399;&#20516;&#12395;1&#12434;&#35373;&#23450;</span>
<span class="keyword">EXECUTE</span> {<span class="function-name">initialize.order.num</span>}

<span class="comment">%%% &#22793;&#25968; order.cited &#12395;&#12399;&#24341;&#29992;&#38918;&#12398;&#25968;&#20516;&#12364;&#20837;&#12427;&#65294;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">set.order.cited</span>}
{
  order.num 'order.cited <span class="constant">:=</span>
  #1 order.num <span class="constant">+</span> 'order.num <span class="constant">:=</span>
}
<span class="comment">%%% &#20840;&#12390;&#12398;&#12456;&#12531;&#12488;&#12522;&#12540;&#12395;&#23550;&#12375;&#23455;&#34892;</span>
<span class="keyword">ITERATE</span> {<span class="function-name">set.order.cited</span>}
  
<span class="comment">%%% &#35352;&#21495;&#12434;&#38500;&#21435;&#12375;&#12289;&#23567;&#25991;&#23383;&#12395;&#22793;&#25563;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">sortify</span>}
{ <span class="builtin">purify$</span> <span class="string">"l"</span> <span class="builtin">change.case$</span> }

<span class="comment">%%% &#20808;&#38957;&#20309;&#25991;&#23383;&#12363;&#12434;&#38500;&#21435;&#12377;&#12427;&#12290;</span>
<span class="comment">% s &#12398;&#26368;&#21021;&#12363;&#12425; len &#25991;&#23383;&#12434;&#38500;&#21435;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">chop.word</span>}
{ 's <span class="constant">:=</span>
  'len <span class="constant">:=</span>
  s #1 len <span class="builtin">substring$</span> =
    { s len #1 <span class="constant">+</span> <span class="builtin">global.max$</span> <span class="builtin">substring$</span> }
    's
  <span class="builtin">if$</span>
}

<span class="comment">%%% &#12477;&#12540;&#12488;&#29992;&#12395;&#21517;&#21069;&#12434;&#21152;&#24037;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">sort.format.names</span>}
{ 's <span class="constant">:=</span>
  <span class="variable-name">yomi</span> <span class="builtin">empty$</span>
     '<span class="builtin">skip$</span>
     { <span class="variable-name">yomi</span> 's <span class="constant">:=</span> }
  <span class="builtin">if$</span>
  #1 'nameptr <span class="constant">:=</span>
  <span class="string">""</span>
  s <span class="builtin">num.names$</span> 'numnames <span class="constant">:=</span>
  numnames 'namesleft <span class="constant">:=</span>
    { namesleft #0 &gt; }
    { nameptr #1 &gt;
        { <span class="string">", "</span> * }
        '<span class="builtin">skip$</span>
      <span class="builtin">if$</span>
      s check.kanji.str
         { bst.sei.mei.order #0 =
             { s nameptr <span class="string">"{ff }{ll}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
             { s nameptr <span class="string">"{ll }{ff}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
           <span class="builtin">if$</span>
         }
         { s nameptr <span class="string">"{ll}{ ff}{ jj}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
      <span class="builtin">if$</span>
      nameptr #1 =
         { t <span class="string">" 0 "</span> * 't <span class="constant">:=</span> }
         '<span class="builtin">skip$</span>
      <span class="builtin">if$</span>
      nameptr numnames = t <span class="string">"others"</span> = and
        { s check.kanji.str
                { bst.and.others.jp * }
                { bst.and.others * }
          <span class="builtin">if$</span>
        }
        { t sortify * }
      <span class="builtin">if$</span>
      nameptr #1 <span class="constant">+</span> 'nameptr <span class="constant">:=</span>
      namesleft #1 - 'namesleft <span class="constant">:=</span>
    }
  <span class="builtin">while$</span>
}

<span class="comment">%%% &#12477;&#12540;&#12488;&#29992;&#12395;&#21517;&#21069;&#12434;&#21152;&#24037;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">sort.format.names.abb</span>}
{ 's <span class="constant">:=</span>
  <span class="variable-name">yomi</span> <span class="builtin">empty$</span>
     '<span class="builtin">skip$</span>
     { <span class="variable-name">yomi</span> 's <span class="constant">:=</span> }
  <span class="builtin">if$</span>
  s <span class="builtin">num.names$</span> 'numnames <span class="constant">:=</span>
  numnames bst.and.others.num &lt;
     { s sort.format.names }
     { s check.kanji.str
         <span class="comment">% author &#21517;&#12364;&#26085;&#26412;&#35486;&#12434;&#21547;&#12416;&#12465;&#12540;&#12473;</span>
         { bst.sei.mei.order #0 =
             { s #1 <span class="string">"{ff }{ll}"</span> <span class="builtin">format.name$</span> <span class="string">" et al. "</span> * }
             { s #1 <span class="string">"{ll }{ff}"</span> <span class="builtin">format.name$</span> <span class="string">" et al. "</span> * }
           <span class="builtin">if$</span>
         }
         { s #1 <span class="string">"{ll}{ ff}{ jj}"</span> <span class="builtin">format.name$</span> <span class="string">" et al. "</span> * }
       <span class="builtin">if$</span>
     }
  <span class="builtin">if$</span>
}

<span class="comment">%%% Full author name &#12398; label &#12398;&#20316;&#25104;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.lab.names.full</span>}
{ 's <span class="constant">:=</span>
  #1 'nameptr <span class="constant">:=</span>
  s <span class="builtin">num.names$</span> 'numnames <span class="constant">:=</span>
  numnames 'namesleft <span class="constant">:=</span>
    { namesleft #0 &gt; }
      { s check.kanji.str
          <span class="comment">% author &#21517;&#12395;&#26085;&#26412;&#35486;&#21547;&#12416;&#12465;&#12540;&#12473;</span>
          { nameptr 'name.num <span class="constant">:=</span>
            s set.alphabet.in.author
            alphabet.in.author #0 =
              <span class="comment">% first name &#12418;&#26085;&#26412;&#35486;&#65288;&#26085;&#26412;&#20154;&#21517;&#12398;&#12465;&#12540;&#12473;&#65289;</span>
              { s nameptr <span class="string">"{ll}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span>
                t <span class="string">"others"</span> =
                  '<span class="builtin">skip$</span>
                  { bst.sei.mei.order #0 =
                     { s nameptr <span class="string">"{ff}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                     { s nameptr <span class="string">"{ll}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                   <span class="builtin">if$</span>
                  }
                <span class="builtin">if$</span>
                t <span class="builtin">empty$</span>
                  { s #1 <span class="string">"{ll}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                  '<span class="builtin">skip$</span>
                <span class="builtin">if$</span>
              }
              <span class="comment">% first name &#12364; alphabet &#12398;&#12465;&#12540;&#12473;&#65288;&#22806;&#22269;&#20154;&#21517;&#12398;&#12465;&#12540;&#12473;&#65289;</span>
              { s nameptr <span class="string">"{ll}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
            <span class="builtin">if$</span>
            nameptr #1 &gt;
              { namesleft #1 &gt;
                  { bst.cite.and.jp * t * }
                  { t <span class="string">"others"</span> =
                      { bst.and.others.jp * }
                      { bst.cite.and.jp * t * }
                    <span class="builtin">if$</span>
                  }
                <span class="builtin">if$</span>
              }
              't
            <span class="builtin">if$</span>
            nameptr #1 <span class="constant">+</span> 'nameptr <span class="constant">:=</span>
            namesleft #1 - 'namesleft <span class="constant">:=</span>
          }

          <span class="comment">% author &#21517;&#12395;&#26085;&#26412;&#35486;&#21547;&#12414;&#12394;&#12356;&#12465;&#12540;&#12473;</span>
          { s nameptr <span class="string">"{vv~}{ll}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span>
              nameptr #1 &gt;
                { namesleft #1 &gt;
                    { <span class="string">", "</span> * t * }
                    { t <span class="string">"others"</span> =
                        { bst.and.others * }
                        { numnames #2 &gt; 
                           { bst.cite.ands * t * }
                           { bst.cite.and * t * }
                          <span class="builtin">if$</span>
                        }
                      <span class="builtin">if$</span>
                    }
                  <span class="builtin">if$</span>
                }
                't
              <span class="builtin">if$</span>
              nameptr #1 <span class="constant">+</span> 'nameptr <span class="constant">:=</span>
              namesleft #1 - 'namesleft <span class="constant">:=</span>
          }
        <span class="builtin">if$</span>
      }
    <span class="builtin">while$</span>
    numnames #1 &gt; #1 #2 = and {<span class="string">", eds"</span> *} {} <span class="builtin">if$</span>
    numnames #1 = #1 #2 = and {<span class="string">", ed"</span> *} {} <span class="builtin">if$</span>
}

<span class="comment">%%% author name &#12398; label &#12398;&#20316;&#25104; (abbreviated name).</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">format.lab.names.abb</span>}
{ 's <span class="constant">:=</span>
   s <span class="builtin">num.names$</span> 'numnames <span class="constant">:=</span>
   numnames bst.and.others.num &lt;
     <span class="comment">% author &#25968;&#12364; bst.and.others.num &#12424;&#12426;&#23567;&#12373;&#12356;&#12394;&#12425; full &#12391;&#34920;&#31034;&#12290;</span>
     { s format.lab.names.full }
     <span class="comment">% author &#25968;&#12364; bst.and.others.num &#20197;&#19978;&#12394;&#12425; 1st author &#12398;&#12415;&#34920;&#31034;&#12290;&#12354;&#12392;&#12399;&#30053;&#12290;</span>
     { s check.kanji.str
         <span class="comment">% author &#21517;&#12364;&#26085;&#26412;&#35486;&#12434;&#21547;&#12416;&#12465;&#12540;&#12473;</span>
         { #1 'name.num <span class="constant">:=</span>
           s set.alphabet.in.author
           alphabet.in.author #0 =
            <span class="comment">% first name &#12418;&#26085;&#26412;&#35486;&#12398;&#12465;&#12540;&#12473;&#65288;&#26085;&#26412;&#20154;&#21517;&#12398;&#12465;&#12540;&#12473;&#65289;</span>
            
            <span class="comment">% &#27880;&#65306;&#26085;&#26412;&#35486;&#12398; author &#12399; "&#22995; &#21517;" &#12398;&#38918;&#12391;&#25351;&#23450;&#12373;&#12428;&#12427;&#12364;&#12289;bst &#12391;&#12399;</span>
            <span class="comment">% &#38918;&#30058;&#36890;&#12426;&#12395;&#22995;&#65309;first name&#12289;&#21517;&#65309;last name &#12392;&#12375;&#12390;&#25201;&#12431;&#12428;&#12427;&#12290;</span>
            { bst.sei.mei.order #0 =
                { s #1 <span class="string">"{ff}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                { s #1 <span class="string">"{ll}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
              <span class="builtin">if$</span>
              t <span class="builtin">empty$</span>
                { s #1 <span class="string">"{ll}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> }
                '<span class="builtin">skip$</span>
              <span class="builtin">if$</span>
              t bst.and.others.jp * }

            <span class="comment">% first name &#12364; alphabet &#12398;&#12465;&#12540;&#12473;&#65288;&#22806;&#22269;&#20154;&#21517;&#12398;&#12465;&#12540;&#12473;&#65289;</span>
            { s #1 <span class="string">"{ll}"</span> <span class="builtin">format.name$</span> 't <span class="constant">:=</span> 
              t bst.and.others.jp * }
          <span class="builtin">if$</span>
         }
         <span class="comment">% author&#21517;&#12364;&#12450;&#12523;&#12501;&#12449;&#12505;&#12483;&#12488;&#12398;&#12465;&#12540;&#12473;</span>
         { s #1 <span class="string">"{ll}"</span> <span class="builtin">format.name$</span> bst.and.others * }
       <span class="builtin">if$</span>
     }
   <span class="builtin">if$</span>
}

<span class="comment">%%% &#12371;&#12428;&#12399; abbreviated author &#21517;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">author.key.label.abb</span>}
{ <span class="variable-name">author</span> <span class="builtin">empty$</span>
    { <span class="variable-name">key</span> <span class="builtin">empty$</span>
        { <span class="builtin">cite$</span> #1 #3 <span class="builtin">substring$</span> }
        { <span class="variable-name">key</span> #3 <span class="builtin">text.prefix$</span> }
      <span class="builtin">if$</span>
    }
    { <span class="variable-name">author</span> format.lab.names.abb }
  <span class="builtin">if$</span>
}

<span class="comment">%%% &#12371;&#12428;&#12399; full author &#21517;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">author.key.label.full</span>}
{ <span class="variable-name">author</span> <span class="builtin">empty$</span>
    { <span class="variable-name">key</span> <span class="builtin">empty$</span>
        { <span class="builtin">cite$</span> #1 #3 <span class="builtin">substring$</span> }
        { <span class="variable-name">key</span> #3 <span class="builtin">text.prefix$</span> }
      <span class="builtin">if$</span>
    }
    { <span class="variable-name">author</span> format.lab.names.full }
  <span class="builtin">if$</span>
}

<span class="comment">%%% &#12371;&#12428;&#12399; sort &#29992;&#12398; author &#21517;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">author.key.label.sort</span>}
{ <span class="variable-name">author</span> <span class="builtin">empty$</span>
    { <span class="variable-name">key</span> <span class="builtin">empty$</span>
        { <span class="builtin">cite$</span> #1 #3 <span class="builtin">substring$</span> }
        { <span class="variable-name">key</span> #3 <span class="builtin">text.prefix$</span> }
      <span class="builtin">if$</span>
    }
    { <span class="variable-name">author</span> sort.format.names }
  <span class="builtin">if$</span>
}

<span class="comment">%%% &#12371;&#12428;&#12399; sort &#29992;&#12398;&#21517;&#21069;&#12434;&#20316;&#25104;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">author.editor.key.label.sort</span>}
{ <span class="variable-name">author</span> <span class="builtin">empty$</span>
    { <span class="variable-name">editor</span> <span class="builtin">empty$</span>
        { <span class="variable-name">key</span> <span class="builtin">empty$</span>
            { <span class="builtin">cite$</span> #1 #3 <span class="builtin">substring$</span> }
            { <span class="variable-name">key</span> #3 <span class="builtin">text.prefix$</span> }
          <span class="builtin">if$</span>
        }
        { <span class="variable-name">yomi</span> <span class="builtin">empty$</span>
           { <span class="variable-name">editor</span> sort.format.names }
           { bst.mixed.order #0 = 
              { <span class="variable-name">editor</span> sort.format.names }
              { <span class="variable-name">yomi</span> sort.format.names }
        <span class="builtin">if$</span>
          }
          <span class="builtin">if$</span>
        }
      <span class="builtin">if$</span>
    }
    { <span class="variable-name">yomi</span> <span class="builtin">empty$</span>
       { <span class="variable-name">author</span> sort.format.names }
       { bst.mixed.order #0 = 
          { <span class="variable-name">author</span> sort.format.names }
          { <span class="variable-name">yomi</span> sort.format.names }
        <span class="builtin">if$</span>
      }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% &#12371;&#12428;&#12399; abbreviated author &#21517;&#12434;&#20316;&#25104;&#12377;&#12427;&#38306;&#25968;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">author.editor.key.label.abb</span>}
{ <span class="variable-name">author</span> <span class="builtin">empty$</span>
    { <span class="variable-name">editor</span> <span class="builtin">empty$</span>
        { <span class="variable-name">key</span> <span class="builtin">empty$</span>
            { <span class="builtin">cite$</span> #1 #3 <span class="builtin">substring$</span> }
            { <span class="variable-name">key</span> #3 <span class="builtin">text.prefix$</span> }
          <span class="builtin">if$</span>
        }
        { <span class="variable-name">editor</span> format.lab.names.abb }
      <span class="builtin">if$</span>
    }
    { <span class="variable-name">author</span> format.lab.names.abb }
  <span class="builtin">if$</span>
}

<span class="comment">%%% &#12371;&#12428;&#12399; full author &#21517;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">author.editor.key.label.full</span>}
{ <span class="variable-name">author</span> <span class="builtin">empty$</span>
    { <span class="variable-name">editor</span> <span class="builtin">empty$</span>
        { <span class="variable-name">key</span> <span class="builtin">empty$</span>
            { <span class="builtin">cite$</span> #1 #3 <span class="builtin">substring$</span> }
            { <span class="variable-name">key</span> #3 <span class="builtin">text.prefix$</span> }
          <span class="builtin">if$</span>
        }
        { <span class="variable-name">editor</span> format.lab.names.full }
      <span class="builtin">if$</span>
    }
    { <span class="variable-name">author</span> format.lab.names.full }
  <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">author.key.organization.label.full</span>}
{ <span class="variable-name">author</span> <span class="builtin">empty$</span>
    { <span class="variable-name">key</span> <span class="builtin">empty$</span>
        { <span class="variable-name">organization</span> <span class="builtin">empty$</span>
            { <span class="builtin">cite$</span> #1 #3 <span class="builtin">substring$</span> }
            { <span class="string">"The "</span> #4 <span class="variable-name">organization</span> chop.word #3 <span class="builtin">text.prefix$</span> }
          <span class="builtin">if$</span>
        }
        { <span class="variable-name">key</span> #3 <span class="builtin">text.prefix$</span> }
      <span class="builtin">if$</span>
    }
    { <span class="variable-name">author</span> format.lab.names.full }
  <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">author.key.organization.label.abb</span>}
{ <span class="variable-name">author</span> <span class="builtin">empty$</span>
    { <span class="variable-name">key</span> <span class="builtin">empty$</span>
        { <span class="variable-name">organization</span> <span class="builtin">empty$</span>
            { <span class="builtin">cite$</span> #1 #3 <span class="builtin">substring$</span> }
            { <span class="string">"The "</span> #4 <span class="variable-name">organization</span> chop.word #3 <span class="builtin">text.prefix$</span> }
          <span class="builtin">if$</span>
        }
        { <span class="variable-name">key</span> #3 <span class="builtin">text.prefix$</span> }
      <span class="builtin">if$</span>
    }
    { <span class="variable-name">author</span> format.lab.names.abb }
  <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">editor.key.organization.label.full</span>}
{ <span class="variable-name">editor</span> <span class="builtin">empty$</span>
    { <span class="variable-name">key</span> <span class="builtin">empty$</span>
        { <span class="variable-name">organization</span> <span class="builtin">empty$</span>
            { <span class="builtin">cite$</span> #1 #3 <span class="builtin">substring$</span> }
            { <span class="string">"The "</span> #4 <span class="variable-name">organization</span> chop.word #3 <span class="builtin">text.prefix$</span> }
          <span class="builtin">if$</span>
        }
        { <span class="variable-name">key</span> #3 <span class="builtin">text.prefix$</span> }
      <span class="builtin">if$</span>
    }
    { <span class="variable-name">editor</span> format.lab.names.full }
  <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">editor.key.organization.label.abb</span>}
{ <span class="variable-name">editor</span> <span class="builtin">empty$</span>
    { <span class="variable-name">key</span> <span class="builtin">empty$</span>
        { <span class="variable-name">organization</span> <span class="builtin">empty$</span>
            { <span class="builtin">cite$</span> #1 #3 <span class="builtin">substring$</span> }
            { <span class="string">"The "</span> #4 <span class="variable-name">organization</span> chop.word #3 <span class="builtin">text.prefix$</span> }
          <span class="builtin">if$</span>
        }
        { <span class="variable-name">key</span> #3 <span class="builtin">text.prefix$</span> }
      <span class="builtin">if$</span>
    }
    { <span class="variable-name">editor</span> format.lab.names.abb }
  <span class="builtin">if$</span>
}

<span class="comment">%%% &#19982;&#12360;&#12425;&#12428;&#12383;&#25968;&#12434;&#22793;&#25563;: 0-&gt;9, 1-&gt;8, 2-&gt;7,..., 9-&gt;0 &#12392;&#12356;&#12358;&#23550;&#24540;&#38306;&#20418;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">reverse.num</span>}
{ 's <span class="constant">:=</span>
  s <span class="string">"1"</span> =
    { <span class="string">"8"</span> 'year.num <span class="constant">:=</span> }
    { s <span class="string">"2"</span> =
        { <span class="string">"7"</span> 'year.num <span class="constant">:=</span> }
        { s <span class="string">"3"</span> =
            { <span class="string">"6"</span> 'year.num <span class="constant">:=</span> }
            { s <span class="string">"4"</span> =
                { <span class="string">"5"</span> 'year.num <span class="constant">:=</span> }
                { s <span class="string">"5"</span> =
                    { <span class="string">"4"</span> 'year.num <span class="constant">:=</span> }
                    { s <span class="string">"6"</span> =
                        { <span class="string">"3"</span> 'year.num <span class="constant">:=</span> }
                        { s <span class="string">"7"</span> =
                            { <span class="string">"2"</span> 'year.num <span class="constant">:=</span> }
                            { s <span class="string">"8"</span> =
                                { <span class="string">"1"</span> 'year.num <span class="constant">:=</span> }
                                { s <span class="string">"9"</span> =
                                    { <span class="string">"0"</span> 'year.num <span class="constant">:=</span> }
                                    { s <span class="string">"0"</span> =
                                        { <span class="string">"9"</span> 'year.num <span class="constant">:=</span> }
                                        { <span class="string">"9"</span> 'year.num <span class="constant">:=</span> }
                                    <span class="builtin">if$</span>
                                    }
                                <span class="builtin">if$</span>
                                }
                            <span class="builtin">if$</span>
                            }
                        <span class="builtin">if$</span>
                        }
                    <span class="builtin">if$</span>
                    }
                <span class="builtin">if$</span>
                }
            <span class="builtin">if$</span>
            }
        <span class="builtin">if$</span>
        }
    <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
  year.num
}

<span class="comment">%%% year &#12434;&#22793;&#25563; (&#22823;&#12365;&#12356;&#25968;&#23383; -&gt; &#23567;&#12373;&#12356;&#25968;&#23383;)</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">convert.year</span>}
{ 't <span class="constant">:=</span> 
  bst.reverse.year #0 =
    <span class="comment">% &#26222;&#36890;&#12398; year &#12398;&#20006;&#12403;&#38918;</span>
    { t 'tt <span class="constant">:=</span> }
    <span class="comment">% year &#12398;&#20006;&#12403;&#38918;&#12434;&#12402;&#12387;&#12367;&#12426;&#36820;&#12377;&#12465;&#12540;&#12473; (&#26032;&#12375;&#12356;&#12411;&#12393;&#20808;&#12395;&#34920;&#31034;&#12377;&#12427;&#12465;&#12540;&#12473;)&#12290;</span>
    { t #1 #1 <span class="builtin">substring$</span> reverse.num 
      t #2 #1 <span class="builtin">substring$</span> reverse.num *
      t #3 #1 <span class="builtin">substring$</span> reverse.num *
      t #4 #1 <span class="builtin">substring$</span> reverse.num * 'tt <span class="constant">:=</span> }
  <span class="builtin">if$</span>
  tt
}

<span class="comment">%%% cyear &#12434;&#35336;&#31639;&#65294; cyear &#12399;&#24341;&#29992;&#37096;&#20998;&#12391;&#34920;&#31034;&#12373;&#12428;&#12427;&#24180;&#12434;&#20445;&#25345;&#12377;&#12427;&#22793;&#25968;&#65294;reference &#37096;</span>
<span class="comment">%%% &#20998;&#12398;&#34920;&#31034;&#12395;&#12399;&#38306;&#20418;&#12394;&#12356;&#65294;&#12414;&#12383;&#21516;&#26178;&#12395;&#12371;&#12371;&#12391; sort.label &#12434;&#35336;&#31639;&#12375;&#12390;&#12356;&#12427;&#65294;</span>
<span class="comment">%%% sort.label &#12399;&#25991;&#29486;&#12398; sort &#12398;&#12383;&#12417;&#12395;&#21033;&#29992;&#12373;&#12428;&#12427; author (editor) &#21517;&#12434;&#20445;&#25345;&#12377;&#12427;&#22793;</span>
<span class="comment">%%% &#25968;&#65294;yomi field &#12364;&#12354;&#12427;&#22580;&#21512;&#12395;&#12399;&#32080;&#23616; sort.label &#12398;&#20013;&#36523;&#12399;&#20351;&#12431;&#12428;&#12394;&#12356;&#65294;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">calc.cyear</span>}
{ <span class="builtin">type$</span> <span class="string">"book"</span> =
  <span class="builtin">type$</span> <span class="string">"inbook"</span> =
  or
    'author.editor.key.label.sort
    { <span class="builtin">type$</span> <span class="string">"proceedings"</span> =
        'editor.key.organization.label.full
        { <span class="builtin">type$</span> <span class="string">"manual"</span> =
            'author.key.organization.label.full
            'author.key.label.sort
          <span class="builtin">if$</span>
        }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
  <span class="builtin">duplicate$</span>
  <span class="variable-name">year</span> 'cyear <span class="constant">:=</span>
  <span class="string">" "</span> <span class="variable-name">year</span> convert.year * field.or.null *
  sortify 'sort.label <span class="constant">:=</span>
  <span class="comment">% For debug</span>
  jecon.debug #0 = not
    { <span class="string">"sort.label = ``\texttt{"</span> <span class="builtin">write$</span>
      sort.label <span class="builtin">write$</span>
      <span class="string">"}''\\"</span> <span class="builtin">write$</span>
      <span class="builtin">newline$</span>
    }
    '<span class="builtin">skip$</span>
 <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">calc.sort.label.abb</span>}
{ <span class="variable-name">yomi</span> <span class="builtin">empty$</span>
    { <span class="variable-name">author</span> <span class="builtin">empty$</span>
        { <span class="variable-name">editor</span> <span class="builtin">empty$</span>
           { <span class="string">""</span> }
           { <span class="variable-name">editor</span> 's <span class="constant">:=</span> }
          <span class="builtin">if$</span>
        }
        { <span class="variable-name">author</span> 's <span class="constant">:=</span> }
      <span class="builtin">if$</span>
    }
    { <span class="variable-name">yomi</span> 's <span class="constant">:=</span> }
  <span class="builtin">if$</span>
  s sort.format.names.abb 't <span class="constant">:=</span> 
  t sortify <span class="string">" "</span> * <span class="variable-name">year</span> convert.year * 'sort.label.abb <span class="constant">:=</span>
  jecon.debug #0 = not
    { <span class="string">"sort.label.abb = ``\texttt{"</span> <span class="builtin">write$</span>
      sort.label.abb <span class="builtin">write$</span>
      <span class="string">"}''\\"</span> <span class="builtin">write$</span>
      <span class="builtin">newline$</span>
    }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
}

<span class="comment">%%% flabel &#12434;&#35336;&#31639;&#65294;flabel &#12399;&#24341;&#29992;&#37096;&#20998;&#12398;&#33879;&#32773;&#21517;&#12434;&#20445;&#25345;&#12377;&#12427;&#22793;&#25968;&#65294;reference &#37096;&#20998;&#12395;&#12399;</span>
<span class="comment">%%% &#38306;&#20418;&#12394;&#12356;&#65294;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">calc.flabel</span>}
{ <span class="builtin">type$</span> <span class="string">"book"</span> =
  <span class="builtin">type$</span> <span class="string">"inbook"</span> =
  or
    'author.editor.key.label.full
    { <span class="builtin">type$</span> <span class="string">"proceedings"</span> =
        'editor.key.organization.label.full
        { <span class="builtin">type$</span> <span class="string">"manual"</span> =
            'author.key.organization.label.full
            'author.key.label.full
          <span class="builtin">if$</span>
        }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
  'flabel <span class="constant">:=</span>
  <span class="comment">% For debug</span>
  jecon.debug #0 = not
    { <span class="string">"flabel = ``\texttt{"</span> <span class="builtin">write$</span>
      flabel <span class="builtin">write$</span>
      <span class="string">"}''\\"</span> <span class="builtin">write$</span>
      <span class="builtin">newline$</span>
    }
    '<span class="builtin">skip$</span>
 <span class="builtin">if$</span>
}

<span class="comment">%%% alabel &#12434;&#35336;&#31639;&#65294;alabel &#12399;&#24341;&#29992;&#37096;&#20998;&#12398;&#33879;&#32773;&#21517; (&#30701;&#32302;&#24418;&#34920;&#31034;) &#12434;&#20445;&#25345;&#12377;&#12427;&#22793;&#25968;&#65294;</span>
<span class="comment">%%% reference &#37096;&#20998;&#12399;&#38306;&#20418;&#12394;&#12356;&#65294;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">calc.alabel</span>}
{ <span class="builtin">type$</span> <span class="string">"book"</span> =
  <span class="builtin">type$</span> <span class="string">"inbook"</span> =
  or
    'author.editor.key.label.abb
    { <span class="builtin">type$</span> <span class="string">"proceedings"</span> =
        'editor.key.organization.label.abb
        { <span class="builtin">type$</span> <span class="string">"manual"</span> =
            'author.key.organization.label.abb
            'author.key.label.abb
          <span class="builtin">if$</span>
        }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
  'alabel <span class="constant">:=</span>
  <span class="comment">% For debug</span>
  jecon.debug #0 = not
    { <span class="string">"alabel = ``\texttt{"</span> <span class="builtin">write$</span>
      alabel <span class="builtin">write$</span>
      <span class="string">"}''\\"</span> <span class="builtin">write$</span>
      <span class="builtin">newline$</span>
    }
    '<span class="builtin">skip$</span>
 <span class="builtin">if$</span>
}

<span class="comment">%%% &#12477;&#12540;&#12488;&#29992;&#12395; title &#12434;&#21152;&#24037;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">sort.format.title</span>}
{ 't <span class="constant">:=</span>
  <span class="string">"A "</span> #2
    <span class="string">"An "</span> #3
      <span class="string">"The "</span> #4 t chop.word
    chop.word
  chop.word
  sortify
  #1 <span class="builtin">global.max$</span> <span class="builtin">substring$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">author.organization.sort</span>}
{ <span class="variable-name">author</span> <span class="builtin">empty$</span>
    { <span class="variable-name">organization</span> <span class="builtin">empty$</span>
        { <span class="variable-name">key</span> <span class="builtin">empty$</span>
            { <span class="string">"to sort, need author, organization, or key in "</span> <span class="builtin">cite$</span> * <span class="builtin">warning$</span>
              <span class="string">""</span>
            }
            { <span class="variable-name">key</span> sortify }
          <span class="builtin">if$</span>
        }
        { <span class="string">"The "</span> #4 <span class="variable-name">organization</span> chop.word sortify }
      <span class="builtin">if$</span>
    }
    { <span class="variable-name">author</span> sort.format.names }
  <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">editor.organization.sort</span>}
{ <span class="variable-name">editor</span> <span class="builtin">empty$</span>
    { <span class="variable-name">organization</span> <span class="builtin">empty$</span>
        { <span class="variable-name">key</span> <span class="builtin">empty$</span>
            { <span class="string">"to sort, need editor, organization, or key in "</span> <span class="builtin">cite$</span> * <span class="builtin">warning$</span>
              <span class="string">""</span>
            }
            { <span class="variable-name">key</span> sortify }
          <span class="builtin">if$</span>
        }
        { <span class="string">"The "</span> #4 <span class="variable-name">organization</span> chop.word sortify }
      <span class="builtin">if$</span>
    }
    { <span class="variable-name">editor</span> sort.format.names }
  <span class="builtin">if$</span>
}

<span class="comment">%%% &#25968;&#23383;&#12364;&#19968;&#25991;&#23383; (&#12388;&#12414;&#12426;, 1,...,9&#31561;) &#12394;&#12425;&#12381;&#12398;&#21069;&#12395; 00 &#12434;&#65292;&#25968;&#23383;&#12364;&#20108;&#25991;&#23383;</span>
<span class="comment">%%% (10,...,99) &#12394;&#12425; 0 &#12434;&#20184;&#12369;&#12427;&#65294;10, 11, 12 &#12398;&#25351;&#23450;&#12364; 2, 3, 4,... &#12424;&#12426;&#12418;&#20778;&#20808;&#12373;</span>
<span class="comment">%%% &#12428;&#12427;&#12398;&#12434;&#38450;&#12368;&#12383;&#12417;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">add.zero.to.number</span>}
{ 's <span class="constant">:=</span>
    s <span class="builtin">text.length$</span> #1 =
      { <span class="string">"00"</span> s * }
      { s <span class="builtin">text.length$</span> #2 =
          { <span class="string">"0"</span> s * }
          { s }
        <span class="builtin">if$</span>
      }
   <span class="builtin">if$</span>
}

<span class="comment">%% entry type &#12395;&#25968;&#20516;&#12434;&#21106;&#24403;&#12390;&#12427;&#65294;&#25968;&#20516;&#12364;&#23567;&#12373;&#12356;&#12411;&#12358;&#12364; bst.sort.entry.type &#12364;&#38750;&#12476;</span>
<span class="comment">%% &#12525;&#12398;&#12392;&#12365;&#12395;&#20808;&#12395;&#21015;&#25369;&#12373;&#12428;&#12427;&#12371;&#12392;&#12395;&#12394;&#12427;&#65294;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">bst.sort.entry.type.order</span>}
{ 'item.type <span class="constant">:=</span>
  item.type <span class="string">"article"</span> =
     { <span class="string">"01"</span> }
     { item.type <span class="string">"book"</span> =
         { <span class="string">"02"</span> }
         { item.type <span class="string">"booklet"</span> =
             { <span class="string">"03"</span> }
             { item.type <span class="string">"comment"</span> =
                 { <span class="string">"04"</span> }
                 { item.type <span class="string">"conference"</span> =
                     { <span class="string">"05"</span> }
                     { item.type <span class="string">"inbook"</span> =
                         { <span class="string">"06"</span> }
                         { item.type <span class="string">"incollection"</span> =
                             { <span class="string">"07"</span> }
                             { item.type <span class="string">"inproceedings"</span> =
                                 { <span class="string">"08"</span> }
                                 { item.type <span class="string">"manual"</span> =
                                     { <span class="string">"09"</span> }
                                     { item.type <span class="string">"masterthesis"</span> =
                                         { <span class="string">"10"</span> }
                                         { item.type <span class="string">"misc"</span> =
                                             { <span class="string">"11"</span> }
                                             { item.type <span class="string">"phdthesis"</span> =
                                                 { <span class="string">"12"</span> }
                                                 { item.type <span class="string">"proceedings"</span> =
                                                     { <span class="string">"13"</span> }
                                                     { item.type <span class="string">"techreport"</span> =
                                                         { <span class="string">"14"</span> }
                                                         { item.type <span class="string">"unpublished"</span> =
                                                             { <span class="string">"15"</span> }
                                                             { <span class="string">"16"</span> }
                                                           <span class="builtin">if$</span>
                                                         }
                                                       <span class="builtin">if$</span>
                                                     }
                                                   <span class="builtin">if$</span>
                                                 }
                                               <span class="builtin">if$</span>
                                             }
                                           <span class="builtin">if$</span>
                                         }
                                       <span class="builtin">if$</span>
                                     }
                                 <span class="builtin">if$</span>
                                 }
                             <span class="builtin">if$</span>
                             }
                         <span class="builtin">if$</span>
                         }
                     <span class="builtin">if$</span>
                     }
                 <span class="builtin">if$</span>
                 }
             <span class="builtin">if$</span>
             }
         <span class="builtin">if$</span>
         }
     <span class="builtin">if$</span>
     }
  <span class="builtin">if$</span>
}

<span class="comment">%%% &#12414;&#12378;&#12289;author -&gt; year -&gt; absorder -&gt; order -&gt; month -&gt; title &#12391; sort.key$ &#12434;</span>
<span class="comment">%%% &#20316;&#25104;&#12377;&#12427;&#12290;&#19968;&#22238;&#30446;&#12398;&#12477;&#12540;&#12488;&#12391;&#21033;&#29992;&#12377;&#12427;&#65294;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">presort.one</span>}
{ calc.cyear
  <span class="builtin">pop$</span>
  <span class="string">""</span>
  sort.label.abb *
  <span class="string">" "</span>
  bst.no.sort #0 = not
    { * order.cited <span class="builtin">int.to.str$</span> add.zero.to.number * <span class="string">" "</span> * }
    { * <span class="string">" "</span> * }
  <span class="builtin">if$</span>
  is.kanji.entry
    { bst.mixed.order #0 =
       { <span class="string">""</span> }
       { <span class="string">" "</span> }
     <span class="builtin">if$</span>
    }
    { <span class="string">" "</span> }
  <span class="builtin">if$</span>
  <span class="string">""</span> *
  bst.sort.entry.type #0 = not
    { <span class="builtin">type$</span> bst.sort.entry.type.order * <span class="string">" "</span> * }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
  <span class="variable-name">absorder</span> <span class="builtin">empty$</span>
    <span class="comment">% absorder &#12364; empty &#12398;&#12392;&#12365;&#12399; 0 &#12398;&#12392;&#12365;&#12392;&#19968;&#32210; /// (&#12371;&#12428;&#12399;&#25968;&#23383;&#12424;&#12426;&#12399;&#21069;)</span>
    { <span class="string">"/// "</span> * }
    { bst.notuse.absorder.field #0 =
       { <span class="variable-name">absorder</span> <span class="string">"999"</span> =
          <span class="comment">% 999 &#12398;&#12392;&#12365;&#12399; zz </span>
          { <span class="string">"zzz "</span> * }
          { <span class="variable-name">absorder</span> add.zero.to.number <span class="string">"000"</span> =
             <span class="comment">% 000 &#12398;&#12392;&#12365;&#12399; /// (&#12371;&#12428;&#12399;&#25968;&#23383;&#12424;&#12426;&#12399;&#21069;)</span>
             { <span class="string">"/// "</span> * }
             { <span class="variable-name">absorder</span> add.zero.to.number * <span class="string">" "</span> * }
            <span class="builtin">if$</span>
          }
         <span class="builtin">if$</span>
       }
       <span class="comment">% absorder field &#12434;&#21442;&#29031;&#12375;&#12394;&#12356;&#22580;&#21512;&#12399; ///</span>
       { <span class="string">"/// "</span> * }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
  <span class="string">" "</span> *
  <span class="variable-name">order</span> <span class="builtin">empty$</span>
    <span class="comment">% order &#12364; empty &#12398;&#12392;&#12365;&#12399; 0 &#12398;&#12392;&#12365;&#12392;&#19968;&#32210;&#12391; /// (&#12371;&#12428;&#12399;&#25968;&#23383;&#12424;&#12426;&#12399;&#21069;)</span>
    { <span class="string">"/// "</span> * }
    { bst.notuse.order.field #0 =
       { <span class="variable-name">order</span> <span class="string">"999"</span> =
          <span class="comment">% 999 &#12398;&#12392;&#12365;&#12399; zz </span>
          { <span class="string">"zzz "</span> * }
          { <span class="variable-name">order</span> add.zero.to.number <span class="string">"000"</span> =
             <span class="comment">% 000 &#12398;&#12392;&#12365;&#12399; /// (&#12371;&#12428;&#12399;&#25968;&#23383;&#12424;&#12426;&#12399;&#21069;)</span>
             { <span class="string">"/// "</span> * }
             { <span class="variable-name">order</span> add.zero.to.number * <span class="string">" "</span> * }
            <span class="builtin">if$</span>
          }
         <span class="builtin">if$</span>
       }
       <span class="comment">% order field &#12434;&#21442;&#29031;&#12375;&#12394;&#12356;&#22580;&#21512;&#12399; ///</span>
       { <span class="string">"/// "</span> * }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
  <span class="variable-name">month</span> <span class="builtin">empty$</span>
    <span class="comment">% month &#12364; empty &#12398;&#12392;&#12365;&#12399; 0 &#12398;&#12392;&#12365;&#12392;&#19968;&#32210;&#12391; /// (&#12371;&#12428;&#12399;&#25968;&#23383;&#12424;&#12426;&#12399;&#21069;)</span>
    { * <span class="string">"/// "</span> * }
       { <span class="variable-name">month</span> <span class="string">"999"</span> =
          <span class="comment">% 999 &#12398;&#12392;&#12365;&#12399; zz </span>
          { * <span class="variable-name">month</span> add.zero.to.number * <span class="string">"zzz "</span> * }
          { <span class="variable-name">month</span> add.zero.to.number <span class="string">"000"</span> =
             <span class="comment">% 000 &#12398;&#12392;&#12365;&#12399; /// (&#12371;&#12428;&#12399;&#25968;&#23383;&#12424;&#12426;&#12399;&#21069;)</span>
             { * <span class="variable-name">month</span> add.zero.to.number * <span class="string">"/// "</span> * }
             { * <span class="variable-name">month</span> add.zero.to.number * <span class="string">" "</span> * }
            <span class="builtin">if$</span>
          }
         <span class="builtin">if$</span>
       }
  <span class="builtin">if$</span>
  <span class="variable-name">title</span> field.or.null sort.format.title
  *
  #1 <span class="builtin">entry.max$</span> <span class="builtin">substring$</span>
  '<span class="builtin">sort.key$</span> <span class="constant">:=</span>
  <span class="comment">% For debug&#65294;&#12487;&#12496;&#12483;&#12464;&#12377;&#12427;&#12392;&#12365;&#12395;&#12399;&#12371;&#12398;&#38306;&#25968;&#12391;&#20316;&#25104;&#12373;&#12428;&#12427; sort.key$&#12398;&#20013;&#36523;&#12434;&#20986;&#21147;</span>
  <span class="comment">% &#12377;&#12427;&#65294;</span>
  jecon.debug #0 = not
    { <span class="string">"\verb|sort.key$| = ``\texttt{"</span> <span class="builtin">write$</span>
      <span class="builtin">sort.key$</span> <span class="builtin">write$</span>
      <span class="string">"}''\\"</span> <span class="builtin">write$</span>
      <span class="builtin">newline$</span>
    }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
}

<span class="comment">%%% &#12371;&#12428;&#12399; absorder -&gt; author -&gt; year -&gt; order -&gt; month -&gt; title &#12391; sort.key$ &#12434;</span>
<span class="comment">%%% &#20316;&#25104;&#12377;&#12427;&#12290;&#26368;&#32066;&#30340;&#12394;&#20006;&#12409;&#26367;&#12360;&#12399;&#12371;&#12385;&#12425;&#12391;&#25351;&#23450;&#12377;&#12427; sort.key$ &#12391;&#12362;&#12371;&#12394;&#12358;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">presort.two</span>}
{ bst.no.sort #0 = not
    <span class="comment">%% &#20006;&#12409;&#26367;&#12360;&#12375;&#12394;&#12356;(&#24341;&#29992;&#38918;&#12391;&#12381;&#12398;&#12414;&#12414;&#20006;&#12409;&#12427;)&#12465;&#12540;&#12473;&#12398;&#12383;&#12417;&#12398;&#35373;&#23450;&#65294;</span>
    { order.cited <span class="builtin">int.to.str$</span> add.zero.to.number <span class="string">" "</span> * }
    { <span class="string">""</span> }
  <span class="builtin">if$</span>
  bst.sort.year #0 = not
    <span class="comment">%% year &#12434;&#12461;&#12540;&#12392;&#12375;&#12390;&#20006;&#12409;&#12427;&#12383;&#12417;&#12398;&#35373;&#23450;&#65294;</span>
    { is.kanji.entry.two
        <span class="comment">%% &#26085;&#26412;&#35486;&#25991;&#29486;</span>
        { <span class="variable-name">year</span> convert.year * }
        <span class="comment">%% &#33521;&#35486;&#25991;&#29486;</span>
        { <span class="variable-name">year</span> convert.year * }
      <span class="builtin">if$</span>
    }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
  bst.sort.entry.type #0 = not
    <span class="comment">%% &#12456;&#12531;&#12488;&#12522;&#12540;&#12398;&#12479;&#12452;&#12503;&#21029;&#12395;&#20998;&#12369;&#12390;&#20006;&#12409;&#12427;&#12383;&#12417;&#12398;&#35373;&#23450;&#65294;</span>
    { <span class="builtin">type$</span> bst.sort.entry.type.order * <span class="string">" "</span> * }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
  <span class="variable-name">absorder</span> <span class="builtin">empty$</span>
    <span class="comment">% absorder &#12364; empty &#12398;&#12392;&#12365;&#12399; 0 &#12398;&#12392;&#12365;&#12392;&#19968;&#32210; /// (&#12371;&#12428;&#12399;&#25968;&#23383;&#12424;&#12426;&#12399;&#21069;)</span>
    { <span class="string">"/// "</span> * }
    { bst.notuse.absorder.field #0 =
       { <span class="variable-name">absorder</span> <span class="string">"999"</span> =
          <span class="comment">% 999 &#12398;&#12392;&#12365;&#12399; zz </span>
          { <span class="string">"zzz "</span> * }
          { <span class="variable-name">absorder</span> add.zero.to.number <span class="string">"000"</span> =
             <span class="comment">% 000 &#12398;&#12392;&#12365;&#12399; /// (&#12371;&#12428;&#12399;&#25968;&#23383;&#12424;&#12426;&#12399;&#21069;)</span>
             { <span class="string">"/// "</span> * }
             { <span class="variable-name">absorder</span> add.zero.to.number * <span class="string">" "</span> * }
            <span class="builtin">if$</span>
          }
         <span class="builtin">if$</span>
       }
       <span class="comment">% absorder field &#12434;&#21442;&#29031;&#12375;&#12394;&#12356;&#22580;&#21512;&#12399; ///</span>
       { <span class="string">"/// "</span> * }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
  <span class="string">" "</span> *
  sort.label.abb *
  <span class="string">" "</span> *  
  is.kanji.entry
    { bst.mixed.order #0 =
       { <span class="string">""</span> }
       { <span class="string">" "</span> }
     <span class="builtin">if$</span>
    }
    { <span class="string">" "</span> }
  <span class="builtin">if$</span>
  <span class="variable-name">order</span> <span class="builtin">empty$</span>
    <span class="comment">% order &#12364; empty &#12398;&#12392;&#12365;&#12399; 0 &#12398;&#12392;&#12365;&#12392;&#19968;&#32210;&#12391; /// (&#12371;&#12428;&#12399;&#25968;&#23383;&#12424;&#12426;&#12399;&#21069;)</span>
    { <span class="string">"/// "</span> * }
    { bst.notuse.order.field #0 =
       { <span class="variable-name">order</span> <span class="string">"999"</span> =
          <span class="comment">% 999 &#12398;&#12392;&#12365;&#12399; zz </span>
          { <span class="string">"zzz "</span> * }
          { <span class="variable-name">order</span> add.zero.to.number <span class="string">"000"</span> =
             <span class="comment">% 000 &#12398;&#12392;&#12365;&#12399; /// (&#12371;&#12428;&#12399;&#25968;&#23383;&#12424;&#12426;&#12399;&#21069;)</span>
             { <span class="string">"/// "</span> * }
             { <span class="variable-name">order</span> add.zero.to.number * <span class="string">" "</span> * }
            <span class="builtin">if$</span>
          }
         <span class="builtin">if$</span>
       }
       <span class="comment">% order field &#12434;&#21442;&#29031;&#12375;&#12394;&#12356;&#22580;&#21512;&#12399; ///</span>
       { <span class="string">"/// "</span> * }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
  <span class="variable-name">month</span> <span class="builtin">empty$</span>
    <span class="comment">% month &#12364; empty &#12398;&#12392;&#12365;&#12399; 0 &#12398;&#12392;&#12365;&#12392;&#19968;&#32210;&#12391; /// (&#12371;&#12428;&#12399;&#25968;&#23383;&#12424;&#12426;&#12399;&#21069;)</span>
    { * <span class="string">"/// "</span> * }
       { <span class="variable-name">month</span> <span class="string">"999"</span> =
          <span class="comment">% 999 &#12398;&#12392;&#12365;&#12399; zz </span>
          { * <span class="variable-name">month</span> add.zero.to.number * <span class="string">"zzz "</span> * }
          { <span class="variable-name">month</span> add.zero.to.number <span class="string">"000"</span> =
             <span class="comment">% 000 &#12398;&#12392;&#12365;&#12399; /// (&#12371;&#12428;&#12399;&#25968;&#23383;&#12424;&#12426;&#12399;&#21069;)</span>
             { * <span class="variable-name">month</span> add.zero.to.number * <span class="string">"/// "</span> * }
             { * <span class="variable-name">month</span> add.zero.to.number * <span class="string">" "</span> * }
            <span class="builtin">if$</span>
          }
         <span class="builtin">if$</span>
       }
  <span class="builtin">if$</span>
  <span class="variable-name">title</span> field.or.null sort.format.title
  *
  #1 <span class="builtin">entry.max$</span> <span class="builtin">substring$</span>
  '<span class="builtin">sort.key$</span> <span class="constant">:=</span>
  <span class="comment">% For debug&#65294;&#12487;&#12496;&#12483;&#12464;&#12377;&#12427;&#12392;&#12365;&#12395;&#12399;&#12371;&#12398;&#38306;&#25968;&#12391;&#20316;&#25104;&#12373;&#12428;&#12427; sort.key$&#12398;&#20013;&#36523;&#12434;&#20986;&#21147;</span>
  <span class="comment">% &#12377;&#12427;&#65294;</span>
  jecon.debug #0 = not
    { <span class="string">"\verb|sort.key$| = ``\texttt{"</span> <span class="builtin">write$</span>
      <span class="builtin">sort.key$</span> <span class="builtin">write$</span>
      <span class="string">"+}''\\"</span> <span class="builtin">write$</span>
      <span class="builtin">newline$</span>
    }
    '<span class="builtin">skip$</span>
 <span class="builtin">if$</span>
}

<span class="comment">%%% &#20197;&#19979;&#12399;&#12487;&#12496;&#12483;&#12464;&#29992;&#12398;&#12467;&#12540;&#12489;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">calc.alabel.mess</span>}
{ jecon.debug #0 = not
    { <span class="string">"\textbf{Iteration of calc.alabel}\\"</span> <span class="builtin">write$</span>
      <span class="builtin">newline$</span> }
    '<span class="builtin">skip$</span>
 <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">calc.flabel.mess</span>}
{ jecon.debug #0 = not
    { <span class="string">"\textbf{Iteration of calc.flabel}\\"</span> <span class="builtin">write$</span>
      <span class="builtin">newline$</span> }
    '<span class="builtin">skip$</span>
 <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">calc.sort.label.abb.mess</span>}
{ jecon.debug #0 = not
    { <span class="string">"\textbf{Iteration of calc.sort.label.abb}\\"</span> <span class="builtin">write$</span>
      <span class="builtin">newline$</span> }
    '<span class="builtin">skip$</span>
 <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">presort.one.mess</span>}
{ jecon.debug #0 = not
    { <span class="string">"\textbf{Iteration of presort.one (&#12477;&#12540;&#12488;1&#22238;&#30446;)}\\"</span> <span class="builtin">write$</span>
      <span class="builtin">newline$</span> }
    '<span class="builtin">skip$</span>
 <span class="builtin">if$</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">presort.two.mess</span>}
{ jecon.debug #0 = not
    { <span class="string">"\textbf{Iteration of presort.two (&#12477;&#12540;&#12488;2&#22238;&#30446;)}\\"</span> <span class="builtin">write$</span>
      <span class="builtin">newline$</span> }
    '<span class="builtin">skip$</span>
 <span class="builtin">if$</span>
}
<span class="comment">%%% &#12487;&#12496;&#12483;&#12464;&#29992;&#12467;&#12540;&#12489;&#12371;&#12371;&#12414;&#12391;&#65294;</span>

<span class="comment">%%% alabel &#12398;&#20316;&#25104;</span>
<span class="keyword">EXECUTE</span> {<span class="function-name">calc.alabel.mess</span>}
<span class="keyword">ITERATE</span> {<span class="function-name">calc.alabel</span>}

<span class="comment">%%% flabel &#12398;&#20316;&#25104;</span>
<span class="keyword">EXECUTE</span> {<span class="function-name">calc.flabel.mess</span>}
<span class="keyword">ITERATE</span> {<span class="function-name">calc.flabel</span>}

<span class="comment">%%%</span>
<span class="keyword">EXECUTE</span> {<span class="function-name">calc.sort.label.abb.mess</span>}
<span class="keyword">ITERATE</span> {<span class="function-name">calc.sort.label.abb</span>}

<span class="comment">%%% presort &#12398;&#23455;&#34892; </span>
<span class="keyword">EXECUTE</span> {<span class="function-name">presort.one.mess</span>}
<span class="keyword">ITERATE</span> {<span class="function-name">presort.one</span>}

<span class="comment">%%% sort.key$ &#12434;&#21033;&#29992;&#12375;&#12390;&#25991;&#29486;&#12398;&#20006;&#12409;&#26367;&#12360;&#65294;&#19968;&#22238;&#30446;&#12398;&#20006;&#12409;&#26367;&#12360;&#65294;</span>

<span class="comment">% &#12371;&#12428;&#12399;&#20206;&#12398;&#20006;&#12403;&#38918;&#12434;&#27770;&#12417;&#12427;&#12383;&#12417;&#12398;&#12418;&#12398;&#12391;&#65292;&#26368;&#32066;&#30340;&#12395;&#12399;&#12418;&#12358;&#19968;&#24230;&#20006;&#12409;&#26367;&#12360;&#12434;&#12362;&#12371;&#12394;&#12358;&#65294;</span>
<span class="comment">% &#20108;&#22238;&#20006;&#12403;&#26367;&#12360;&#12434;&#12377;&#12427;&#12398;&#12399; bst.mixed.order &#12391;&#25351;&#23450;&#12377;&#12427; "&#21516;&#12376;&#24180;&#12395;&#21516;&#12376;&#33879;&#32773;&#12398;&#33521;&#35486;&#12289;</span><span class="string">
</span><span class="comment">% &#26085;&#26412;&#35486;&#25991;&#29486;&#12398;&#20001;&#26041;&#12364;&#12354;&#12426;&#12289;&#12363;&#12388;&#26085;&#26412;&#35486;&#25991;&#29486;&#12398; yomi &#12395;&#33521;&#35486;&#25991;&#29486;&#12398;&#33879;&#32773;&#12392;&#21516;&#12376;&#12418;&#12398;&#12364;&#25351;</span><span class="string">
</span><span class="comment">% &#23450;&#12375;&#12390;&#12354;&#12427;&#12392;&#12365;&#12395;&#12289;&#20001;&#32773;&#12434;&#28151;&#12380;&#12390;&#34920;&#31034;&#12377;&#12427;"&#12395;&#23550;&#24540;&#12377;&#12427;&#12383;&#12417;&#65294;</span>

<span class="keyword">SORT</span>

<span class="comment">% last.sort.label: &#19968;&#20491;&#21069;&#12398; sort.label.abb &#12398;&#20516;&#12434;&#20445;&#25345;&#12290;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">forward.pass</span>}
{ last.sort.label sort.label.abb =
    { last.extra.num #1 <span class="constant">+</span> 'last.extra.num <span class="constant">:=</span>
      last.extra.num <span class="builtin">int.to.chr$</span> 'extra.label <span class="constant">:=</span>
    }
    { <span class="string">"a"</span> <span class="builtin">chr.to.int$</span> 'last.extra.num <span class="constant">:=</span>
     <span class="string">""</span> 'extra.label <span class="constant">:=</span>
      sort.label.abb 'last.sort.label <span class="constant">:=</span>
    }
  <span class="builtin">if$</span>
  bst.use.bysame #0 = bst.use.bysame #2 = or
    <span class="comment">% 2 &#12398;&#12479;&#12452;&#12503;&#12398; bysame &#12434;&#20351;&#12358;&#22580;&#21512;&#12363; bysame &#12434;&#21033;&#29992;&#12375;&#12394;&#12356;&#22580;&#21512;</span>
    '<span class="builtin">skip$</span>
    <span class="comment">% 1 &#12398;&#12479;&#12452;&#12503;&#12398; bysame &#12434;&#20351;&#12358;&#22580;&#21512;</span>
    <span class="comment">% this.author &#12395;&#29694;&#22312;&#12398; author (or editor) &#12434;&#20195;&#20837;</span>
    { <span class="variable-name">author</span> <span class="builtin">empty$</span>
        { <span class="variable-name">editor</span> <span class="builtin">empty$</span>
          { <span class="string">""</span> }
          'format.editors.alt
          <span class="builtin">if$</span>
        }
        'format.authors.alt
      <span class="builtin">if$</span>
      'this.author <span class="constant">:=</span>
      <span class="comment">% &#29694;&#22312;&#12398; author (this.author) &#12364;&#19968;&#20491;&#21069;&#12398; author (prev.author) &#12392;&#21516;&#12376;&#12363;&#65311;</span>
      this.author prev.author =
        <span class="comment">% &#21516;&#12376;&#12394;&#12425; extra.labe.bysame &#12395; bysame &#12434;&#20195;&#20837;</span>
        { <span class="string">"bysame"</span> 'extra.label.bysame <span class="constant">:=</span> }
        <span class="comment">% &#21516;&#12376;&#12391;&#12399;&#12394;&#12356;&#12394;&#12425; prev.author &#12395; this.author &#12434;&#20195;&#20837;&#12375;&#12390;&#12362;&#12367;&#12290;</span>
        { this.author <span class="string">""</span> =
            { <span class="string">"abcxyz"</span> }
            'this.author
          <span class="builtin">if$</span>
          'prev.author <span class="constant">:=</span>
        }
      <span class="builtin">if$</span>
    }
  <span class="builtin">if$</span>
}

<span class="comment">%%% &#21516;&#12376;&#24180;&#12289;&#21516;&#12376;&#33879;&#32773;&#12398;&#25991;&#29486;&#12364;&#35079;&#25968;&#12354;&#12427;&#12392;&#12365;&#12398; year &#12395; a &#12434;&#20184;&#12369;&#12427;&#12383;&#12417;&#12398;&#38306;&#25968;</span>
<span class="keyword">FUNCTION</span> {<span class="function-name">reverse.pass</span>}
{ next.extra <span class="string">"b"</span> =
    { <span class="string">"a"</span> 'extra.label <span class="constant">:=</span> }
    '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
  extra.label <span class="builtin">empty$</span> not
    { cyear extra.label * }
    { cyear <span class="string">""</span> * }
  <span class="builtin">if$</span>
  <span class="string">""</span> field.or.null *
  'cyear <span class="constant">:=</span>
  <span class="comment">% next.extra &#12395; extra.label &#12434;&#20195;&#20837;</span>
  extra.label 'next.extra <span class="constant">:=</span>
}

<span class="comment">%%% bysame &#12434;&#20184;&#12369;&#12427;&#12290;</span>
<span class="keyword">ITERATE</span> {<span class="function-name">forward.pass</span>}

<span class="comment">%%% &#21516;&#12376;&#33879;&#32773;&#12398;&#21516;&#12376;&#24180;&#12398;&#25991;&#29486;&#12364;&#35079;&#25968;&#12354;&#12427;&#12392;&#12365; a &#12434;&#20184;&#12369;&#12427;&#12290;</span>
<span class="keyword">REVERSE</span> {<span class="function-name">reverse.pass</span>}

<span class="comment">%%% &#65298;&#22238;&#30446;&#12398;&#20006;&#12409;&#26367;&#12360;&#65294;&#12371;&#12428;&#12391;&#26368;&#32066;&#30340;&#12395;&#25991;&#29486;&#12398;&#20006;&#12403;&#38918;&#12364;&#36984;&#25246;&#12373;&#12428;&#12427;&#65294;</span>
<span class="keyword">EXECUTE</span> {<span class="function-name">presort.two.mess</span>}
<span class="keyword">ITERATE</span> {<span class="function-name">presort.two</span>}

<span class="comment">%%% sort.key$ &#12434;&#21033;&#29992;&#12375;&#12390;&#25991;&#29486;&#12398;&#20006;&#12409;&#26367;&#12360; (&#65298;&#22238;&#30446;)</span>
<span class="keyword">SORT</span>

<span class="keyword">FUNCTION</span> {<span class="function-name">reset.prev.author</span>}
{ <span class="string">"xxyyzz"</span> 'prev.author <span class="constant">:=</span> }

<span class="keyword">EXECUTE</span> {<span class="function-name">reset.prev.author</span>}

<span class="keyword">FUNCTION</span> {<span class="function-name">forward.pass.two</span>}
{ bst.use.bysame #1 =
    <span class="comment">% Type 1 &#12398; bysame &#12434;&#20351;&#12358;&#12465;&#12540;&#12473;&#12290;</span>
    { <span class="variable-name">author</span> <span class="builtin">empty$</span>
        { <span class="variable-name">editor</span> <span class="builtin">empty$</span>
          { <span class="string">""</span> }
          'format.editors.alt
          <span class="builtin">if$</span>
        }
        'format.authors.alt
     <span class="builtin">if$</span>
     'this.author <span class="constant">:=</span>
     <span class="comment">% &#29694;&#22312;&#12398; author (this.author) &#12364;&#19968;&#20491;&#21069;&#12398; author (prev.author) &#12392;&#21516;&#12376;&#12363;&#65311;</span>
     this.author prev.author =
        <span class="comment">% &#21516;&#12376;&#12394;&#12425; extra.labe.bysame &#12395; bysame &#12434;&#20195;&#20837;</span>
        { <span class="string">"bysame"</span> 'extra.label.bysame <span class="constant">:=</span> }
        <span class="comment">% &#21516;&#12376;&#12391;&#12399;&#12394;&#12356;&#12394;&#12425; prev.author &#12395; this.author &#12434;&#20195;&#20837;&#12375;&#12390;&#12362;&#12367;&#12290;</span>
        { this.author <span class="string">""</span> =
            { <span class="string">"abcxyz"</span> }
            'this.author
          <span class="builtin">if$</span>
          'prev.author <span class="constant">:=</span>
        }
     <span class="builtin">if$</span>
    }
    <span class="comment">% bysame &#12434;&#21033;&#29992;&#12375;&#12394;&#12356;&#12363;&#12289;Type 2 &#12398; bysame &#12434;&#20351;&#12358;&#12465;&#12540;&#12473;&#12391;&#12399;&#12394;&#12395;&#12418;&#12375;&#12394;&#12356;&#12290;</span>
   '<span class="builtin">skip$</span>
  <span class="builtin">if$</span>
}

<span class="keyword">ITERATE</span> {<span class="function-name">forward.pass.two</span>}

<span class="keyword">FUNCTION</span>{<span class="function-name">punctuation</span>}
{
  <span class="string">"</span><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%"  write$ newline$</span>
  <span class="string">"</span><span class="comment">%"                                                                    write$ newline$</span>
  <span class="string">"</span><span class="comment">%  This bbl file is created by jecon.bst ver." jecon.version *        write$ newline$</span>
  <span class="string">"</span><span class="comment">%  The latest jecon.bst is available at"                              write$ newline$</span>
  <span class="string">"</span><span class="comment">%  &lt;http://shirotakeda.org/ja/tex-ja/jecon-ja.html&gt;"             write$ newline$</span>
  <span class="string">"</span><span class="comment">%"                                                                    write$ newline$</span>
  <span class="string">"</span><span class="comment">%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%"  write$ newline$</span>
  <span class="builtin">newline$</span>
}

<span class="keyword">EXECUTE</span> {<span class="function-name">punctuation</span>}

<span class="keyword">FUNCTION</span> {<span class="function-name">begin.bib</span>}
{ <span class="builtin">preamble$</span> <span class="builtin">empty$</span>
    '<span class="builtin">skip$</span>
    { <span class="builtin">preamble$</span> <span class="builtin">write$</span> <span class="builtin">newline$</span> }
  <span class="builtin">if$</span>
  bst.use.bysame #0 =
     <span class="comment">% bysame &#12434;&#20351;&#12431;&#12394;&#12356;&#12465;&#12540;&#12473;</span>
     '<span class="builtin">skip$</span>
     <span class="comment">% bysame &#12434;&#20351;&#12358;&#12465;&#12540;&#12473;</span>
     { <span class="string">"</span><span class="comment">%%% Definition of \bysame" write$ newline$</span>
       <span class="string">"\ifx\undefined\bysame"</span> <span class="builtin">write$</span> <span class="builtin">newline$</span>
       <span class="string">"\newcommand{\bysame}{"</span> bst.bysame.definition * <span class="string">"}"</span> *
       <span class="builtin">write$</span> <span class="builtin">newline$</span>
       <span class="string">"\fi"</span> <span class="builtin">write$</span> <span class="builtin">newline$</span> <span class="builtin">newline$</span>
       <span class="string">"</span><span class="comment">%%% Definition of \bysamejp" write$ newline$</span>
       <span class="string">"\ifx\undefined\bysamejp"</span> <span class="builtin">write$</span> <span class="builtin">newline$</span>
       <span class="string">"\newcommand{\bysamejp}{"</span> bst.bysame.definition.jp * <span class="string">"}"</span> *
       <span class="builtin">write$</span> <span class="builtin">newline$</span>
       <span class="string">"\fi"</span> <span class="builtin">write$</span> <span class="builtin">newline$</span> <span class="builtin">newline$</span>
     }
  <span class="builtin">if$</span>
  <span class="comment">%% &#25968;&#23383;&#12434;&#28450;&#25968;&#23383;&#12395;&#22793;&#25563;&#12377;&#12427;&#12392;&#12365;&#12398;</span>
  bst.kansuji.jp #0 =
     '<span class="builtin">skip$</span>
     { <span class="string">"</span><span class="comment">%%% Definition of \tatebo" write$ newline$</span>
       <span class="string">"\ifx\undefined\tatebo"</span> <span class="builtin">write$</span> <span class="builtin">newline$</span>
       <span class="string">"\newcommand{\tatebo}{"</span> bst.tatebo.definition * <span class="string">"}"</span> *
       <span class="builtin">write$</span> <span class="builtin">newline$</span>
       <span class="string">"\fi"</span> <span class="builtin">write$</span> <span class="builtin">newline$</span> <span class="builtin">newline$</span> }
  <span class="builtin">if$</span>
  <span class="comment">%% &#25991;&#29486;&#12395; number index &#12434;&#20184;&#12369;&#12427;&#12392;&#12365;&#12398;:</span>
  bst.use.number.index #0 =
     '<span class="builtin">skip$</span>
     { bst.number.index.digit <span class="string">"1"</span> =
         <span class="comment">% &#19968;&#26689;&#12398;&#12392;&#12365;</span>
         { bst.number.index.bibhang.one }
         { bst.number.index.digit <span class="string">"2"</span> =
            <span class="comment">% &#20108;&#26689;&#12398;&#12392;&#12365;</span>
            { bst.number.index.bibhang.ten }
            <span class="comment">% &#19977;&#26689;&#20197;&#19978;&#12398;&#12392;&#12365;</span>
            { bst.number.index.bibhang.hund }
           <span class="builtin">if$</span>
         }
       <span class="builtin">if$</span>
       'hang <span class="constant">:=</span>
       <span class="string">"</span><span class="comment">%%% Redefinition of \bibhang" write$ newline$</span>
       <span class="string">"\ifx\undefined\bibhang"</span> <span class="builtin">write$</span> <span class="builtin">newline$</span>
       <span class="string">"\relax"</span> <span class="builtin">write$</span> <span class="builtin">newline$</span>
       <span class="string">"\else"</span> <span class="builtin">write$</span> <span class="builtin">newline$</span>
       <span class="string">"\setlength{\bibhang}{"</span>
       hang * <span class="string">"}"</span> * <span class="builtin">write$</span> <span class="builtin">newline$</span> 
       <span class="string">"\fi"</span> <span class="builtin">write$</span> <span class="builtin">newline$</span> <span class="builtin">newline$</span>
       }
  <span class="builtin">if$</span>

  bst.thebibliography.begin

  <span class="comment">%% &#22793;&#25968; index &#12434;&#21021;&#26399;&#21270;&#12375;&#12390;&#12356;&#12427;&#65294;</span>
  #0 'index <span class="constant">:=</span>
}

<span class="keyword">FUNCTION</span> {<span class="function-name">end.bib</span>}
{
  bst.thebibliography.end
 }

<span class="keyword">EXECUTE</span> {<span class="function-name">begin.bib</span>}

<span class="keyword">EXECUTE</span> {<span class="function-name">init.state.consts</span>}

<span class="comment">%% &#21508;&#12456;&#12531;&#12488;&#12522;&#12540;&#12395;&#12381;&#12398;&#12456;&#12531;&#12488;&#12522;&#12540;&#12398;&#12479;&#12452;&#12503;&#12434;&#23455;&#34892;&#12377;&#12427;&#65294;&#12388;&#12414;&#12426;&#65292;article &#12456;&#12531;&#12488;&#12522;&#12540;</span>
<span class="comment">%% &#12395;&#12399; article &#12392;&#12356;&#12358;&#38306;&#25968;&#12434;&#23455;&#34892;&#12377;&#12427;&#31561;&#65294;</span>
<span class="keyword">ITERATE</span> <span class="builtin">{call.type$</span>}

<span class="keyword">EXECUTE</span> {<span class="function-name">end.bib</span>}

<span class="comment">% &#32066;&#65294;</span>

<span class="comment">% --------------------</span>
<span class="comment">% Local Variables&#58;</span>
<span class="comment">% fill-column: 80</span>
<span class="comment">% mode: bst</span>
<span class="comment">% coding: utf-8-dos</span>
<span class="comment">% End:</span>

</pre>
  </body>
</html>
